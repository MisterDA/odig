<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S (anycache.Anycache.S)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">anycache</a> &#x00BB; <a href="../index.html">Anycache</a> &#x00BB; S</nav><h1>Module type <code>Anycache.S</code></h1></header><dl><dt class="spec type" id="type-key"><a href="#type-key" class="anchor"></a><code><span class="keyword">type</span> key</code></dt><dd><p>the type for cache keys</p></dd></dl><dl><dt class="spec type" id="type-deferred"><a href="#type-deferred" class="anchor"></a><code><span class="keyword">type</span> 'a deferred</code></dt><dd><p>the type for deferred computations</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> 'a t</code></dt><dd><p>the type for caches storing associating keys of type <code>key</code> with values of type <code>'a</code></p></dd></dl><dl><dt class="spec type" id="type-validator"><a href="#type-validator" class="anchor"></a><code><span class="keyword">type</span> 'a validator</code><code> = (<a href="index.html#type-key">key</a> * <span class="type-var">'a</span> option) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-deferred">deferred</a></code></dt><dd><p>the type for cache validation callbacks. <code>validate (key,old)</code> is called with <code>old = None</code> if the key is not in the cache yet and has to be computed. It is called with <code>old=Some data</code> if the key is already in the cache. The validator has to decide whether to return the same value or recompute it (perhas because it is expired / no longer fresh).</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : int <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create n</code> creates a LRU/2Q that can hold at most <code>n</code> elements</p></dd></dl><dl><dt class="spec value" id="val-with_cache"><a href="#val-with_cache" class="anchor"></a><code><span class="keyword">val</span> with_cache : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-deferred">deferred</a>) <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-deferred">deferred</a></code></dt><dd><p><code>with_cache cache f key</code> acts like <code>f key</code>, except it might make fewer calls to <code>f</code> when the <code>key</code> is already in the cache. On successful termination of <code>f key</code> the result is stored in the cache. <code>f key</code> must always return the same value when called with the same key. Cached values never expire, they are only removed if the cache capacity is exceeded, see <a href="../index.html#lrupolicy"><span>cache replacement policy</span></a>.</p></dd></dl><dl><dt class="spec value" id="val-with_validator"><a href="#val-with_validator" class="anchor"></a><code><span class="keyword">val</span> with_validator : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-validator">validator</a> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-deferred">deferred</a></code></dt><dd><p><code>with_validator cache validator key</code> calls <code>validator</code> each time <code>key</code> is accessed. If the <code>key</code> is not in the cache <code>validator (key, None)</code> is called and it should compute the value associated with <code>key</code>. If the <code>key</code> is already in the cache then <code>validator [key, Some value]</code> is called and <code>validator</code> should decide whether the <code>value</code> is still fresh, or if it should be recomputed. The value returned by <code>validator</code> in either case is stored in the <code>cache</code>. <code>validate (key,_)</code> is allowed to return different values when called with the same key again, provided it properly validates the lifetime of old entries. Values are removed from the cache when its capacity is exceeded, see <a href="../index.html#lrupolicy"><span>cache replacement policy</span></a>.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> option <a href="index.html#type-deferred">deferred</a></code></dt><dd><p><code>get cache key</code> retrieves the <code>key</code> from the <code>cache</code> if it exists. The key's position in LRU is updated</p></dd></dl><dl><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val</span> set : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set cache key value</code> stores <code>value</code> under <code>key</code> in the <code>cache</code>. If a value for <code>key</code> was already stored then it is replaced by the new <code>value</code>. It is not specified whether the key's position is updated in the LRU.</p></dd></dl></div></body></html>