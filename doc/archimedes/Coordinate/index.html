<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Coordinate (archimedes.Coordinate)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">archimedes</a> &#x00BB; Coordinate</nav><h1>Module <code>Coordinate</code></h1><p>Systems of coordinates (inhomogeneous homotheties) relative to other coordinate systems with automatic updates. The automatic update refers to the fact that, if a coordinate system is upated, all coordinate systems which depend on it (possibly through several intermediate coordinate systems), they will use the updated version.</p><nav class="toc"><ul><li><a href="#transforming-coordinates">Transforming coordinates</a></li><li><a href="#creating-new-coordinate-systems">Creating new coordinate systems</a></li><li><a href="#modifying-this-coordinate-system">Modifying this coordinate system</a></li><li><a href="#monitoring-coordinate-systems-for-updates">Monitoring coordinate systems for updates</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>Mutable affine coordinate system.</p></dd></dl><dl><dt class="spec type" id="type-ctm"><a href="#type-ctm" class="anchor"></a><code><span class="keyword">type</span> ctm</code></dt><dd><p>Current transformation matrix of the backend (to be able to restore it with <a href="index.html#val-restore"><code>Coordinate.restore</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-use"><a href="#val-use" class="anchor"></a><code><span class="keyword">val</span> use : <a href="../Backend/index.html#type-t">Backend.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-ctm">ctm</a></code></dt><dd><p>After a call to <code>use b c</code>, all backend operations will be performed in the coordinates <code>c</code>. It returns the current coordinate system so one can restore it with <a href="index.html#val-restore"><code>Coordinate.restore</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-restore"><a href="#val-restore" class="anchor"></a><code><span class="keyword">val</span> restore : <a href="../Backend/index.html#type-t">Backend.t</a> <span>&#45;&gt;</span> <a href="index.html#type-ctm">ctm</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>restore b c</code> restore the coordinate transformation matrix <code>ctm</code> for the backend <code>b</code>.</p></dd></dl><section><header><h3 id="transforming-coordinates"><a href="#transforming-coordinates" class="anchor"></a>Transforming coordinates</h3></header><dl><dt class="spec value" id="val-to_parent"><a href="#val-to_parent" class="anchor"></a><code><span class="keyword">val</span> to_parent : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>to_parent coord x y</code> returns the location of the point <code>(x,y)</code> in parent's coordinates.</p></dd></dl><dl><dt class="spec value" id="val-from_parent"><a href="#val-from_parent" class="anchor"></a><code><span class="keyword">val</span> from_parent : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>from_child coord x y</code> returns the location of the point <code>(x,y)</code> from parent's coordinates.</p></dd></dl><dl><dt class="spec value" id="val-to_device"><a href="#val-to_device" class="anchor"></a><code><span class="keyword">val</span> to_device : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>to_device coord x y</code> returns the location of the point <code>(x,y)</code> in device coordinates.</p></dd></dl><dl><dt class="spec value" id="val-to_device_distance"><a href="#val-to_device_distance" class="anchor"></a><code><span class="keyword">val</span> to_device_distance : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dx:float <span>&#45;&gt;</span> dy:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>to_device coord dx dy</code> returns the distance <code>(dx,dy)</code> in device coordinates (i.e. the translation in <code>coord</code> is ignored).</p></dd></dl><dl><dt class="spec value" id="val-to_coord"><a href="#val-to_coord" class="anchor"></a><code><span class="keyword">val</span> to_coord : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>to_coord coord x y</code> converts the (device) point <code>(x,y)</code> into the corresponding point, expressed in <code>coord</code> coordinates.</p></dd></dl><dl><dt class="spec value" id="val-to_coord_distance"><a href="#val-to_coord_distance" class="anchor"></a><code><span class="keyword">val</span> to_coord_distance : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> dx:float <span>&#45;&gt;</span> dy:float <span>&#45;&gt;</span> float * float</code></dt><dd><p><code>to_coord coord x y</code> converts the (device) distance <code>(dx,dy)</code> into the corresponding distance, expressed in <code>coord</code> coordinates.</p></dd></dl></section><section><header><h3 id="creating-new-coordinate-systems"><a href="#creating-new-coordinate-systems" class="anchor"></a>Creating new coordinate systems</h3></header><dl><dt class="spec value" id="val-make_root"><a href="#val-make_root" class="anchor"></a><code><span class="keyword">val</span> make_root : <a href="../Matrix/Homothety/index.html#type-t">Matrix.Homothety.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make_root m</code> make a system of coordinates which, when used, amounts to use <code>m</code>. This coordinate system depends on no other so will never be updated. It can be modified however (the matrix <code>m</code> is copied so no modification will affect <code>m</code>).</p></dd></dl><dl><dt class="spec value" id="val-make_identity"><a href="#val-make_identity" class="anchor"></a><code><span class="keyword">val</span> make_identity : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make_identity coord</code> defines a new system of coordinates that initially consist in the identity transformation to <code>coord</code>.</p></dd></dl><dl><dt class="spec value" id="val-make_translate"><a href="#val-make_translate" class="anchor"></a><code><span class="keyword">val</span> make_translate : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make_translate coord x y</code> defines a new coordinate system that consists in moving the origin of <code>coord</code> to the point <code>(x,y)</code> (understood as coordinates in the system <code>coord</code>). If <code>coord</code> is modified, the new system will be updated as well.</p></dd></dl><dl><dt class="spec value" id="val-make_scale"><a href="#val-make_scale" class="anchor"></a><code><span class="keyword">val</span> make_scale : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make_scale coord x y</code> defines a new coordinate system that consists in dilating axis X and Y of <code>coord</code> by a factor of <code>x</code> and <code>y</code> respectively. If <code>coord</code> is modified, the new system will be updated as well.</p></dd></dl><dl><dt class="spec value" id="val-make_from_transform"><a href="#val-make_from_transform" class="anchor"></a><code><span class="keyword">val</span> make_from_transform : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Matrix/Homothety/index.html#type-t">Matrix.Homothety.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>make_from_transform coord tm</code> defines a new coordinate system that consists first in applying <code>tm</code> and then the tranformation in <code>coord</code>. In other words, <code>tm</code> is the transformation from the desired coordinate system to <code>coord</code>. If <code>coord</code> is modified, the new system will be updated as well.</p></dd></dl><dl><dt class="spec value" id="val-copy"><a href="#val-copy" class="anchor"></a><code><span class="keyword">val</span> copy : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Returns a completely independent copy of the current coordinate system.</p></dd></dl></section><section><header><h3 id="modifying-this-coordinate-system"><a href="#modifying-this-coordinate-system" class="anchor"></a>Modifying this coordinate system</h3></header><dl><dt class="spec value" id="val-translate"><a href="#val-translate" class="anchor"></a><code><span class="keyword">val</span> translate : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> unit</code></dt><dd><p><code>translate coord x y</code> modifies the coordinate system <code>coord</code> translating its origin to the point <code>(x,y)</code> (understood as coordinates in the system <code>coord</code>).</p></dd></dl><dl><dt class="spec value" id="val-scale"><a href="#val-scale" class="anchor"></a><code><span class="keyword">val</span> scale : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> x:float <span>&#45;&gt;</span> y:float <span>&#45;&gt;</span> unit</code></dt><dd><p><code>scale coord x y</code> modifies the coordinate system <code>coord</code> dilating its axis X and Y by a factor of <code>x</code> and <code>y</code> respectively.</p></dd></dl><dl><dt class="spec value" id="val-transform"><a href="#val-transform" class="anchor"></a><code><span class="keyword">val</span> transform : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../Matrix/index.html#type-t">Matrix.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>transform coord tm</code> modifies the coordinate system <code>coord</code> changing the transformation matrix to its parent (the one it was created from) to <code>tm</code>.</p></dd></dl></section><section><header><h3 id="monitoring-coordinate-systems-for-updates"><a href="#monitoring-coordinate-systems-for-updates" class="anchor"></a>Monitoring coordinate systems for updates</h3></header><dl><dt class="spec type" id="type-monitor"><a href="#type-monitor" class="anchor"></a><code><span class="keyword">type</span> monitor</code></dt><dd><p>Handle to monitor the updates to a coordinate system.</p></dd></dl><dl><dt class="spec value" id="val-monitor"><a href="#val-monitor" class="anchor"></a><code><span class="keyword">val</span> monitor : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-monitor">monitor</a></code></dt><dd><p><code>monitor coord</code> creates a new monitor for changes to <code>coord</code> (initially not set).</p></dd></dl><dl><dt class="spec value" id="val-reset"><a href="#val-reset" class="anchor"></a><code><span class="keyword">val</span> reset : <a href="index.html#type-monitor">monitor</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>reset m</code> reset the monitor. See <a href="index.html#val-changed"><code>Coordinate.changed</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-changed"><a href="#val-changed" class="anchor"></a><code><span class="keyword">val</span> changed : <a href="index.html#type-monitor">monitor</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>changed m</code> tell whether the coordinate system <code>m</code> is attached to was updated (possibly because of one of the coordinate systems it (transitively) depends on was mofidied) since the last <code>reset</code>.</p></dd></dl></section></div></body></html>