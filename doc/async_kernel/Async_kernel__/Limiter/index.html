<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Limiter (async_kernel.Async_kernel__.Limiter)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">async_kernel</a> &#x00BB; <a href="../index.html">Async_kernel__</a> &#x00BB; Limiter</nav><h1>Module <code>Async_kernel__.Limiter</code></h1><nav class="toc"><ul><li><a href="#specialized-limiters">Specialized limiters</a></li></ul></nav></header><aside><p>Implements an async aware throttling rate limiter on top of <code>Core.Limiter</code>.</p><p>All forms of <code>enqueue_exn</code> and <code>enqueue'</code> below will raise if the requested job is not possible to run within the resource limitations given to the related <code>create_exn</code>.</p><p>If any enqueued job raises then the exception will be raised to the monitor in scope when <code>enqueue_exn</code> is called. Deferred jobs passed to <code>enqueue'</code> return <code>Raised</code> (in a deferred manner) instead.</p><p>Jobs are always executed in FIFO order.</p></aside><dl><dt class="spec module" id="module-Outcome"><a href="#module-Outcome" class="anchor"></a><code><span class="keyword">module</span> <a href="Outcome/index.html">Outcome</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The outcome of a job</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a></code></dt></dl></details></div></div></div><dl><dt class="spec type" id="type-limiter"><a href="#type-limiter" class="anchor"></a><code><span class="keyword">type</span> limiter</code><code> = <a href="index.html#type-t">t</a></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec value" id="val-sexp_of_limiter"><a href="#val-sexp_of_limiter" class="anchor"></a><code><span class="keyword">val</span> sexp_of_limiter : <a href="index.html#type-limiter">limiter</a> <span>&#45;&gt;</span> <a href="../../../sexplib0/Sexplib0/Sexp/index.html#type-t">Ppx_sexp_conv_lib.Sexp.t</a></code></dt></dl></details></div></div></div><section><header><h6 id="specialized-limiters"><a href="#specialized-limiters" class="anchor"></a>Specialized limiters</h6><p>A collection of limiters, specialized to different use-cases, all supporting a shared subset of their interface</p></header><div class="spec module-type" id="module-type-Common"><a href="#module-type-Common" class="anchor"></a><code><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Common/index.html">Common</a> = <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Token_bucket"><a href="#module-Token_bucket" class="anchor"></a><code><span class="keyword">module</span> <a href="Token_bucket/index.html">Token_bucket</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><aside><p><code>Throttle</code>, <code>Sequencer</code>, and <code>Resource_throttle</code> re-implement the functionality available in the core Async.Throttle module with the hope that these implementations can eventually supplant that code. It is helpful to use these modules in systems that can afford to do a bit more testing so that we can get feedback on the behavior of the new implementation. They are intended to be mostly drop-in replacements.</p></aside><dl><dt class="spec module" id="module-Throttle"><a href="#module-Throttle" class="anchor"></a><code><span class="keyword">module</span> <a href="Throttle/index.html">Throttle</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Implements a basic throttle meant to bound the number of jobs that can concurrently run. Additionally the <code>~burst_size</code> and <code>~sustained_rate_per_sec</code> arguments can be used to control how many jobs can be spawned in a burst, and how quickly jobs can be spawned over time. If these options are not given to <code>create_exn</code> they are unbounded.</p></dd></dl><dl><dt class="spec module" id="module-Sequencer"><a href="#module-Sequencer" class="anchor"></a><code><span class="keyword">module</span> <a href="Sequencer/index.html">Sequencer</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A sequencer is a throttle that is specialized to only allow one job at a time and to, by default, not continue on error.</p></dd></dl><dl><dt class="spec module" id="module-Resource_throttle"><a href="#module-Resource_throttle" class="anchor"></a><code><span class="keyword">module</span> <a href="Resource_throttle/index.html">Resource_throttle</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A resource throttle holds a static list of <code>n</code> resources that are handed out in a round-robin fashion to up to <code>n</code> concurrent jobs. A resource given to <code>create</code> may be re-used many times in the lifetime of <code>t</code> but will never be used by more than one job at a time.</p></dd></dl><div class="spec module" id="module-Expert"><a href="#module-Expert" class="anchor"></a><code><span class="keyword">module</span> <a href="Expert/index.html">Expert</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section></div></body></html>