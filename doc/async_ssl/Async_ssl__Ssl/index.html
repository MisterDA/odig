<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Async_ssl__Ssl (async_ssl.Async_ssl__Ssl)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">async_ssl</a> &#x00BB; Async_ssl__Ssl</nav><h1>Module <code>Async_ssl__Ssl</code></h1><p>An Async-pipe-based interface with OpenSSL.</p><p>This module allows you to create an SSL client and server, with encrypted communication between both.</p></header><div class="spec module" id="module-Version"><a href="#module-Version" class="anchor"></a><code><span class="keyword">module</span> <a href="Version/index.html">Version</a> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="../Async_ssl/index.html#module-Version">Async_ssl.Version</a></code></div><div class="spec module" id="module-Opt"><a href="#module-Opt" class="anchor"></a><code><span class="keyword">module</span> <a href="Opt/index.html">Opt</a> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="../Async_ssl/index.html#module-Opt">Async_ssl.Opt</a></code></div><div class="spec module" id="module-Verify_mode"><a href="#module-Verify_mode" class="anchor"></a><code><span class="keyword">module</span> <a href="Verify_mode/index.html">Verify_mode</a> : <span class="keyword">module</span> <span class="keyword">type</span> <span class="keyword">of</span> <a href="../Async_ssl/index.html#module-Verify_mode">Async_ssl.Verify_mode</a></code></div><dl><dt class="spec value" id="val-secure_ciphers"><a href="#val-secure_ciphers" class="anchor"></a><code><span class="keyword">val</span> secure_ciphers : string list</code></dt></dl><div class="spec module" id="module-Certificate"><a href="#module-Certificate" class="anchor"></a><code><span class="keyword">module</span> <a href="Certificate/index.html">Certificate</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Session"><a href="#module-Session" class="anchor"></a><code><span class="keyword">module</span> <a href="Session/index.html">Session</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Connection"><a href="#module-Connection" class="anchor"></a><code><span class="keyword">module</span> <a href="Connection/index.html">Connection</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><aside><p>Creates either an SSL client or server.</p><p>NB: your achieved security will be very weak unless you check the connection parameters after the handshake. See the <code>Connection</code> module above.</p><p><code>version</code> is optional, and allows you to customize the specific version of SSL that this connection should be using. It may be downgraded - you should check the actually negotiated version post-connection.</p><p><code>name</code> allows you to name this connection, to make errors easier to track down.</p><p>If <code>ca_file</code> is not <code>None</code>, it points to a file of CA certificates in PEM format. It may have more than one certificate.</p><p>If <code>ca_path</code> is not <code>None</code>, it points to a directory containing CA certificates in PEM format. The files each contain one CA certificate. The certificates in <code>ca_path</code> are only looked up lazily, not eagarly.</p><p>If both <code>ca_file</code> and <code>ca_path</code> are specified, the certificates in <code>ca_file</code> will be searched before the certificates in <code>ca_path</code>.</p><p>Any certificate authorities loaded are automatically trusted by OpenSSL.</p><p><code>crt_file</code> and <code>key_file</code> are the on-disk locations of the server's public and private keys.</p><p>Any data written into <code>app_to_ssl</code> will be encrypted with SSL, and the encrypted data will eventually be written into <code>ssl_to_net</code>.</p><p>Similarly, any data written into <code>net_to_ssl</code> will be decrypted with SSL and written into <code>ssl_to_app</code>.</p><p>A picture is probably easier to understand:</p><pre>                          app_to_ssl           ssl_to_net
        +---------------+ ---------&gt; +-------+ ---------&gt; +-----+
        | CLIENT/SERVER |            |  SSL  |            | NET |
        +---------------+ &lt;--------- +-------+ &lt;--------- +-----+
                          ssl_to_app           net_to_ssl</pre><p>To close the connection and free associated memory, call <code>Connection.close</code>. This will close all the involved pipes.</p><p>The <code>session</code> argument enables the session resumption mechanism: when called with the same session value twice, the client will try to resume the session during the second call, resulting in a quicker handshake. It is your responsibility to keep the mapping between the destinations and the sessions to be used with them. Calling the client with the same <code>session</code> but with a differet <code>ca_file</code> or <code>ca_path</code> will result in an error. Use <code>Connection.session_reused</code> to find out if session resumption actually worked.</p><p>Both <code>client</code> and <code>server</code> become determined when the handshake has completed.</p><p>The <code>hostname</code> sets the hostname to pass to the server using the SNI extension.</p></aside><dl><dt class="spec value" id="val-client"><a href="#val-client" class="anchor"></a><code><span class="keyword">val</span> client : ?&#8288;version:<a href="../Async_ssl/Version/index.html#type-t">Version.t</a> <span>&#45;&gt;</span> ?&#8288;options:<a href="../Async_ssl/Opt/index.html#type-t">Opt.t</a> list <span>&#45;&gt;</span> ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;hostname:string <span>&#45;&gt;</span> ?&#8288;allowed_ciphers:[ `Secure | `Openssl_default | `Only of string list ] <span>&#45;&gt;</span> ?&#8288;ca_file:string <span>&#45;&gt;</span> ?&#8288;ca_path:string <span>&#45;&gt;</span> ?&#8288;crt_file:string <span>&#45;&gt;</span> ?&#8288;key_file:string <span>&#45;&gt;</span> ?&#8288;verify_modes:<a href="../Async_ssl/Verify_mode/index.html#type-t">Verify_mode.t</a> list <span>&#45;&gt;</span> ?&#8288;session:<a href="Session/index.html#type-t">Session.t</a> <span>&#45;&gt;</span> app_to_ssl:string <a href="../../async_kernel/Async_kernel__Pipe/Reader/index.html#type-t">Async.Pipe.Reader.t</a> <span>&#45;&gt;</span> ssl_to_app:string <a href="../../async_kernel/Async_kernel__Pipe/Writer/index.html#type-t">Async.Pipe.Writer.t</a> <span>&#45;&gt;</span> net_to_ssl:string <a href="../../async_kernel/Async_kernel__Pipe/Reader/index.html#type-t">Async.Pipe.Reader.t</a> <span>&#45;&gt;</span> ssl_to_net:string <a href="../../async_kernel/Async_kernel__Pipe/Writer/index.html#type-t">Async.Pipe.Writer.t</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="Connection/index.html#type-t">Connection.t</a> <a href="../../async_kernel/Async_kernel__/Deferred_or_error/index.html#type-t">Async.Deferred.Or_error.t</a></code></dt><dt class="spec value" id="val-server"><a href="#val-server" class="anchor"></a><code><span class="keyword">val</span> server : ?&#8288;version:<a href="../Async_ssl/Version/index.html#type-t">Version.t</a> <span>&#45;&gt;</span> ?&#8288;options:<a href="../Async_ssl/Opt/index.html#type-t">Opt.t</a> list <span>&#45;&gt;</span> ?&#8288;name:string <span>&#45;&gt;</span> ?&#8288;allowed_ciphers:[ `Secure | `Openssl_default | `Only of string list ] <span>&#45;&gt;</span> ?&#8288;ca_file:string <span>&#45;&gt;</span> ?&#8288;ca_path:string <span>&#45;&gt;</span> crt_file:string <span>&#45;&gt;</span> key_file:string <span>&#45;&gt;</span> ?&#8288;verify_modes:<a href="../Async_ssl/Verify_mode/index.html#type-t">Verify_mode.t</a> list <span>&#45;&gt;</span> app_to_ssl:string <a href="../../async_kernel/Async_kernel__Pipe/Reader/index.html#type-t">Async.Pipe.Reader.t</a> <span>&#45;&gt;</span> ssl_to_app:string <a href="../../async_kernel/Async_kernel__Pipe/Writer/index.html#type-t">Async.Pipe.Writer.t</a> <span>&#45;&gt;</span> net_to_ssl:string <a href="../../async_kernel/Async_kernel__Pipe/Reader/index.html#type-t">Async.Pipe.Reader.t</a> <span>&#45;&gt;</span> ssl_to_net:string <a href="../../async_kernel/Async_kernel__Pipe/Writer/index.html#type-t">Async.Pipe.Writer.t</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="Connection/index.html#type-t">Connection.t</a> <a href="../../async_kernel/Async_kernel__/Deferred_or_error/index.html#type-t">Async.Deferred.Or_error.t</a></code></dt></dl></div></body></html>