<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Atd__Annot (atd.Atd__Annot)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">atd</a> &#x00BB; Atd__Annot</nav><h1>Module <code>Atd__Annot</code></h1><p>Utilities for interpreting annotations of type <span class="xref-unresolved" title="unresolved reference to &quot;Ast.annot&quot;"><code>Ast</code>.annot</span></p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span>Atd.Ast.annot</code></dt><dd><p>Sample annotation in ATD syntax with legend:</p><pre>section a   section b
----------- ------
&lt;a a1=&quot;x1&quot;&gt; &lt;b b1&gt;
 | |  |        |
 | |  |        +- field without a value
 | |  |
 | |  +- field value
 | |
 | +- field name
 |
 +- section name</pre><p>The following rules must be followed for a proper use of this module:</p><ul><li>There may not be two sections with the same name. The <code>merge</code> function can be used to merge sections.</li><li>Section order doesn't matter as long as section names are unique.</li><li>Field names within a section should be unique. If not, only the first occurrence of each field is meaningful.</li><li>Field values may be arbitrary strings.</li></ul></dd></dl><dl><dt class="spec value" id="val-has_section"><a href="#val-has_section" class="anchor"></a><code><span class="keyword">val </span>has_section : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Return true if such a section (first-level key) exists.</p></dd></dl><dl><dt class="spec value" id="val-has_field"><a href="#val-has_field" class="anchor"></a><code><span class="keyword">val </span>has_field : sections:string list <span>&#45;&gt;</span> field:string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>has_field section_names field_name annotations</code> returns true if at least one section exists with a name in <code>section_names</code> and one of its fields named <code>field_name</code>.</p><p>Each section should be unique.</p></dd></dl><dl><dt class="spec value" id="val-get_flag"><a href="#val-get_flag" class="anchor"></a><code><span class="keyword">val </span>get_flag : sections:string list <span>&#45;&gt;</span> field:string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>get_flag section_names field_name</code> looks sequentially into the sections specified by <code>section_names</code> for a field named <code>field_name</code>. If no such field can be found in any section, the result is <code>false</code>. Otherwise, the search stops with the first field matching one of the section names and the field name. If the field has no associated value, the result is <code>true</code>. If the field value is <code>&quot;true&quot;</code> then <code>true</code> is returned. Likewise, if the field value is <code>&quot;false&quot;</code> then <code>false</code> is returned. If the field value is anything else, a <code>Failure</code> exception is raised.</p><p>Each section should be unique.</p><p>Given the following annotations in the ATD syntax noted <code>a</code>:</p><pre>&lt;ocaml openin=&quot;false&quot;&gt; &lt;ocaml_312 openin&gt;</pre><p>We obtain the following results:</p><pre># get_flag \[&quot;ocaml_312&quot;; &quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : true
# get_flag \[&quot;ocaml_311&quot;; &quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : false
# get_flag \[&quot;ocaml_312&quot;\] &quot;openin&quot; a;;
\- : true
# get_flag \[&quot;ocaml_311&quot;\] &quot;openin&quot; a;;
\- : false
# get_flag \[&quot;ocaml&quot;\] &quot;openin&quot; a;;
\- : false</pre></dd></dl><dl><dt class="spec value" id="val-get_field"><a href="#val-get_field" class="anchor"></a><code><span class="keyword">val </span>get_field : parse:(string <span>&#45;&gt;</span> <span class="type-var">'a</span> option) <span>&#45;&gt;</span> default:<span class="type-var">'a</span> <span>&#45;&gt;</span> sections:string list <span>&#45;&gt;</span> field:string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>get_field parse default section_names field_name annotations</code> looks sequentially into the sections specified by <code>section_names</code> for a field named <code>field_name</code>. If no such field exists, the <code>default</code> value is returned. If the field is present, the associated value is parsed using the given function <code>parse</code> which should return <code>None</code> in order to indicate an invalid value. If the field is present without an associated value or if <code>parse</code> returns <code>None</code>, a <code>Failure</code> exception is raised.</p><p>Each section should be unique.</p></dd></dl><dl><dt class="spec value" id="val-get_opt_field"><a href="#val-get_opt_field" class="anchor"></a><code><span class="keyword">val </span>get_opt_field : parse:(string <span>&#45;&gt;</span> <span class="type-var">'a</span> option) <span>&#45;&gt;</span> sections:string list <span>&#45;&gt;</span> field:string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> option</code></dt><dd><p>This is the same as <code>get_field</code> except that no default value for the field exists.</p></dd></dl><dl><dt class="spec value" id="val-set_field"><a href="#val-set_field" class="anchor"></a><code><span class="keyword">val </span>set_field : loc:Atd.Ast.loc <span>&#45;&gt;</span> section:string <span>&#45;&gt;</span> field:string <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_field loc section_name field_name value annotations</code> sets a field, reusing existing section <code>section_name</code> if it exists, preserving the position of field <code>field_name</code> and overwriting its value if it exists.</p></dd></dl><dl><dt class="spec value" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span class="keyword">val </span>merge : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Merge sections of the same name together, and keeps only the first occurrence of each field.</p><pre>&lt;a a1=&quot;x1&quot;&gt; &lt;b&gt; &lt;a a2=&quot;x3&quot; a1=&quot;x2&quot;&gt;</pre><p>becomes</p><pre>&lt;a a1=&quot;x1&quot; a2=&quot;x3&quot;&gt; &lt;b&gt;</pre></dd></dl><dl><dt class="spec value" id="val-create_id"><a href="#val-create_id" class="anchor"></a><code><span class="keyword">val </span>create_id : unit <span>&#45;&gt;</span> string</code></dt><dd><p>Create a unique numeric ID</p></dd></dl></div></body></html>