<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>BatFile (batteries.BatFile)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">batteries</a> &#x00BB; BatFile</nav><h1>Module <code>BatFile</code></h1><p>File manipulation.</p><dl><dt>author</dt><dd>David Teller</dd></dl><nav class="toc"><ul><li><a href="#utilities">Utilities</a></li><li><a href="#file-permissions">File permissions</a></li><li><a href="#opening-a-file-for-reading">Opening a file for reading</a></li><li><a href="#opening-a-file-for-writing">Opening a file for writing</a></li><li><a href="#opening-a-temporary-file-for-writing">Opening a temporary file for writing</a></li></ul></nav></header><section><header><h6 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h6></header><dl><dt class="spec value" id="val-lines_of"><a href="#val-lines_of" class="anchor"></a><code><span class="keyword">val</span> lines_of : string <span>&#45;&gt;</span> string <a href="../BatEnum/index.html#type-t">BatEnum.t</a></code></dt><dd><p><code>lines_of name</code> reads the contents of file <code>name</code> as an enumeration of lines. The file is automatically closed once the last line has been reached or the enumeration is garbage-collected.</p></dd></dl><dl><dt class="spec value" id="val-write_lines"><a href="#val-write_lines" class="anchor"></a><code><span class="keyword">val</span> write_lines : string <span>&#45;&gt;</span> string <a href="../BatEnum/index.html#type-t">BatEnum.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>write_lines name lines</code> writes strings given by <code>lines</code> to file <code>name</code> with newline character appended to each line.</p></dd></dl><dl><dt class="spec value" id="val-size_of"><a href="#val-size_of" class="anchor"></a><code><span class="keyword">val</span> size_of : string <span>&#45;&gt;</span> int</code></dt><dd><p><code>size_of name</code> returns the size of file <code>name</code> in bytes.</p></dd></dl><dl><dt class="spec value" id="val-size_of_big"><a href="#val-size_of_big" class="anchor"></a><code><span class="keyword">val</span> size_of_big : string <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Int64/index.html#type-t">Stdlib.Int64.t</a></code></dt><dd><p><code>size_of_big name</code> returns the size of file <code>name</code> in bytes, as a 64-bit integer.</p><p>This function is provided as the size of a file larger than 1 Gb cannot be represented with an <code>int</code> on a 32-bit machine.</p></dd></dl></section><section><header><h6 id="file-permissions"><a href="#file-permissions" class="anchor"></a>File permissions</h6><p>File permissions are used when creating a file to allow controlling which users may read, write or open that file. To use a permission, create a value of type <a href="index.html#type-permission"><code>permission</code></a> and pass it as argument to <a href="index.html#val-open_in"><code>open_in</code></a>, <a href="index.html#val-open_out"><code>open_out</code></a>, <a href="index.html#val-with_file_in"><code>with_file_in</code></a> or <a href="index.html#val-with_file_out"><code>with_file_out</code></a>.</p></header><dl><dt class="spec type" id="type-permission"><a href="#type-permission" class="anchor"></a><code><span class="keyword">type</span> permission</code></dt><dd><p>The list of operations which are permitted on a file.</p></dd></dl><dl><dt class="spec value" id="val-default_permission"><a href="#val-default_permission" class="anchor"></a><code><span class="keyword">val</span> default_permission : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Default permissions.</p></dd></dl><dl><dt class="spec value" id="val-user_read"><a href="#val-user_read" class="anchor"></a><code><span class="keyword">val</span> user_read : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the current user permission to read the file. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-user_write"><a href="#val-user_write" class="anchor"></a><code><span class="keyword">val</span> user_write : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the current user permission to write the file</p></dd></dl><dl><dt class="spec value" id="val-user_exec"><a href="#val-user_exec" class="anchor"></a><code><span class="keyword">val</span> user_exec : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the current user permission to execute the file. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-group_read"><a href="#val-group_read" class="anchor"></a><code><span class="keyword">val</span> group_read : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to read the file to the group containing the user. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-group_write"><a href="#val-group_write" class="anchor"></a><code><span class="keyword">val</span> group_write : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to write the file to the group containing the user. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-group_exec"><a href="#val-group_exec" class="anchor"></a><code><span class="keyword">val</span> group_exec : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to execute the file to the group containing the user. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-other_read"><a href="#val-other_read" class="anchor"></a><code><span class="keyword">val</span> other_read : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to read the file to the rest of the world. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-other_write"><a href="#val-other_write" class="anchor"></a><code><span class="keyword">val</span> other_write : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to modify the file to the rest of the world. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-other_exec"><a href="#val-other_exec" class="anchor"></a><code><span class="keyword">val</span> other_exec : <a href="index.html#type-permission">permission</a></code></dt><dd><p>Give the permission to execute the file to the rest of the world. Ignored under Windows.</p></dd></dl><dl><dt class="spec value" id="val-perm"><a href="#val-perm" class="anchor"></a><code><span class="keyword">val</span> perm : <a href="index.html#type-permission">permission</a> list <span>&#45;&gt;</span> <a href="index.html#type-permission">permission</a></code></dt><dd><p>Join permissions</p></dd></dl><dl><dt class="spec value" id="val-unix_perm"><a href="#val-unix_perm" class="anchor"></a><code><span class="keyword">val</span> unix_perm : int <span>&#45;&gt;</span> <a href="index.html#type-permission">permission</a></code></dt><dd><p>Create a permission from a Unix-style octal integer. See your favorite Unix documentation on <code>chmod</code> for more details.</p><dl><dt>raises Invalid_argument</dt><dd><p>if given number outside the <code>[0, 0o777]</code> range</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-set_permissions"><a href="#val-set_permissions" class="anchor"></a><code><span class="keyword">val</span> set_permissions : string <span>&#45;&gt;</span> <a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Set the permissions on a file.</p></dd></dl><dl><dt class="spec value" id="val-chmod"><a href="#val-chmod" class="anchor"></a><code><span class="keyword">val</span> chmod : string <span>&#45;&gt;</span> <a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>As <a href="index.html#val-set_permissions"><code>set_permissions</code></a></p></dd></dl></section><section><header><h6 id="opening-a-file-for-reading"><a href="#opening-a-file-for-reading" class="anchor"></a>Opening a file for reading</h6></header><dl><dt class="spec type" id="type-open_in_flag"><a href="#type-open_in_flag" class="anchor"></a><code><span class="keyword">type</span> open_in_flag</code> = <code>[ </code><table class="variant"><tr id="type-open_in_flag.create" class="anchored"><td class="def constructor"><a href="#type-open_in_flag.create" class="anchor"></a><code>| </code><code>`create</code></td></tr><tr id="type-open_in_flag.excl" class="anchored"><td class="def constructor"><a href="#type-open_in_flag.excl" class="anchor"></a><code>| </code><code>`excl</code></td><td class="doc"><p>Fail if the file exists and <code>`create</code> is set</p></td></tr><tr id="type-open_in_flag.text" class="anchored"><td class="def constructor"><a href="#type-open_in_flag.text" class="anchor"></a><code>| </code><code>`text</code></td><td class="doc"><p>Open in ascii mode -- if this flag is not specified or if the operating system does not perform conversions, the file is opened in binary mode.</p></td></tr><tr id="type-open_in_flag.nonblock" class="anchored"><td class="def constructor"><a href="#type-open_in_flag.nonblock" class="anchor"></a><code>| </code><code>`nonblock</code></td><td class="doc"><p>Open in non-blocking mode</p></td></tr><tr id="type-open_in_flag.mmap" class="anchored"><td class="def constructor"><a href="#type-open_in_flag.mmap" class="anchor"></a><code>| </code><code>`mmap</code></td><td class="doc"><p>Open in memory-mapped mode (experimental)</p></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-open_in"><a href="#val-open_in" class="anchor"></a><code><span class="keyword">val</span> open_in : ?&#8288;mode:<a href="index.html#type-open_in_flag">open_in_flag</a> list <span>&#45;&gt;</span> ?&#8288;perm:<a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../BatInnerIO/index.html#type-input">BatInnerIO.input</a></code></dt><dd><p><code>open_in file_name</code> opens the file named <code>file_name</code> for reading.</p><p><b>Note</b> You will need to close the file manually, with <a href="../BatIO/index.html#val-close_in"><code>BatIO.close_in</code></a>. An alternative is to call <code>with_file_in</code> instead of <code>open_in</code>.</p><p>Naming conventions for files are platform-dependent.</p></dd></dl><dl><dt class="spec value" id="val-with_file_in"><a href="#val-with_file_in" class="anchor"></a><code><span class="keyword">val</span> with_file_in : ?&#8288;mode:<a href="index.html#type-open_in_flag">open_in_flag</a> list <span>&#45;&gt;</span> ?&#8288;perm:<a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<a href="../BatInnerIO/index.html#type-input">BatInnerIO.input</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_file_in file_name f</code> opens the file named <code>file_name</code> for reading, invokes <code>f</code> to process the contents of that file then, once <code>f</code> has returned or triggered an exception, closes the file before proceeding.</p></dd></dl></section><section><header><h6 id="opening-a-file-for-writing"><a href="#opening-a-file-for-writing" class="anchor"></a>Opening a file for writing</h6></header><dl><dt class="spec type" id="type-open_out_flag"><a href="#type-open_out_flag" class="anchor"></a><code><span class="keyword">type</span> open_out_flag</code> = <code>[ </code><table class="variant"><tr id="type-open_out_flag.append" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.append" class="anchor"></a><code>| </code><code>`append</code></td><td class="doc"><p>Start writing at the end of the file rather than the start</p></td></tr><tr id="type-open_out_flag.create" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.create" class="anchor"></a><code>| </code><code>`create</code></td><td class="doc"><p>Create the file if it does not exist</p></td></tr><tr id="type-open_out_flag.trunc" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.trunc" class="anchor"></a><code>| </code><code>`trunc</code></td><td class="doc"><p>Empty the file if it already exists; on by default</p></td></tr><tr id="type-open_out_flag.excl" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.excl" class="anchor"></a><code>| </code><code>`excl</code></td><td class="doc"><p>Fail if the file exists and <code>`create</code> is set</p></td></tr><tr id="type-open_out_flag.text" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.text" class="anchor"></a><code>| </code><code>`text</code></td><td class="doc"><p>Open in ascii mode -- if this flag is not specified or if the operating system does not perform conversions, the file is opened in binary mode.</p></td></tr><tr id="type-open_out_flag.nonblock" class="anchored"><td class="def constructor"><a href="#type-open_out_flag.nonblock" class="anchor"></a><code>| </code><code>`nonblock</code></td><td class="doc"><p>Open in non-blocking mode</p></td></tr></table><code> ]</code></dt><dd><p>Flags governing file output; they correspond to the relevant flags to the POSIX <code>open()</code> call. The default flags are <code>[`create; `trunc]</code>.</p></dd></dl><dl><dt class="spec value" id="val-open_out"><a href="#val-open_out" class="anchor"></a><code><span class="keyword">val</span> open_out : ?&#8288;mode:<a href="index.html#type-open_out_flag">open_out_flag</a> list <span>&#45;&gt;</span> ?&#8288;perm:<a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit <a href="../BatInnerIO/index.html#type-output">BatInnerIO.output</a></code></dt><dd><p><code>open_out file_name</code> opens the file named <code>file_name</code> for writing.</p><p><b>Note</b> You will need to close the file manually, with <a href="../BatIO/index.html#val-close_out"><code>BatIO.close_out</code></a>. An alternative is to call <code>with_file_out</code> instead of <code>open_out</code>.</p><p>Naming conventions for files are platform-dependent.</p></dd></dl><dl><dt class="spec value" id="val-with_file_out"><a href="#val-with_file_out" class="anchor"></a><code><span class="keyword">val</span> with_file_out : ?&#8288;mode:<a href="index.html#type-open_out_flag">open_out_flag</a> list <span>&#45;&gt;</span> ?&#8288;perm:<a href="index.html#type-permission">permission</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (unit <a href="../BatInnerIO/index.html#type-output">BatInnerIO.output</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_file_out file_name f</code> opens the file named <code>file_name</code> for writing, invokes <code>f</code> to write onto that file then, once <code>f</code> has returned or triggered an exception, closes the file before proceeding.</p></dd></dl></section><section><header><h6 id="opening-a-temporary-file-for-writing"><a href="#opening-a-temporary-file-for-writing" class="anchor"></a>Opening a temporary file for writing</h6></header><dl><dt class="spec type" id="type-open_temporary_out_flag"><a href="#type-open_temporary_out_flag" class="anchor"></a><code><span class="keyword">type</span> open_temporary_out_flag</code> = <code>[ </code><table class="variant"><tr id="type-open_temporary_out_flag.open_out_flag" class="anchored"><td class="def type"><a href="#type-open_temporary_out_flag.open_out_flag" class="anchor"></a><code>| </code><code><a href="index.html#type-open_out_flag">open_out_flag</a></code></td></tr><tr id="type-open_temporary_out_flag.delete_on_exit" class="anchored"><td class="def constructor"><a href="#type-open_temporary_out_flag.delete_on_exit" class="anchor"></a><code>| </code><code>`delete_on_exit</code></td><td class="doc"><p>Should the file be deleted when program ends?</p></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-open_temporary_out"><a href="#val-open_temporary_out" class="anchor"></a><code><span class="keyword">val</span> open_temporary_out : ?&#8288;mode:<a href="index.html#type-open_temporary_out_flag">open_temporary_out_flag</a> list <span>&#45;&gt;</span> ?&#8288;prefix:string <span>&#45;&gt;</span> ?&#8288;suffix:string <span>&#45;&gt;</span> ?&#8288;temp_dir:string <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit <a href="../BatInnerIO/index.html#type-output">BatInnerIO.output</a> * string</code></dt><dd><p><code>open_temporary_out ()</code> opens a new temporary file for writing.</p><dl><dt>parameter prefix</dt><dd><p>a string which should appear at the start of your temporary file name (by default <code>&quot;ocaml&quot;</code>)</p></dd></dl><dl><dt>parameter suffix</dt><dd><p>a string which should appear at the end of your temporary file name (by default <code>&quot;tmp&quot;</code>)</p></dd></dl><dl><dt>parameter temp_dir</dt><dd><p>indicates what temp dir to use</p></dd></dl><dl><dt>returns</dt><dd><p>The name of the file and the <code>output</code> for writing in it.</p><p><b>Note</b> You will need to close the file manually. An alternative is to call <code>with_temporary_out</code> instead of <code>open_out</code>.</p><p>Naming conventions for files are platform-dependent.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-with_temporary_out"><a href="#val-with_temporary_out" class="anchor"></a><code><span class="keyword">val</span> with_temporary_out : ?&#8288;mode:<a href="index.html#type-open_temporary_out_flag">open_temporary_out_flag</a> list <span>&#45;&gt;</span> ?&#8288;prefix:string <span>&#45;&gt;</span> ?&#8288;suffix:string <span>&#45;&gt;</span> ?&#8288;temp_dir:string <span>&#45;&gt;</span> (unit <a href="../BatInnerIO/index.html#type-output">BatInnerIO.output</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_temporary_out f</code> opens a new temporary file for writing, invokes <code>f</code> with to write onto that file then, once <code>f</code> has returned or triggered an exception, closes the file before proceeding.</p><dl><dt>parameter prefix</dt><dd><p>a string which should appear at the start of your temporary file name (by default <code>&quot;ocaml&quot;</code>)</p></dd></dl><dl><dt>parameter suffix</dt><dd><p>a string which should appear at the end of your temporary file name (by default <code>&quot;tmp&quot;</code>)</p></dd></dl><dl><dt>parameter temp_dir</dt><dd><p>indicates what temp dir to use</p></dd></dl><dl><dt>returns</dt><dd><p>The name of the file and the <code>output</code> for writing in it.</p><p>Naming conventions for files are platform-dependent.</p></dd></dl></dd></dl></section></div></body></html>