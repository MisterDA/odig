<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cmd (bos.Bos.OS.Cmd)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bos</a> &#x00BB; <a href="../../index.html">Bos</a> &#x00BB; <a href="../index.html">OS</a> &#x00BB; Cmd</nav><h1>Module <code>OS.Cmd</code></h1><p>Executing commands.</p><nav class="toc"><ul><li><a href="#exist">Tool existence and search</a></li><li><a href="#run">Command runs</a><ul><li><a href="#run_exit">Run statuses &amp; information</a></li><li><a href="#stderrs">Run standard errors</a></li><li><a href="#stdins">Run standard inputs</a></li><li><a href="#stdouts">Run standard outputs</a><ul><li><a href="#success">Extracting success</a></li></ul></li><li><a href="#runs">Run specifications</a></li></ul></li><li><a href="#ex">Examples</a></li></ul></nav></header><section><header><h2 id="exist"><a href="#exist" class="anchor"></a>Tool existence and search</h2><p><b>Tool search procedure.</b> Given a list of directories, the <span class="xref-unresolved" title="unresolved reference to &quot;Cmd.line_tool&quot;"><span>tool</span></span> of a command line is searched, in list order, for the first matching <em>executable</em> file. If the tool name is already a file path (i.e. contains a <span class="xref-unresolved" title="unresolved reference to &quot;Fpath.dir_sep&quot;"><code>Fpath</code>.dir_sep</span>) it is neither searched nor tested for <a href="../File/index.html#val-is_executable"><span>existence and executability</span></a>. In the functions below if the list of directories <code>search</code> is unspecified the result of parsing the <code>PATH</code> environment variable with <a href="index.html#val-search_path_dirs"><code>search_path_dirs</code></a> is used.</p><p><b>Portability.</b> In order to maximize portability no <code>.exe</code> suffix should be added to executable names on Windows, the tool search procedure will add the suffix during the tool search procedure if absent.</p></header><dl><dt class="spec value" id="val-find_tool"><a href="#val-find_tool" class="anchor"></a><code><span class="keyword">val </span>find_tool : ?&#8288;search:Fpath.t list <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (Fpath.t option, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>find_tool ~search cmd</code> is the path to the <span class="xref-unresolved" title="unresolved reference to &quot;Cmd.line_tool&quot;"><span>tool</span></span> of <code>cmd</code> as found by the tool search procedure in <code>search</code>.</p></dd></dl><dl><dt class="spec value" id="val-get_tool"><a href="#val-get_tool" class="anchor"></a><code><span class="keyword">val </span>get_tool : ?&#8288;search:Fpath.t list <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (Fpath.t, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>get_tool cmd</code> is like <a href="index.html#val-find_tool"><code>find_tool</code></a> except it errors if the tool path cannot be found.</p></dd></dl><dl><dt class="spec value" id="val-exists"><a href="#val-exists" class="anchor"></a><code><span class="keyword">val </span>exists : ?&#8288;search:Fpath.t list <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (bool, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>exists ~search cmd</code> is <code>Ok true</code> if <a href="index.html#val-find_tool"><code>find_tool</code></a> finds a path and <code>Ok false</code> if it does not.</p></dd></dl><dl><dt class="spec value" id="val-must_exist"><a href="#val-must_exist" class="anchor"></a><code><span class="keyword">val </span>must_exist : ?&#8288;search:Fpath.t list <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (<a href="../../Cmd/index.html#type-t">Cmd.t</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>must_exist ~search cmd</code> is <code>Ok cmd</code> if <a href="index.html#val-get_tool"><code>get_tool</code></a> succeeds.</p></dd></dl><dl><dt class="spec value" id="val-resolve"><a href="#val-resolve" class="anchor"></a><code><span class="keyword">val </span>resolve : ?&#8288;search:Fpath.t list <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (<a href="../../Cmd/index.html#type-t">Cmd.t</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>resolve ~search cmd</code> is like <a href="index.html#val-must_exist"><code>must_exist</code></a> except the tool of the resulting command value has the path to the tool of <code>cmd</code> as determined by <a href="index.html#val-get_tool"><code>get_tool</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-search_path_dirs"><a href="#val-search_path_dirs" class="anchor"></a><code><span class="keyword">val </span>search_path_dirs : ?&#8288;sep:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (Fpath.t list, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>search_path_dirs ~sep s</code> parses <code>sep</code> seperated file paths from <code>s</code>. <code>sep</code> is not allowed to appear in the file paths, it defaults to <code>&quot;;&quot;</code> if <span class="xref-unresolved" title="unresolved reference to &quot;Sys.win32&quot;"><code>Sys</code>.win32</span> is <code>true</code> and <code>&quot;:&quot;</code> otherwise.</p></dd></dl></section><section><header><h2 id="run"><a href="#run" class="anchor"></a>Command runs</h2><p>The following set of combinators are designed to be used with <span class="xref-unresolved" title="unresolved reference to &quot;Pervasives.(|&gt;)&quot;"><code>Pervasives</code>.(|&gt;)</span> operator. See a few <a href="index.html#ex"><span>examples</span></a>.</p><p><b>WARNING Windows.</b> The <code>~append:true</code> options for appending to files are unsupported on Windows. <a href="http://caml.inria.fr/mantis/view.php?id=4431">This</a> old feature request should be fixed upstream.</p></header><section><header><h3 id="run_exit"><a href="#run_exit" class="anchor"></a>Run statuses &amp; information</h3></header><dl><dt class="spec type" id="type-status"><a href="#type-status" class="anchor"></a><code><span class="keyword">type </span>status</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-status.Exited" class="anchored"><td class="def constructor"><a href="#type-status.Exited" class="anchor"></a><code><span class="keyword">| </span></code><code>`Exited<span class="keyword"> of </span>int</code></td></tr><tr id="type-status.Signaled" class="anchored"><td class="def constructor"><a href="#type-status.Signaled" class="anchor"></a><code><span class="keyword">| </span></code><code>`Signaled<span class="keyword"> of </span>int</code></td></tr></table><code> ]</code></dt><dd><p>The type for process exit statuses.</p></dd></dl><dl><dt class="spec value" id="val-pp_status"><a href="#val-pp_status" class="anchor"></a><code><span class="keyword">val </span>pp_status : <a href="index.html#type-status">status</a> Fmt.t</code></dt><dd><p><code>pp_status</code> is a formatter for statuses.</p></dd></dl><dl><dt class="spec type" id="type-run_info"><a href="#type-run_info" class="anchor"></a><code><span class="keyword">type </span>run_info</code></dt><dd><p>The type for run information.</p></dd></dl><dl><dt class="spec value" id="val-run_info_cmd"><a href="#val-run_info_cmd" class="anchor"></a><code><span class="keyword">val </span>run_info_cmd : <a href="index.html#type-run_info">run_info</a> <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a></code></dt><dd><p><code>run_info_cmd ri</code> is the command that was run.</p></dd></dl><dl><dt class="spec type" id="type-run_status"><a href="#type-run_status" class="anchor"></a><code><span class="keyword">type </span>run_status</code><code><span class="keyword"> = </span><a href="index.html#type-run_info">run_info</a><span class="keyword"> * </span><a href="index.html#type-status">status</a></code></dt><dd><p>The type for run statuses the run information and the process exit status.</p></dd></dl><dl><dt class="spec value" id="val-success"><a href="#val-success" class="anchor"></a><code><span class="keyword">val </span>success : (<span class="type-var">'a</span><span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>success r</code> is:</p><ul><li><code>Ok v</code> if <code>r = Ok (v, (_, `Exited 0))</code></li><li><code>Error _</code> otherwise. Non <code>`Exited 0</code> statuses are turned into an error message.</li></ul></dd></dl></section><section><header><h3 id="stderrs"><a href="#stderrs" class="anchor"></a>Run standard errors</h3></header><dl><dt class="spec type" id="type-run_err"><a href="#type-run_err" class="anchor"></a><code><span class="keyword">type </span>run_err</code></dt><dd><p>The type for representing the standard error of a command run.</p></dd></dl><dl><dt class="spec value" id="val-err_file"><a href="#val-err_file" class="anchor"></a><code><span class="keyword">val </span>err_file : ?&#8288;append:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <a href="index.html#type-run_err">run_err</a></code></dt><dd><p><code>err_file f</code> is a standard error that writes to file <code>f</code>. If <code>append</code> is <code>true</code> (defaults to <code>false</code>) the data is appended to <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-err_null"><a href="#val-err_null" class="anchor"></a><code><span class="keyword">val </span>err_null : <a href="index.html#type-run_err">run_err</a></code></dt><dd><p><code>err_null</code> is <code>err_file File.null</code>.</p></dd></dl><dl><dt class="spec value" id="val-err_run_out"><a href="#val-err_run_out" class="anchor"></a><code><span class="keyword">val </span>err_run_out : <a href="index.html#type-run_err">run_err</a></code></dt><dd><p><code>err_run_out</code> is a standard error that is redirected to the run's standard output.</p></dd></dl><dl><dt class="spec value" id="val-err_stderr"><a href="#val-err_stderr" class="anchor"></a><code><span class="keyword">val </span>err_stderr : <a href="index.html#type-run_err">run_err</a></code></dt><dd><p><code>err_stderr</code> is a standard error that is redirected to the current process standard error.</p></dd></dl></section><section><header><h3 id="stdins"><a href="#stdins" class="anchor"></a>Run standard inputs</h3></header><dl><dt class="spec type" id="type-run_in"><a href="#type-run_in" class="anchor"></a><code><span class="keyword">type </span>run_in</code></dt><dd><p>The type for representing the standard input of a command run.</p></dd></dl><dl><dt class="spec value" id="val-in_string"><a href="#val-in_string" class="anchor"></a><code><span class="keyword">val </span>in_string : string <span>&#45;&gt;</span> <a href="index.html#type-run_in">run_in</a></code></dt><dd><p><code>in_string s</code> is a standard input that reads <code>s</code>.</p></dd></dl><dl><dt class="spec value" id="val-in_file"><a href="#val-in_file" class="anchor"></a><code><span class="keyword">val </span>in_file : Fpath.t <span>&#45;&gt;</span> <a href="index.html#type-run_in">run_in</a></code></dt><dd><p><code>in_file f</code> is a standard input that reads from file <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-in_null"><a href="#val-in_null" class="anchor"></a><code><span class="keyword">val </span>in_null : <a href="index.html#type-run_in">run_in</a></code></dt><dd><p><code>in_null</code> is <code>in_file File.null</code>.</p></dd></dl><dl><dt class="spec value" id="val-in_stdin"><a href="#val-in_stdin" class="anchor"></a><code><span class="keyword">val </span>in_stdin : <a href="index.html#type-run_in">run_in</a></code></dt><dd><p><code>in_stdin</code> is a standard input that reads from the current process standard input.</p></dd></dl></section><section><header><h3 id="stdouts"><a href="#stdouts" class="anchor"></a>Run standard outputs</h3><p>The following functions trigger actual command runs, consume their standard output and return the command and its status. In <a href="index.html#val-out_run_in"><span>pipelined</span></a> runs, the reported status is the one of the first failing run in the pipeline.</p><p><b>Warning.</b> When a value of type <a href="index.html#type-run_out"><code>run_out</code></a> has been &quot;consumed&quot; with one of the following functions it cannot be reused.</p></header><dl><dt class="spec type" id="type-run_out"><a href="#type-run_out" class="anchor"></a><code><span class="keyword">type </span>run_out</code></dt><dd><p>The type for representing the standard output and status of a command run.</p></dd></dl><dl><dt class="spec value" id="val-out_string"><a href="#val-out_string" class="anchor"></a><code><span class="keyword">val </span>out_string : ?&#8288;trim:bool <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (string<span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>out_string ~trim o</code> captures the standard output <code>o</code> as a string. If <code>trim</code> is <code>true</code> (default) the result is passed through <span class="xref-unresolved" title="unresolved reference to &quot;String.trim&quot;"><code>String</code>.trim</span>.</p></dd></dl><dl><dt class="spec value" id="val-out_lines"><a href="#val-out_lines" class="anchor"></a><code><span class="keyword">val </span>out_lines : ?&#8288;trim:bool <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (string list<span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>out_lines</code> is like <a href="index.html#val-out_string"><code>out_string</code></a> but the result is splitted on newlines (<code>'\n'</code>). If the standard output is empty then the empty list is returned.</p></dd></dl><dl><dt class="spec value" id="val-out_file"><a href="#val-out_file" class="anchor"></a><code><span class="keyword">val </span>out_file : ?&#8288;append:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit<span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>out_file f o</code> writes the standard output <code>o</code> to file <code>f</code>. If <code>append</code> is <code>true</code> (defaults to <code>false</code>) the data is appended to <code>f</code>.</p></dd></dl><dl><dt class="spec value" id="val-out_run_in"><a href="#val-out_run_in" class="anchor"></a><code><span class="keyword">val </span>out_run_in : <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (<a href="index.html#type-run_in">run_in</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>out_run_in o</code> is a run input that can be used to feed the standard output of <code>o</code> to the standard input of another, <b>single</b>, command run. Note that when the function returns the command run of <code>o</code> may not be terminated yet. The run using the resulting input will report an unsucessful status or error of <code>o</code> rather than its own error.</p></dd></dl><dl><dt class="spec value" id="val-out_null"><a href="#val-out_null" class="anchor"></a><code><span class="keyword">val </span>out_null : <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit<span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>out_null o</code> is <code>out_file File.null o</code>.</p></dd></dl><dl><dt class="spec value" id="val-out_stdout"><a href="#val-out_stdout" class="anchor"></a><code><span class="keyword">val </span>out_stdout : <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit<span class="keyword"> * </span><a href="index.html#type-run_status">run_status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_stdout o</code> redirects the standard output <code>o</code> to the current process standard output.</p></dd></dl><section><header><h4 id="success"><a href="#success" class="anchor"></a>Extracting success</h4><p>The following functions can be used if you only care about success.</p></header><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val </span>to_string : ?&#8288;trim:bool <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (string, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_string ~trim o</code> is <code>(out_string ~trim o |&gt; success)</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_lines"><a href="#val-to_lines" class="anchor"></a><code><span class="keyword">val </span>to_lines : ?&#8288;trim:bool <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (string list, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_lines ~trim o</code> is <code>(out_lines ~trim o |&gt; success)</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_file"><a href="#val-to_file" class="anchor"></a><code><span class="keyword">val </span>to_file : ?&#8288;append:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_file ?append f o</code> is <code>(out_file ?append f o |&gt; success)</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_null"><a href="#val-to_null" class="anchor"></a><code><span class="keyword">val </span>to_null : <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_null o</code> is <code>to_file File.null o</code>.</p></dd></dl><dl><dt class="spec value" id="val-to_stdout"><a href="#val-to_stdout" class="anchor"></a><code><span class="keyword">val </span>to_stdout : <a href="index.html#type-run_out">run_out</a> <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>to_stdout o</code> is <code>(out_stdout o |&gt; success)</code>.</p></dd></dl></section></section><section><header><h3 id="runs"><a href="#runs" class="anchor"></a>Run specifications</h3></header><dl><dt class="spec value" id="val-run_io"><a href="#val-run_io" class="anchor"></a><code><span class="keyword">val </span>run_io : ?&#8288;env:<a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> ?&#8288;err:<a href="index.html#type-run_err">run_err</a> <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> <a href="index.html#type-run_in">run_in</a> <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a></code></dt><dd><p><code>run_io ~env ~err cmd i</code> represents the standard output of the command run <code>cmd</code> performed in process environment <code>env</code> with its standard error output handled according to <code>err</code> (defaults to <a href="index.html#val-err_stderr"><code>err_stderr</code></a>) and standard input connected to <code>i</code>. Note that the command run is not started before the output is consumed, see <a href="index.html#stdouts"><span>run standard outputs</span></a>.</p></dd></dl><dl><dt class="spec value" id="val-run_out"><a href="#val-run_out" class="anchor"></a><code><span class="keyword">val </span>run_out : ?&#8288;env:<a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> ?&#8288;err:<a href="index.html#type-run_err">run_err</a> <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> <a href="index.html#type-run_out">run_out</a></code></dt><dd><p><code>run_out ?env ?err cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err cmd)</code>.</p></dd></dl><dl><dt class="spec value" id="val-run_in"><a href="#val-run_in" class="anchor"></a><code><span class="keyword">val </span>run_in : ?&#8288;env:<a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> ?&#8288;err:<a href="index.html#type-run_err">run_err</a> <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> <a href="index.html#type-run_in">run_in</a> <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>run_in ?env ?err cmd i</code> is <code>(run_io ?env ?err cmd |&gt; to_stdout)</code>.</p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val </span>run : ?&#8288;env:<a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> ?&#8288;err:<a href="index.html#type-run_err">run_err</a> <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>run ?env ?err cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err cmd |&gt; to_stdout)</code>.</p></dd></dl><dl><dt class="spec value" id="val-run_status"><a href="#val-run_status" class="anchor"></a><code><span class="keyword">val </span>run_status : ?&#8288;env:<a href="../Env/index.html#type-t">Env.t</a> <span>&#45;&gt;</span> ?&#8288;err:<a href="index.html#type-run_err">run_err</a> <span>&#45;&gt;</span> ?&#8288;quiet:bool <span>&#45;&gt;</span> <a href="../../Cmd/index.html#type-t">Cmd.t</a> <span>&#45;&gt;</span> (<a href="index.html#type-status">status</a>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>run_status ?env ?err ?quiet cmd</code> is <code>(in_stdin |&gt; run_io ?env ?err ?cmd |&gt; out_stdout)</code> and extracts the run status.</p><p>If <code>quiet</code> is <code>true</code> (defaults to <code>false</code>), <code>in_stdin</code> and <code>out_stdout</code> are respectively replaced by <code>in_null</code> and <code>out_null</code> and <code>err</code> defaults to <code>err_null</code> rather than <code>err_stderr</code>.</p></dd></dl></section></section><section><header><h2 id="ex"><a href="#ex" class="anchor"></a>Examples</h2><p>Identity miaouw.</p><pre><code class="ml">let id s = OS.Cmd.(in_string s |&gt; run_io Cmd.(v &quot;cat&quot;) |&gt; out_string)</code></pre><p>Get the current list of git tracked files in OCaml:</p><pre><code class="ml">let git = Cmd.v &quot;git&quot;
let git_tracked () =
  let git_ls_files = Cmd.(git % &quot;ls-files&quot;) in
  OS.Cmd.(run_out git_ls_files |&gt; to_lines)</code></pre><p>Tarbzip the current list of git tracked files, without reading the tracked files in OCaml:</p><pre><code class="ml">let tbz_git_tracked dst =
  let git_ls_files = Cmd.(git % &quot;ls-files&quot;) in
  let tbz = Cmd.(v &quot;tar&quot; % &quot;-cvzf&quot; % p dst % &quot;-T&quot; % &quot;-&quot;) in
  OS.Cmd.(run_out git_ls_files |&gt; out_run_in) &gt;&gt;= fun tracked -&gt;
  OS.Cmd.(tracked |&gt; run_in tbz)</code></pre><p>Send the email <code>mail</code>.</p><pre><code class="ml">let send_email mail =
  let sendmail = Cmd.v &quot;sendmail&quot; in
  OS.Cmd.(in_string mail |&gt; run_in sendmail)</code></pre></header></section></div></body></html>