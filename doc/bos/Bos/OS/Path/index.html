<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Path (bos.Bos.OS.Path)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bos</a> &#x00BB; <a href="../../index.html">Bos</a> &#x00BB; <a href="../index.html">OS</a> &#x00BB; Path</nav><h1>Module <code>OS.Path</code></h1><p>Path operations.</p><p>These functions operate on files and directories equally. Similar and specific functions operating only on one kind of path can be found in the <a href="../File/index.html"><code>File</code></a> and <a href="../Dir/index.html"><code>Dir</code></a> modules.</p><nav class="toc"><ul><li><a href="#ops">Existence, move, deletion, information and mode</a></li><li><a href="#link">Path links</a></li><li><a href="#pathmatch">Matching path patterns against the file system</a></li><li><a href="#fold">Folding over file system hierarchies</a></li></ul></nav></header><section><header><h2 id="ops"><a href="#ops" class="anchor"></a>Existence, move, deletion, information and mode</h2></header><dl><dt class="spec value" id="val-exists"><a href="#val-exists" class="anchor"></a><code><span class="keyword">val </span>exists : Fpath.t <span>&#45;&gt;</span> (bool, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>exists p</code> is <code>true</code> if <code>p</code> exists for the file system and <code>false</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-must_exist"><a href="#val-must_exist" class="anchor"></a><code><span class="keyword">val </span>must_exist : Fpath.t <span>&#45;&gt;</span> (Fpath.t, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>must_exist p</code> is <code>Ok p</code> if <code>p</code> exists for the file system and an error otherwise.</p></dd></dl><dl><dt class="spec value" id="val-move"><a href="#val-move" class="anchor"></a><code><span class="keyword">val </span>move : ?&#8288;force:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>move ~force src dst</code> moves path <code>src</code> to <code>dst</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) the operation doesn't error if <code>dst</code> exists and can be replaced by <code>src</code>.</p></dd></dl><dl><dt class="spec value" id="val-delete"><a href="#val-delete" class="anchor"></a><code><span class="keyword">val </span>delete : ?&#8288;must_exist:bool <span>&#45;&gt;</span> ?&#8288;recurse:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>delete ~must_exist ~recurse p</code> deletes the path <code>p</code>. If <code>must_exist</code> is <code>true</code> (defaults to <code>false</code>) an error is returned if <code>p</code> doesn't exist. If <code>recurse</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> is a directory, no error occurs if the directory is non-empty: its contents is recursively deleted first.</p></dd></dl><dl><dt class="spec value" id="val-stat"><a href="#val-stat" class="anchor"></a><code><span class="keyword">val </span>stat : Fpath.t <span>&#45;&gt;</span> (Unix.stats, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>stat p</code> is <code>p</code>'s file information.</p></dd></dl><dl><dt class="spec module" id="module-Mode"><a href="#module-Mode" class="anchor"></a><code><span class="keyword">module </span><a href="Mode/index.html">Mode</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Path permission modes.</p></dd></dl></section><section><header><h2 id="link"><a href="#link" class="anchor"></a>Path links</h2></header><dl><dt class="spec value" id="val-link"><a href="#val-link" class="anchor"></a><code><span class="keyword">val </span>link : ?&#8288;force:bool <span>&#45;&gt;</span> target:Fpath.t <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>link ~force target p</code> hard links <code>target</code> to <code>p</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> exists, it is is <code>rmdir</code>ed or <code>unlink</code>ed before making the link.</p></dd></dl><dl><dt class="spec value" id="val-symlink"><a href="#val-symlink" class="anchor"></a><code><span class="keyword">val </span>symlink : ?&#8288;force:bool <span>&#45;&gt;</span> target:Fpath.t <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> (unit, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>symlink ~force target p</code> symbolically links <code>target</code> to <code>p</code>. If <code>force</code> is <code>true</code> (defaults to <code>false</code>) and <code>p</code> exists, it is <code>rmdir</code>ed or <code>unlink</code>ed before making the link.</p></dd></dl><dl><dt class="spec value" id="val-symlink_target"><a href="#val-symlink_target" class="anchor"></a><code><span class="keyword">val </span>symlink_target : Fpath.t <span>&#45;&gt;</span> (Fpath.t, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>slink_target p</code> is <code>p</code>'s target iff <code>p</code> is a symbolic link.</p></dd></dl><dl><dt class="spec value" id="val-symlink_stat"><a href="#val-symlink_stat" class="anchor"></a><code><span class="keyword">val </span>symlink_stat : Fpath.t <span>&#45;&gt;</span> (Unix.stats, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>symlink_stat p</code> is the same as <a href="index.html#val-stat"><code>stat</code></a> but if <code>p</code> is a link returns information about the link itself.</p></dd></dl></section><section><header><h2 id="pathmatch"><a href="#pathmatch" class="anchor"></a>Matching path patterns against the file system</h2><p>A path pattern <code>pat</code> is a path whose segments are made of <a href="../../Pat/index.html"><span>named string patterns</span></a>. Each variable of the pattern greedily matches a segment or sub-segment. For example the path pattern:</p><pre><code class="ml">Fpath.(v &quot;data&quot; / &quot;$(dir)&quot; / &quot;$(file).txt&quot;)</code></pre><p>matches any existing path of the file system that matches the regexp <code>data/.*/.*\.txt</code>.</p><p><b>Warning.</b> When segments with pattern variables are matched against the file system they never match <code>&quot;.&quot;</code> and <code>&quot;..&quot;</code>. For example the pattern <code>&quot;$(file).$(ext)&quot;</code> does not match <code>&quot;.&quot;</code>.</p></header><dl><dt class="spec value" id="val-matches"><a href="#val-matches" class="anchor"></a><code><span class="keyword">val </span>matches : ?&#8288;dotfiles:bool <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> (Fpath.t list, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>matches ~dotfiles pat</code> is the list of paths in the file system that match the path pattern <code>pat</code>. If <code>dotfiles</code> is <code>false</code> (default) segments that start with a pattern variable do not match dotfiles.</p></dd></dl><dl><dt class="spec value" id="val-query"><a href="#val-query" class="anchor"></a><code><span class="keyword">val </span>query : ?&#8288;dotfiles:bool <span>&#45;&gt;</span> ?&#8288;init:<a href="../../Pat/index.html#type-defs">Pat.defs</a> <span>&#45;&gt;</span> Fpath.t <span>&#45;&gt;</span> ((Fpath.t<span class="keyword"> * </span><a href="../../Pat/index.html#type-defs">Pat.defs</a>) list, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>query ~init pat</code> is like <a href="index.html#val-matches"><code>matches</code></a> except each matching path is returned with an environment mapping pattern variables to their matched part in the path. For each path the mappings are added to <code>init</code> (defaults to <span class="xref-unresolved" title="unresolved reference to &quot;String.Map.empty&quot;"><span class="xref-unresolved" title="unresolved reference to &quot;String.Map&quot;"><code>String</code>.Map</span>.empty</span>).</p></dd></dl></section><section><header><h2 id="fold"><a href="#fold" class="anchor"></a>Folding over file system hierarchies</h2></header><dl><dt class="spec type" id="type-traverse"><a href="#type-traverse" class="anchor"></a><code><span class="keyword">type </span>traverse</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-traverse.Any" class="anchored"><td class="def constructor"><a href="#type-traverse.Any" class="anchor"></a><code><span class="keyword">| </span></code><code>`Any</code></td></tr><tr id="type-traverse.None" class="anchored"><td class="def constructor"><a href="#type-traverse.None" class="anchor"></a><code><span class="keyword">| </span></code><code>`None</code></td></tr><tr id="type-traverse.Sat" class="anchored"><td class="def constructor"><a href="#type-traverse.Sat" class="anchor"></a><code><span class="keyword">| </span></code><code>`Sat<span class="keyword"> of </span>Fpath.t <span>&#45;&gt;</span> (bool, Rresult.R.msg) <a href="../index.html#type-result">result</a></code></td></tr></table><code> ]</code></dt><dd><p>The type for controlling directory traversals. The predicate of <code>`Sat</code> should only be called with directory paths, however this may not be the case due to OS races.</p></dd></dl><dl><dt class="spec type" id="type-elements"><a href="#type-elements" class="anchor"></a><code><span class="keyword">type </span>elements</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-elements.Any" class="anchored"><td class="def constructor"><a href="#type-elements.Any" class="anchor"></a><code><span class="keyword">| </span></code><code>`Any</code></td></tr><tr id="type-elements.Files" class="anchored"><td class="def constructor"><a href="#type-elements.Files" class="anchor"></a><code><span class="keyword">| </span></code><code>`Files</code></td></tr><tr id="type-elements.Dirs" class="anchored"><td class="def constructor"><a href="#type-elements.Dirs" class="anchor"></a><code><span class="keyword">| </span></code><code>`Dirs</code></td></tr><tr id="type-elements.Sat" class="anchored"><td class="def constructor"><a href="#type-elements.Sat" class="anchor"></a><code><span class="keyword">| </span></code><code>`Sat<span class="keyword"> of </span>Fpath.t <span>&#45;&gt;</span> (bool, Rresult.R.msg) <a href="../index.html#type-result">result</a></code></td></tr></table><code> ]</code></dt><dd><p>The type for specifying elements being folded over.</p></dd></dl><dl><dt class="spec type" id="type-fold_error"><a href="#type-fold_error" class="anchor"></a><code><span class="keyword">type </span>'a fold_error</code><code><span class="keyword"> = </span>Fpath.t <span>&#45;&gt;</span> (<span class="type-var">'a</span>, Rresult.R.msg) <a href="../index.html#type-result">result</a> <span>&#45;&gt;</span> (unit, Rresult.R.msg) <a href="../index.html#type-result">result</a></code></dt><dd><p>The type for managing fold errors.</p><p>During the fold, errors may be generated at different points of the process. For example, determining traversal with <a href="index.html#type-traverse"><code>traverse</code></a>, determining folded <a href="index.html#type-elements"><code>elements</code></a> or trying to <code>readdir(3)</code> a directory without having permissions.</p><p>These errors are given to a function of this type. If the function returns <code>Error _</code> the fold stops and returns that error. If the function returns <code>`Ok ()</code> the path is ignored for the operation and the fold continues.</p></dd></dl><dl><dt class="spec value" id="val-log_fold_error"><a href="#val-log_fold_error" class="anchor"></a><code><span class="keyword">val </span>log_fold_error : level:Logs.level <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-fold_error">fold_error</a></code></dt><dd><p><code>log_fold_error level</code> is a <a href="index.html#type-fold_error"><code>fold_error</code></a> function that logs error with level <code>level</code> and always returns <code>`Ok ()</code>.</p></dd></dl><dl><dt class="spec value" id="val-fold"><a href="#val-fold" class="anchor"></a><code><span class="keyword">val </span>fold : ?&#8288;err:<span class="type-var">'b</span> <a href="index.html#type-fold_error">fold_error</a> <span>&#45;&gt;</span> ?&#8288;dotfiles:bool <span>&#45;&gt;</span> ?&#8288;elements:<a href="index.html#type-elements">elements</a> <span>&#45;&gt;</span> ?&#8288;traverse:<a href="index.html#type-traverse">traverse</a> <span>&#45;&gt;</span> (Fpath.t <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> Fpath.t list <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'e</span>) <a href="../index.html#type-result">result</a></code></dt><dd><p><code>fold err dotfiles elements traverse f acc paths</code> folds over the list of paths <code>paths</code> traversing directories according to <code>traverse</code> (defaults to <code>`Any</code>) and selecting elements to fold over according to <code>elements</code> (defaults to <code>`Any</code>).</p><p>If <code>dotfiles</code> if <code>false</code> (default) both elements and directories to traverse that start with a <code>.</code> except <code>.</code> and <code>..</code> are skipped without being considered by <code>elements</code> or <code>traverse</code>'s values.</p><p><code>err</code> manages fold errors (see <a href="index.html#type-fold_error"><code>fold_error</code></a>), defaults to <a href="index.html#val-log_fold_error"><code>log_fold_error</code></a><code> ~level:Log.Error</code>.</p></dd></dl></section></div></body></html>