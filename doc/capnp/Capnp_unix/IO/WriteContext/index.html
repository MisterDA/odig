<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>WriteContext (capnp.Capnp_unix.IO.WriteContext)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">capnp</a> &#x00BB; <a href="../../index.html">Capnp_unix</a> &#x00BB; <a href="../index.html">IO</a> &#x00BB; WriteContext</nav><h1>Module <code>IO.WriteContext</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> 'a t</code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : write:(<span class="type-var">'a</span> <span>&#45;&gt;</span> buf:string <span>&#45;&gt;</span> pos:int <span>&#45;&gt;</span> len:int <span>&#45;&gt;</span> int) <span>&#45;&gt;</span> compression:<a href="../../../Capnp/Codecs/index.html#type-compression_t">Capnp.Codecs.compression_t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create ~write ~compression descr</code> creates a new context for writing data to the specified descriptor. <code>compression</code> specifies the compression format, if any.</p><p>The semantics of the <code>write</code> function shall mimic that of <code>Unix.single_write</code>, attempting to write a substring from the <code>buf</code> and returning the number of bytes actually written.</p></dd></dl><dl><dt class="spec value" id="val-enqueue_message"><a href="#val-enqueue_message" class="anchor"></a><code><span class="keyword">val</span> enqueue_message : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'cap</span> <a href="../../../Capnp__Message/BytesMessage/Message/index.html#type-t">Capnp.Message.BytesMessage.Message.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>enqueue_message context message</code> places the <code>message</code> in the outgoing queue of the write <code>context</code>. No data will be written to the underlying descriptor.</p></dd></dl><dl><dt class="spec value" id="val-bytes_remaining"><a href="#val-bytes_remaining" class="anchor"></a><code><span class="keyword">val</span> bytes_remaining : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>bytes_remaining context</code> obtains the number of unwritten bytes currently stored in the write <code>context</code>.</p></dd></dl><dl><dt class="spec value" id="val-write"><a href="#val-write" class="anchor"></a><code><span class="keyword">val</span> write : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>write context</code> attempts to write some of the queued data to the underlying descriptor associated with the write <code>context</code>.</p><dl><dt>returns</dt><dd><p>the number of bytes actually written</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-write_message"><a href="#val-write_message" class="anchor"></a><code><span class="keyword">val</span> write_message : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'cap</span> <a href="../../../Capnp__Message/BytesMessage/Message/index.html#type-t">Capnp.Message.BytesMessage.Message.t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>write_message context message</code> places the <code>message</code> in the outgoing queue of the write <code>context</code>, then invokes <code>write</code> in a loop until all queued data has been written.</p></dd></dl></div></body></html>