<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Decode (cconv.CConv.Decode)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">cconv</a> &#x00BB; <a href="../index.html">CConv</a> &#x00BB; Decode</nav><h1>Module <code>CConv.Decode</code></h1><h3 id="decode"><a href="#decode" class="anchor"></a>Decode</h3><p>A 'a decodee describes a way to traverse a value of some type representing a serialization format such as JSON or B-encode</p><nav class="toc"><ul><li><a href="#decoder-combinators">Decoder Combinators</a></li></ul></nav></header><dl><dt class="spec type" id="type-source"><a href="#type-source" class="anchor"></a><code><span class="keyword">type</span> 'src source</code><code> = </code><code>{</code><table class="record"><tr id="type-source.emit" class="anchored"><td class="def field"><a href="#type-source.emit" class="anchor"></a><code>emit : a. (<span class="type-var">'src</span>, <span class="type-var">'a</span>) <a href="index.html#type-inner_decoder">inner_decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>;</code></td></tr></table><code>}</code></dt><dd><p>Decode a value of type 'src</p></dd></dl><dl><dt class="spec type" id="type-inner_decoder"><a href="#type-inner_decoder" class="anchor"></a><code><span class="keyword">and</span> ('src, 'into) inner_decoder</code><code> = </code><code>{</code><table class="record"><tr id="type-inner_decoder.accept_unit" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_unit" class="anchor"></a><code>accept_unit : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_bool" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_bool" class="anchor"></a><code>accept_bool : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_float" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_float" class="anchor"></a><code>accept_float : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_int" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_int" class="anchor"></a><code>accept_int : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_int32" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_int32" class="anchor"></a><code>accept_int32 : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_int64" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_int64" class="anchor"></a><code>accept_int64 : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> int64 <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_nativeint" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_nativeint" class="anchor"></a><code>accept_nativeint : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> nativeint <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_char" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_char" class="anchor"></a><code>accept_char : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_string" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_string" class="anchor"></a><code>accept_string : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_list" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_list" class="anchor"></a><code>accept_list : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_option" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_option" class="anchor"></a><code>accept_option : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> option <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_record" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_record" class="anchor"></a><code>accept_record : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> (string * <span class="type-var">'src</span>) list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_tuple" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_tuple" class="anchor"></a><code>accept_tuple : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr><tr id="type-inner_decoder.accept_sum" class="anchored"><td class="def field"><a href="#type-inner_decoder.accept_sum" class="anchor"></a><code>accept_sum : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr></table><code>}</code></dt><dd><p>Decode a value of type 'src into a type 'into.</p></dd></dl><dl><dt class="spec type" id="type-decoder"><a href="#type-decoder" class="anchor"></a><code><span class="keyword">type</span> 'into decoder</code><code> = </code><code>{</code><table class="record"><tr id="type-decoder.dec" class="anchored"><td class="def field"><a href="#type-decoder.dec" class="anchor"></a><code>dec : src. (<span class="type-var">'src</span>, <span class="type-var">'into</span>) <a href="index.html#type-inner_decoder">inner_decoder</a>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-apply"><a href="#val-apply" class="anchor"></a><code><span class="keyword">val</span> apply : <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <span>&#45;&gt;</span> <span class="type-var">'into</span></code></dt><dd><p>Apply a decoder to a source</p></dd></dl><section><header><h6 id="decoder-combinators"><a href="#decoder-combinators" class="anchor"></a>Decoder Combinators</h6></header><dl><dt class="spec value" id="val-int"><a href="#val-int" class="anchor"></a><code><span class="keyword">val</span> int : int <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-char"><a href="#val-char" class="anchor"></a><code><span class="keyword">val</span> char : char <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-int32"><a href="#val-int32" class="anchor"></a><code><span class="keyword">val</span> int32 : int32 <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-int64"><a href="#val-int64" class="anchor"></a><code><span class="keyword">val</span> int64 : int64 <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-nativeint"><a href="#val-nativeint" class="anchor"></a><code><span class="keyword">val</span> nativeint : nativeint <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-float"><a href="#val-float" class="anchor"></a><code><span class="keyword">val</span> float : float <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span class="keyword">val</span> bool : bool <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-unit"><a href="#val-unit" class="anchor"></a><code><span class="keyword">val</span> unit : unit <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-string"><a href="#val-string" class="anchor"></a><code><span class="keyword">val</span> string : string <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">val</span> list : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-option"><a href="#val-option" class="anchor"></a><code><span class="keyword">val</span> option : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> option <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-array"><a href="#val-array" class="anchor"></a><code><span class="keyword">val</span> array : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> array <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-sequence"><a href="#val-sequence" class="anchor"></a><code><span class="keyword">val</span> sequence : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../index.html#type-sequence">sequence</a> <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val</span> map : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-decoder">decoder</a></code></dt><dd><p>Map the decoded value</p></dd></dl><dl><dt class="spec value" id="val-arg0"><a href="#val-arg0" class="anchor"></a><code><span class="keyword">val</span> arg0 : <span class="type-var">'src</span> list <span>&#45;&gt;</span> unit</code></dt><dd><p>Only accepts an empty list/tuple</p></dd></dl><dl><dt class="spec value" id="val-arg1"><a href="#val-arg1" class="anchor"></a><code><span class="keyword">val</span> arg1 : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Only accepts a 1-element list/tuple</p></dd></dl><dl><dt class="spec value" id="val-arg2"><a href="#val-arg2" class="anchor"></a><code><span class="keyword">val</span> arg2 : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'a</span> * <span class="type-var">'b</span></code></dt><dd><p>Only accepts a 2-elements list/tuple</p></dd></dl><dl><dt class="spec value" id="val-arg3"><a href="#val-arg3" class="anchor"></a><code><span class="keyword">val</span> arg3 : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span></code></dt><dd><p>Only accepts a 3-elements list/tuple</p></dd></dl><dl><dt class="spec value" id="val-option"><a href="#val-option" class="anchor"></a><code><span class="keyword">val</span> option : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> option <a href="index.html#type-decoder">decoder</a></code></dt><dd><p>Helper for options</p></dd></dl><dl><dt class="spec value" id="val-pair"><a href="#val-pair" class="anchor"></a><code><span class="keyword">val</span> pair : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span>) <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-triple"><a href="#val-triple" class="anchor"></a><code><span class="keyword">val</span> triple : <span class="type-var">'a</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>) <a href="index.html#type-decoder">decoder</a></code></dt><dt class="spec value" id="val-record_get"><a href="#val-record_get" class="anchor"></a><code><span class="keyword">val</span> record_get : string <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> (string * <span class="type-var">'src</span>) list <span>&#45;&gt;</span> <span class="type-var">'into</span></code></dt><dd><p><code>record_get name dec l</code> is a helper for decoding records. It is given a list of fields <code>l</code>, and searches <code>name</code> through it. If <code>name</code> is found with a value <code>v</code>, <code>dec.accept v</code> is called. Otherwise an error is raised</p></dd></dl><dl><dt class="spec value" id="val-record_get_opt"><a href="#val-record_get_opt" class="anchor"></a><code><span class="keyword">val</span> record_get_opt : string <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> (string * <span class="type-var">'src</span>) list <span>&#45;&gt;</span> <span class="type-var">'into</span> option</code></dt></dl><dl><dt class="spec type" id="type-record_decoder"><a href="#type-record_decoder" class="anchor"></a><code><span class="keyword">type</span> 'into record_decoder</code><code> = </code><code>{</code><table class="record"><tr id="type-record_decoder.record_accept" class="anchored"><td class="def field"><a href="#type-record_decoder.record_accept" class="anchor"></a><code>record_accept : src. <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> (string * <span class="type-var">'src</span>) list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-record"><a href="#val-record" class="anchor"></a><code><span class="keyword">val</span> record : <span class="type-var">'into</span> <a href="index.html#type-record_decoder">record_decoder</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a></code></dt><dd><p>Decoder for records. It will adapt itself to association tuples and lists.</p></dd></dl><dl><dt class="spec value" id="val-record_fix"><a href="#val-record_fix" class="anchor"></a><code><span class="keyword">val</span> record_fix : (<span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-record_decoder">record_decoder</a>) <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a></code></dt></dl><dl><dt class="spec type" id="type-sum_decoder"><a href="#type-sum_decoder" class="anchor"></a><code><span class="keyword">type</span> 'into sum_decoder</code><code> = </code><code>{</code><table class="record"><tr id="type-sum_decoder.sum_accept" class="anchored"><td class="def field"><a href="#type-sum_decoder.sum_accept" class="anchor"></a><code>sum_accept : src. <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-sum"><a href="#val-sum" class="anchor"></a><code><span class="keyword">val</span> sum : <span class="type-var">'into</span> <a href="index.html#type-sum_decoder">sum_decoder</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a></code></dt><dd><p>Decoder for sums. It will adapt itself to strings, lists and tuples</p></dd></dl><dl><dt class="spec value" id="val-sum_fix"><a href="#val-sum_fix" class="anchor"></a><code><span class="keyword">val</span> sum_fix : (<span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-sum_decoder">sum_decoder</a>) <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a></code></dt></dl><dl><dt class="spec type" id="type-tuple_decoder"><a href="#type-tuple_decoder" class="anchor"></a><code><span class="keyword">type</span> 'into tuple_decoder</code><code> = </code><code>{</code><table class="record"><tr id="type-tuple_decoder.tuple_accept" class="anchored"><td class="def field"><a href="#type-tuple_decoder.tuple_accept" class="anchor"></a><code>tuple_accept : src. <span class="type-var">'src</span> <a href="index.html#type-source">source</a> <span>&#45;&gt;</span> <span class="type-var">'src</span> list <span>&#45;&gt;</span> <span class="type-var">'into</span>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-tuple"><a href="#val-tuple" class="anchor"></a><code><span class="keyword">val</span> tuple : <span class="type-var">'into</span> <a href="index.html#type-tuple_decoder">tuple_decoder</a> <span>&#45;&gt;</span> <span class="type-var">'into</span> <a href="index.html#type-decoder">decoder</a></code></dt><dd><p>Tuple decoder</p></dd></dl><aside><p>Examples:</p><pre><code class="ml">type mytuple = int * string * float list ;;

let decode_mytuple = tuple {
  tuple_accept=fun src l -&gt; arg3 int int (list string) src l);
};;

(* OR, because triples are really easy: *)
let decode_mytuple = triple int int (list string);;

type point = { x:int;  y:int; color:string };;

let decode_point = record ~expected:&quot;point&quot; {
  record_accept=(fun src l -&gt;
    let x = record_get &quot;x&quot; int src l in
    let y = record_get &quot;y&quot; int src l in
    let color = record_get &quot;color&quot; string src l in
    {x;y;color}
  );
};;</code></pre></aside></section></div></body></html>