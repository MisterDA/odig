<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Core_extended__Atomic_edit (core_extended.Core_extended__Atomic_edit)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">core_extended</a> &#x00BB; Core_extended__Atomic_edit</nav><h1>Module <code>Core_extended__Atomic_edit</code></h1><p>Atomically edit a file without long-term locking</p><p>See documentation for the function <code>atomic_edit</code></p></header><dl><dt class="spec type" id="type-return_type"><a href="#type-return_type" class="anchor"></a><code><span class="keyword">type</span> return_type</code><code> = </code><table class="variant"><tr id="type-return_type.Ok" class="anchored"><td class="def constructor"><a href="#type-return_type.Ok" class="anchor"></a><code>| </code><code><span class="constructor">Ok</span></code></td></tr><tr id="type-return_type.Changed" class="anchored"><td class="def constructor"><a href="#type-return_type.Changed" class="anchor"></a><code>| </code><code><span class="constructor">Changed</span> <span class="keyword">of</span> string * string</code></td></tr><tr id="type-return_type.Abort" class="anchored"><td class="def constructor"><a href="#type-return_type.Abort" class="anchor"></a><code>| </code><code><span class="constructor">Abort</span></code></td></tr></table></dt><dd><p>the return value of <code>atomic_edit</code></p></dd></dl><dl><dt class="spec value" id="val-atomic_edit"><a href="#val-atomic_edit" class="anchor"></a><code><span class="keyword">val</span> atomic_edit : f:(string <span>&#45;&gt;</span> [ `Ok | `Abort ]) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-return_type">return_type</a></code></dt><dd><p><code>atomic_edit ~f filepath</code> edit <code>filepath</code> by making a unique copy (peer) that can be openly changed without holding any locks on the original. When the function returns, a short term exclusive lock is held while overwriting the original with the edited copy. If the mtime of the original is changed since the copy was made, the replacement is aborted (indicating another <code>atomic_edit</code> was first to update the file, or some other process) and Changed is returned with a tuple <code>(warning message * terd file)</code>. The terd file contains the edits and might be used to diff or re-edit.</p></dd></dl></div></body></html>