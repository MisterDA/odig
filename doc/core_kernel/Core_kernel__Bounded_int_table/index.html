<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Core_kernel__Bounded_int_table (core_kernel.Core_kernel__Bounded_int_table)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">core_kernel</a> &#x00BB; Core_kernel__Bounded_int_table</nav><h1>Module <code>Core_kernel__Bounded_int_table</code></h1><p>A <code>Bounded_int_table</code> is a table whose keys can be mapped to integers in a fixed range, 0 ... num_keys-1, where <code>num_keys</code> is specified at table-creation time. The purpose of <code>Bounded_int_table</code> is to be faster than <code>Hashtbl</code> in situations where one is willing to pay a space cost for the speed.</p><p><code>Bounded_int_table</code> presents a subset of the <code>Hashtbl</code> interface. The key type can be any type, but table creation requires a <code>key_to_int</code> function, which will be used to extract the integer of all keys. If multiple keys map to the same integer, then only one of them can be in the table at a time. Any operation that supplies a key whose corresponding integer is outside the allowed range for the table will cause an exception.</p><p>A <code>Bounded_int_table</code> is implemented using two fixed size arrays of size <code>num_keys</code>, which are supplied at table-creation time. The space used does not depend on the <code>length</code> of the table but rather only on <code>num_keys</code>. Operations that deal with a single element (find, mem, add, remove, set) take constant time, and perform one or two array operations. Operations that deal with all of the keys defined in the table (data, fold, iter, iter_vals, keys, to_alist) take time proportional to the <code>length</code> of the table, not <code>num_keys</code>.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>('key, 'data) t</code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><span class="keyword">sig</span> ... <span class="keyword">end</span></code></span></summary><dl><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val </span>sexp_of_t : (<span class="type-var">'key</span> <span>&#45;&gt;</span> Sexplib.Sexp.t) <span>&#45;&gt;</span> (<span class="type-var">'data</span> <span>&#45;&gt;</span> Sexplib.Sexp.t) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt></dl></details></div></div></div><dl><dt class="spec type" id="type-table"><a href="#type-table" class="anchor"></a><code><span class="keyword">type </span>('a, 'b) table</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span>Core_kernel__.Import.Invariant.S2<span class="keyword"> with </span><span class="keyword">type </span>('a, 'b) <a href="index.html">Core_kernel__Bounded_int_table</a>.t := (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec value" id="val-invariant"><a href="#val-invariant" class="anchor"></a><code><span class="keyword">val </span>invariant : <span class="type-var">'a</span> Base__.Invariant_intf.inv <span>&#45;&gt;</span> <span class="type-var">'b</span> Base__.Invariant_intf.inv <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> Base__.Invariant_intf.inv</code></dt></dl></details></div></div></div><div><div class="spec include"><div class="doc"><p>Equality only requires the keys and values to be the same, not the bin or sexp formatting or the integers the keys correspond to (see <code>key_to_int</code>).</p><details open="open"><summary><span class="def"><code><span class="keyword">include </span>Core_kernel__.Import.Equal.S2<span class="keyword"> with </span><span class="keyword">type </span>('a, 'b) <a href="index.html">Core_kernel__Bounded_int_table</a>.t := (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val </span>equal : <span class="type-var">'a</span> Core_kernel__.Import.Equal.equal <span>&#45;&gt;</span> <span class="type-var">'b</span> Core_kernel__.Import.Equal.equal <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> Core_kernel__.Import.Equal.equal</code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : ?&#8288;sexp_of_key:(<span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Std_internal.Sexp.t) <span>&#45;&gt;</span> num_keys:Core_kernel__.Import.int <span>&#45;&gt;</span> key_to_int:(<span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Import.int) <span>&#45;&gt;</span> Core_kernel__.Import.unit <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>create ~num_keys ~key_to_int</code> returns a table where the keys can map to 0 .. num_keys-1, according to <code>key_to_int</code>. It is an error if <code>num_keys &lt; 0</code>.</p><p><code>sexp_of_key</code>, if supplied, will be used to display keys in error messages.</p></dd></dl><dl><dt class="spec value" id="val-num_keys"><a href="#val-num_keys" class="anchor"></a><code><span class="keyword">val </span>num_keys : (<span class="type-var">_</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Core_kernel__.Import.int</code></dt><dt class="spec value" id="val-keys"><a href="#val-keys" class="anchor"></a><code><span class="keyword">val </span>keys : (<span class="type-var">'key</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> Core_kernel__.Import.list</code></dt><dd><p>Standard hashtbl functions.</p></dd></dl><dl><dt class="spec value" id="val-data"><a href="#val-data" class="anchor"></a><code><span class="keyword">val </span>data : (<span class="type-var">_</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'data</span> Core_kernel__.Import.list</code></dt><dt class="spec value" id="val-find"><a href="#val-find" class="anchor"></a><code><span class="keyword">val </span>find : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> <span>&#45;&gt;</span> <span class="type-var">'data</span> Core_kernel__.Import.option</code></dt><dt class="spec value" id="val-find_exn"><a href="#val-find_exn" class="anchor"></a><code><span class="keyword">val </span>find_exn : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> <span>&#45;&gt;</span> <span class="type-var">'data</span></code></dt><dt class="spec value" id="val-find_or_add"><a href="#val-find_or_add" class="anchor"></a><code><span class="keyword">val </span>find_or_add : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> <span>&#45;&gt;</span> default:(Core_kernel__.Import.unit <span>&#45;&gt;</span> <span class="type-var">'data</span>) <span>&#45;&gt;</span> <span class="type-var">'data</span></code></dt><dt class="spec value" id="val-fold"><a href="#val-fold" class="anchor"></a><code><span class="keyword">val </span>fold : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> init:<span class="type-var">'accum</span> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data</span> <span>&#45;&gt;</span> <span class="type-var">'accum</span> <span>&#45;&gt;</span> <span class="type-var">'accum</span>) <span>&#45;&gt;</span> <span class="type-var">'accum</span></code></dt><dt class="spec value" id="val-iter_keys"><a href="#val-iter_keys" class="anchor"></a><code><span class="keyword">val </span>iter_keys : (<span class="type-var">'key</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit) <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-iter"><a href="#val-iter" class="anchor"></a><code><span class="keyword">val </span>iter : (<span class="type-var">_</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit) <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-iteri"><a href="#val-iteri" class="anchor"></a><code><span class="keyword">val </span>iteri : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit) <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-iter_vals"><a href="#val-iter_vals" class="anchor"></a><code><span class="keyword">val </span>iter_vals : (<span class="type-var">_</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit) <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-filter_mapi"><a href="#val-filter_mapi" class="anchor"></a><code><span class="keyword">val </span>filter_mapi : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data1</span> <span>&#45;&gt;</span> <span class="type-var">'data2</span> Core_kernel__.Import.option) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data2</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-filter_map"><a href="#val-filter_map" class="anchor"></a><code><span class="keyword">val </span>filter_map : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data1</span> <span>&#45;&gt;</span> <span class="type-var">'data2</span> Core_kernel__.Import.option) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data2</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-filter_keys"><a href="#val-filter_keys" class="anchor"></a><code><span class="keyword">val </span>filter_keys : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-filter"><a href="#val-filter" class="anchor"></a><code><span class="keyword">val </span>filter : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data1</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-filteri"><a href="#val-filteri" class="anchor"></a><code><span class="keyword">val </span>filteri : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data1</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-mapi"><a href="#val-mapi" class="anchor"></a><code><span class="keyword">val </span>mapi : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data1</span> <span>&#45;&gt;</span> <span class="type-var">'data2</span>) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data2</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val </span>map : (<span class="type-var">'key</span>, <span class="type-var">'data1</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data1</span> <span>&#45;&gt;</span> <span class="type-var">'data2</span>) <span>&#45;&gt;</span> (<span class="type-var">'key</span>, <span class="type-var">'data2</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-for_alli"><a href="#val-for_alli" class="anchor"></a><code><span class="keyword">val </span>for_alli : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> Core_kernel__.Import.bool</code></dt><dt class="spec value" id="val-existsi"><a href="#val-existsi" class="anchor"></a><code><span class="keyword">val </span>existsi : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'key</span> <span>&#45;&gt;</span> data:<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> Core_kernel__.Import.bool</code></dt><dt class="spec value" id="val-for_all"><a href="#val-for_all" class="anchor"></a><code><span class="keyword">val </span>for_all : (<span class="type-var">_</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> Core_kernel__.Import.bool</code></dt><dt class="spec value" id="val-exists"><a href="#val-exists" class="anchor"></a><code><span class="keyword">val </span>exists : (<span class="type-var">_</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(<span class="type-var">'data</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool) <span>&#45;&gt;</span> Core_kernel__.Import.bool</code></dt><dt class="spec value" id="val-length"><a href="#val-length" class="anchor"></a><code><span class="keyword">val </span>length : (<span class="type-var">_</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Core_kernel__.Import.int</code></dt><dt class="spec value" id="val-mem"><a href="#val-mem" class="anchor"></a><code><span class="keyword">val </span>mem : (<span class="type-var">'key</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Import.bool</code></dt><dt class="spec value" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val </span>remove : (<span class="type-var">'key</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'key</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val </span>set : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> key:<span class="type-var">'a</span> <span>&#45;&gt;</span> data:<span class="type-var">'b</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-add"><a href="#val-add" class="anchor"></a><code><span class="keyword">val </span>add : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> key:<span class="type-var">'a</span> <span>&#45;&gt;</span> data:<span class="type-var">'b</span> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Duplicate of <span class="type-var">'b</span> ]</code></dt><dt class="spec value" id="val-add_exn"><a href="#val-add_exn" class="anchor"></a><code><span class="keyword">val </span>add_exn : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> key:<span class="type-var">'a</span> <span>&#45;&gt;</span> data:<span class="type-var">'b</span> <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt><dt class="spec value" id="val-to_alist"><a href="#val-to_alist" class="anchor"></a><code><span class="keyword">val </span>to_alist : (<span class="type-var">'key</span>, <span class="type-var">'data</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'key</span><span class="keyword"> * </span><span class="type-var">'data</span>) Core_kernel__.Import.list</code></dt><dt class="spec value" id="val-clear"><a href="#val-clear" class="anchor"></a><code><span class="keyword">val </span>clear : (<span class="type-var">_</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Core_kernel__.Import.unit</code></dt></dl><div class="spec module" id="module-With_key"><a href="#module-With_key" class="anchor"></a><code><span class="keyword">module </span><a href="With_key/index.html">With_key</a> : <span class="keyword">functor</span> (<a href="With_key/argument-1-Key/index.html">Key</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><dl><dt class="spec value" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span class="keyword">val </span>debug : Core_kernel__.Import.bool Core_kernel__.Std_internal.ref</code></dt><dd><p>set <code>debug := true</code> to turn on debugging, including potentially slow invariant checking.</p></dd></dl></div></body></html>