<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Core_profiler__Common (core_profiler.Core_profiler__Common)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">core_profiler</a> &#x00BB; Core_profiler__Common</nav><h1>Module <code>Core_profiler__Common</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><table class="variant"><tr id="type-t.Online_profiler" class="anchored"><td class="def constructor"><a href="#type-t.Online_profiler" class="anchor"></a><code>| </code><code><span class="constructor">Online_profiler</span></code></td></tr><tr id="type-t.Offline_profiler" class="anchored"><td class="def constructor"><a href="#type-t.Offline_profiler" class="anchor"></a><code>| </code><code><span class="constructor">Offline_profiler</span></code></td></tr><tr id="type-t.Any_profiler" class="anchored"><td class="def constructor"><a href="#type-t.Any_profiler" class="anchor"></a><code>| </code><code><span class="constructor">Any_profiler</span></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-now_no_calibrate"><a href="#val-now_no_calibrate" class="anchor"></a><code><span class="keyword">val</span> now_no_calibrate : unit <span>&#45;&gt;</span> <a href="../../core/Core__/Core_time_ns/index.html#type-t">Core.Time_ns.t</a></code></dt><dd><p>now, possibly with calibration error.</p></dd></dl><dl><dt class="spec value" id="val-add_slow_task"><a href="#val-add_slow_task" class="anchor"></a><code><span class="keyword">val</span> add_slow_task : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>slow_tasks</code> is a list of functions that should be called rougly every second while the library is in use. The time-since-we-last-did-slow-tasks is checked on every call to <code>now</code> and <code>maybe_do_slow_tasks</code> below. <code>add_slow_task</code> adds one more slow task.</p></dd></dl><dl><dt class="spec value" id="val-now"><a href="#val-now" class="anchor"></a><code><span class="keyword">val</span> now : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> reluctance:int <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="../../core/Core__/Core_time_ns/index.html#type-t">Core.Time_ns.t</a></code></dt><dd><p><code>reluctance</code> is higher if we don't want to do 'slow tasks' / don't want a potential 300ns spike.</p><p>We _really_ don't want this in <code>Group.Point.at</code>s and <code>Delta_probe.start</code>s (reluctance:4) since the spike would be included in the calculation of a delta. We'd rather not on <code>Timer.record</code>s (r:3) since they are more liable to be in the middle of something performance sensitive. We're slightly more happy to calibrate after a <code>Group.reset</code> (r:2), but ideally want to calibrate on a call to <code>safe_to_delay</code> (r:1; lowest).</p><p>Here <code>t</code> specifies the kind of slow tasks to run if the reluctance has been overcome.</p></dd></dl><dl><dt class="spec value" id="val-maybe_do_slow_tasks"><a href="#val-maybe_do_slow_tasks" class="anchor"></a><code><span class="keyword">val</span> maybe_do_slow_tasks : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> reluctance:int <span>&#45;&gt;</span> unit</code></dt></dl></div></body></html>