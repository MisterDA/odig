<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Block (cryptokit.Cryptokit.Block)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">cryptokit</a> &#x00BB; <a href="../index.html">Cryptokit</a> &#x00BB; Block</nav><h1>Module <code>Cryptokit.Block</code></h1><p>The <code>Block</code> module provides classes that implements popular block ciphers, chaining modes, and wrapping of a block cipher as a general transform or as a hash function. The classes can be composed in a Lego-like fashion, facilitating the integration of new block ciphers, modes, etc.</p><nav class="toc"><ul><li><a href="#deriving-transforms-and-hashes-from-block-ciphers">Deriving transforms and hashes from block ciphers</a></li><li><a href="#some-block-ciphers:-aes,-des,-triple-des,-blowfish">Some block ciphers: AES, DES, triple DES, Blowfish</a></li><li><a href="#chaining-modes">Chaining modes</a></li></ul></nav></header><dl><dt class="spec class-type" id="class-type-block_cipher"><a href="#class-type-block_cipher" class="anchor"></a><code><span class="keyword">class</span> <span class="keyword">type</span> <a href="class-type-block_cipher/index.html">block_cipher</a> = <span class="keyword">object</span> ... <span class="keyword">end</span></code></dt><dd><p>Abstract interface for a block cipher.</p></dd></dl><section><header><h2 id="deriving-transforms-and-hashes-from-block-ciphers"><a href="#deriving-transforms-and-hashes-from-block-ciphers" class="anchor"></a>Deriving transforms and hashes from block ciphers</h2></header><dl><dt class="spec class" id="class-cipher"><a href="#class-cipher" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cipher/index.html">cipher</a> : <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Wraps a block cipher as a general transform. The transform has input block size and output block size equal to the block size of the block cipher. No padding is performed. Example: <code>new cipher (new cbc_encrypt (new aes_encrypt key))</code> returns a transform that performs AES encryption in CBC mode.</p></dd></dl><dl><dt class="spec class" id="class-cipher_padded_encrypt"><a href="#class-cipher_padded_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cipher_padded_encrypt/index.html">cipher_padded_encrypt</a> : <a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Wraps a block cipher as a general transform. The transform has input block size and output block size equal to the block size of the block cipher. No padding is performed. Example: <code>new cipher (new cbc_encrypt (new aes_encrypt key))</code> returns a transform that performs AES encryption in CBC mode.</p></dd></dl><dl><dt class="spec class" id="class-cipher_padded_decrypt"><a href="#class-cipher_padded_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cipher_padded_decrypt/index.html">cipher_padded_decrypt</a> : <a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="../class-type-transform/index.html">transform</a></code></dt><dd><p>Like <a href="class-cipher/index.html"><code>Cryptokit.Block.cipher</code></a>, but performs padding on the input data as specified by the first argument. The input block size of the returned transform is 1; the output block size is the block size of the block cipher.</p></dd></dl><dl><dt class="spec class" id="class-mac"><a href="#class-mac" class="anchor"></a><code><span class="keyword">class</span> <a href="class-mac/index.html">mac</a> : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p>Like <a href="class-cipher/index.html"><code>Cryptokit.Block.cipher</code></a>, but removes padding on the output data as specified by the first argument. The output block size of the returned transform is 1; the input block size is the block size of the block cipher.</p></dd></dl><dl><dt class="spec class" id="class-mac_final_triple"><a href="#class-mac_final_triple" class="anchor"></a><code><span class="keyword">class</span> <a href="class-mac_final_triple/index.html">mac_final_triple</a> : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;pad:<a href="../Padding/class-type-scheme/index.html">Padding.scheme</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="../class-type-hash/index.html">hash</a></code></dt><dd><p>Build a MAC (keyed hash function) from the given block cipher. The block cipher is run in CBC mode, and the MAC value is the final value of the initialization vector. Thus, the hash size of the resulting hash is the block size of the block cipher. The optional argument <code>iv</code> specifies the first initialization vector, with a default of all zeroes. The optional argument <code>pad</code> specifies a padding scheme to be applied to the input data; if not provided, no padding is performed.</p></dd></dl></section><section><header><h2 id="some-block-ciphers:-aes,-des,-triple-des,-blowfish"><a href="#some-block-ciphers:-aes,-des,-triple-des,-blowfish" class="anchor"></a>Some block ciphers: AES, DES, triple DES, Blowfish</h2></header><dl><dt class="spec class" id="class-aes_encrypt"><a href="#class-aes_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-aes_encrypt/index.html">aes_encrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The AES block cipher, in encryption mode. The string argument is the key; its length must be 16, 24 or 32 bytes.</p></dd></dl><dl><dt class="spec class" id="class-aes_decrypt"><a href="#class-aes_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-aes_decrypt/index.html">aes_decrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The AES block cipher, in encryption mode. The string argument is the key; its length must be 16, 24 or 32 bytes.</p></dd></dl><dl><dt class="spec class" id="class-des_encrypt"><a href="#class-des_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-des_encrypt/index.html">des_encrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The DES block cipher, in encryption mode. The string argument is the key; its length must be 8 bytes.</p></dd></dl><dl><dt class="spec class" id="class-des_decrypt"><a href="#class-des_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-des_decrypt/index.html">des_decrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The DES block cipher, in encryption mode. The string argument is the key; its length must be 8 bytes.</p></dd></dl><dl><dt class="spec class" id="class-triple_des_encrypt"><a href="#class-triple_des_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-triple_des_encrypt/index.html">triple_des_encrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The Triple-DES block cipher, in encryption mode. The key argument must have length 16 (two keys) or 24 (three keys).</p></dd></dl><dl><dt class="spec class" id="class-triple_des_decrypt"><a href="#class-triple_des_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-triple_des_decrypt/index.html">triple_des_decrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The Triple-DES block cipher, in encryption mode. The key argument must have length 16 (two keys) or 24 (three keys).</p></dd></dl><dl><dt class="spec class" id="class-blowfish_encrypt"><a href="#class-blowfish_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-blowfish_encrypt/index.html">blowfish_encrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The Blowfish block cipher, in encryption mode. The string argument is the key; its length must be between 4 and 56.</p></dd></dl><dl><dt class="spec class" id="class-blowfish_decrypt"><a href="#class-blowfish_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-blowfish_decrypt/index.html">blowfish_decrypt</a> : string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>The Blowfish block cipher, in encryption mode. The string argument is the key; its length must be between 4 and 56.</p></dd></dl></section><section><header><h2 id="chaining-modes"><a href="#chaining-modes" class="anchor"></a>Chaining modes</h2></header><dl><dt class="spec class" id="class-cbc_encrypt"><a href="#class-cbc_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cbc_encrypt/index.html">cbc_encrypt</a> : ?&#8288;iv:string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Cipher Block Chaining (CBC) to the given block cipher in encryption mode. Each block of input is xor-ed with the previous output block before being encrypted through the given block cipher. The optional <code>iv</code> argument specifies the string to be xor-ed with the first input block, and defaults to all zeroes. The returned block cipher has the same block size as the underlying block cipher.</p></dd></dl><dl><dt class="spec class" id="class-cbc_decrypt"><a href="#class-cbc_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cbc_decrypt/index.html">cbc_decrypt</a> : ?&#8288;iv:string <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Cipher Block Chaining (CBC) to the given block cipher in encryption mode. Each block of input is xor-ed with the previous output block before being encrypted through the given block cipher. The optional <code>iv</code> argument specifies the string to be xor-ed with the first input block, and defaults to all zeroes. The returned block cipher has the same block size as the underlying block cipher.</p></dd></dl><dl><dt class="spec class" id="class-cfb_encrypt"><a href="#class-cfb_encrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cfb_encrypt/index.html">cfb_encrypt</a> : ?&#8288;iv:string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Cipher Feedback Block (CFB) to the given block cipher in encryption mode. The integer argument <code>n</code> is the number of bytes processed at a time; it must lie between <code>1</code> and the block size of the underlying cipher, included. The returned block cipher has block size <code>n</code>.</p></dd></dl><dl><dt class="spec class" id="class-cfb_decrypt"><a href="#class-cfb_decrypt" class="anchor"></a><code><span class="keyword">class</span> <a href="class-cfb_decrypt/index.html">cfb_decrypt</a> : ?&#8288;iv:string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Cipher Feedback Block (CFB) to the given block cipher in encryption mode. The integer argument <code>n</code> is the number of bytes processed at a time; it must lie between <code>1</code> and the block size of the underlying cipher, included. The returned block cipher has block size <code>n</code>.</p></dd></dl><dl><dt class="spec class" id="class-ofb"><a href="#class-ofb" class="anchor"></a><code><span class="keyword">class</span> <a href="class-ofb/index.html">ofb</a> : ?&#8288;iv:string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Cipher Feedback Block (CFB) to the given block cipher in decryption mode. See <a href="class-cfb_encrypt/index.html"><code>Cryptokit.Block.cfb_encrypt</code></a>.</p></dd></dl><dl><dt class="spec class" id="class-ctr"><a href="#class-ctr" class="anchor"></a><code><span class="keyword">class</span> <a href="class-ctr/index.html">ctr</a> : ?&#8288;iv:string <span>&#45;&gt;</span> ?&#8288;inc:int <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a> <span>&#45;&gt;</span> <a href="class-type-block_cipher/index.html">block_cipher</a></code></dt><dd><p>Add Output Feedback Block (OFB) to the given block cipher. The integer argument <code>n</code> is the number of bytes processed at a time; it must lie between <code>1</code> and the block size of the underlying cipher, included. The returned block cipher has block size <code>n</code>. It is usable both for encryption and decryption.</p></dd></dl></section></div></body></html>