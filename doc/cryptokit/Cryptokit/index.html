<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Cryptokit (cryptokit.Cryptokit)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">cryptokit</a> &#x00BB; Cryptokit</nav><h1>Module <code>Cryptokit</code></h1><p>The Cryptokit library provides a variety of cryptographic primitives that can be used to implement cryptographic protocols in security-sensitive applications. The primitives provided include:</p><ul><li>Symmetric-key ciphers: AES, DES, Triple-DES, ARCfour, in ECB, CBC, CFB and OFB modes.</li><li>Public-key cryptography: RSA encryption, Diffie-Hellman key agreement.</li><li>Hash functions and MACs: SHA-1, SHA-256, SHA-512. SHA-3, RIPEMD-160, MD5, and MACs based on AES and DES.</li><li>Random number generation.</li><li>Encodings and compression: base 64, hexadecimal, Zlib compression.</li></ul><p>To use this library, link with <code>ocamlc unix.cma nums.cma cryptokit.cma</code> or <code>ocamlopt unix.cmxa nums.cmxa cryptokit.cmxa</code>.</p><nav class="toc"><ul><li><a href="#general-purpose-abstract-interfaces">General-purpose abstract interfaces</a></li><li><a href="#utilities:-random-numbers-and-padding-schemes">Utilities: random numbers and padding schemes</a></li><li><a href="#cryptographic-primitives-(simplified-interface)">Cryptographic primitives (simplified interface)</a></li><li><a href="#advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers">Advanced, compositional interface to block ciphers and stream ciphers</a></li><li><a href="#encoding-and-compression-of-data">Encoding and compression of data</a></li><li><a href="#error-reporting">Error reporting</a></li><li><a href="#miscellaneous-utilities">Miscellaneous utilities</a></li></ul></nav></header><section><header><h2 id="general-purpose-abstract-interfaces"><a href="#general-purpose-abstract-interfaces" class="anchor"></a>General-purpose abstract interfaces</h2></header><dl><dt class="spec class-type" id="class-type-transform"><a href="#class-type-transform" class="anchor"></a><code><span class="keyword">class type </span><a href="class-type-transform/index.html">transform</a> = <span class="keyword">object</span> ... <span class="keyword">end</span></code></dt><dd><p>A &lt;I&gt;transform&lt;/I&gt; is an arbitrary mapping from sequences of characters to sequences of characters. Examples of transforms include ciphering, deciphering, compression, decompression, and encoding of binary data as text. Input data to a transform is provided by successive calls to the methods <code>put_substring</code>, <code>put_string</code>, <code>put_char</code> or <code>put_byte</code>. The result of transforming the input data is buffered internally, and can be obtained via the <code>get_string</code>, <code>get_substring</code>, <code>get_char</code> and <code>get_byte</code> methods.</p></dd></dl><dl><dt class="spec value" id="val-transform_string"><a href="#val-transform_string" class="anchor"></a><code><span class="keyword">val </span>transform_string : <a href="class-type-transform/index.html">transform</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>transform_string t s</code> runs the string <code>s</code> through the transform <code>t</code> and returns the transformed string. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></dd></dl><dl><dt class="spec value" id="val-transform_channel"><a href="#val-transform_channel" class="anchor"></a><code><span class="keyword">val </span>transform_channel : <a href="class-type-transform/index.html">transform</a> <span>&#45;&gt;</span> ?&#8288;len:int <span>&#45;&gt;</span> Pervasives.in_channel <span>&#45;&gt;</span> Pervasives.out_channel <span>&#45;&gt;</span> unit</code></dt><dd><p><code>transform_channel t ic oc</code> reads characters from input channel <code>ic</code>, runs them through the transform <code>t</code>, and writes the transformed data to the output channel <code>oc</code>. If the optional <code>len</code> argument is provided, exactly <code>len</code> characters are read from <code>ic</code> and transformed; <code>End_of_file</code> is raised if <code>ic</code> does not contain at least <code>len</code> characters. If <code>len</code> is not provided, <code>ic</code> is read all the way to end of file. The transform <code>t</code> is wiped before returning, hence can no longer be used for further transformations.</p></dd></dl><dl><dt class="spec value" id="val-compose"><a href="#val-compose" class="anchor"></a><code><span class="keyword">val </span>compose : <a href="class-type-transform/index.html">transform</a> <span>&#45;&gt;</span> <a href="class-type-transform/index.html">transform</a> <span>&#45;&gt;</span> <a href="class-type-transform/index.html">transform</a></code></dt><dd><p>Compose two transforms, feeding the output of the first transform to the input of the second transform.</p></dd></dl><dl><dt class="spec class-type" id="class-type-hash"><a href="#class-type-hash" class="anchor"></a><code><span class="keyword">class type </span><a href="class-type-hash/index.html">hash</a> = <span class="keyword">object</span> ... <span class="keyword">end</span></code></dt><dd><p>A &lt;I&gt;hash&lt;/I&gt; is a function that maps arbitrarily-long character sequences to small, fixed-size strings.</p></dd></dl><dl><dt class="spec value" id="val-hash_string"><a href="#val-hash_string" class="anchor"></a><code><span class="keyword">val </span>hash_string : <a href="class-type-hash/index.html">hash</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>hash_string h s</code> runs the string <code>s</code> through the hash function <code>h</code> and returns the hash value of <code>s</code>. The hash <code>h</code> is wiped before returning, hence can no longer be used for further hash computations.</p></dd></dl><dl><dt class="spec value" id="val-hash_channel"><a href="#val-hash_channel" class="anchor"></a><code><span class="keyword">val </span>hash_channel : <a href="class-type-hash/index.html">hash</a> <span>&#45;&gt;</span> ?&#8288;len:int <span>&#45;&gt;</span> Pervasives.in_channel <span>&#45;&gt;</span> string</code></dt><dd><p><code>hash_string h s</code> runs the string <code>s</code> through the hash function <code>h</code> and returns the hash value of <code>s</code>. The hash <code>h</code> is wiped before returning, hence can no longer be used for further hash computations.</p><p><code>hash_channel h ic</code> reads characters from the input channel <code>ic</code>, computes their hash value and returns it. If the optional <code>len</code> argument is provided, exactly <code>len</code> characters are read from <code>ic</code> and hashed; <code>End_of_file</code> is raised if <code>ic</code> does not contain at least <code>len</code> characters. If <code>len</code> is not provided, <code>ic</code> is read all the way to end of file. The hash <code>h</code> is wiped before returning, hence can no longer be used for further hash computations.</p></dd></dl></section><section><header><h2 id="utilities:-random-numbers-and-padding-schemes"><a href="#utilities:-random-numbers-and-padding-schemes" class="anchor"></a>Utilities: random numbers and padding schemes</h2></header><dl><dt class="spec module" id="module-Random"><a href="#module-Random" class="anchor"></a><code><span class="keyword">module </span><a href="Random/index.html">Random</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Random</code> module provides random and pseudo-random number generators suitable for generating cryptographic keys, nonces, or challenges.</p></dd></dl><dl><dt class="spec module" id="module-Padding"><a href="#module-Padding" class="anchor"></a><code><span class="keyword">module </span><a href="Padding/index.html">Padding</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Padding</code> module defines a generic interface for padding input data to an integral number of blocks, as well as two popular padding schemes.</p></dd></dl></section><section><header><h2 id="cryptographic-primitives-(simplified-interface)"><a href="#cryptographic-primitives-(simplified-interface)" class="anchor"></a>Cryptographic primitives (simplified interface)</h2></header><dl><dt class="spec module" id="module-Cipher"><a href="#module-Cipher" class="anchor"></a><code><span class="keyword">module </span><a href="Cipher/index.html">Cipher</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Cipher</code> module implements the AES, DES, Triple-DES, ARCfour and Blowfish symmetric ciphers. Symmetric ciphers are presented as transforms parameterized by a secret key and a ``direction'' indicating whether encryption or decryption is to be performed. The same secret key is used for encryption and for decryption.</p></dd></dl><dl><dt class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><code><span class="keyword">module </span><a href="Hash/index.html">Hash</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Hash</code> module implements unkeyed cryptographic hashes (SHA-1, SHA-256, SHA-512, SHA-3, RIPEMD-160 and MD5), also known as message digest functions. Hash functions used in cryptography are characterized as being &lt;I&gt;one-way&lt;/I&gt; (given a hash value, it is computationally infeasible to find a text that hashes to this value) and &lt;I&gt;collision-resistant&lt;/I&gt; (it is computationally infeasible to find two different texts that hash to the same value). Thus, the hash of a text can be used as a compact replacement for this text for the purposes of ensuring integrity of the text.</p></dd></dl><dl><dt class="spec module" id="module-MAC"><a href="#module-MAC" class="anchor"></a><code><span class="keyword">module </span><a href="MAC/index.html">MAC</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>MAC</code> module implements message authentication codes, also known as keyed hash functions. These are hash functions parameterized by a secret key. In addition to being one-way and collision-resistant, a MAC has the property that without knowing the secret key, it is computationally infeasible to find the hash for a known text, even if many pairs of (text, MAC) are known to the attacker. Thus, MAC can be used to authenticate the sender of a text: the receiver of a (text, MAC) pair can recompute the MAC from the text, and if it matches the transmitted MAC, be reasonably certain that the text was authentified by someone who possesses the secret key.</p></dd></dl><dl><dt class="spec module" id="module-RSA"><a href="#module-RSA" class="anchor"></a><code><span class="keyword">module </span><a href="RSA/index.html">RSA</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>RSA</code> module implements RSA public-key cryptography. Public-key cryptography is asymmetric: two distinct keys are used for encrypting a message, then decrypting it. Moreover, while one of the keys must remain secret, the other can be made public, since it is computationally very hard to reconstruct the private key from the public key. This feature supports both public-key encryption (anyone can encode with the public key, but only the owner of the private key can decrypt) and digital signature (only the owner of the private key can sign, but anyone can check the signature with the public key).</p></dd></dl><dl><dt class="spec module" id="module-DH"><a href="#module-DH" class="anchor"></a><code><span class="keyword">module </span><a href="DH/index.html">DH</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>DH</code> module implements Diffie-Hellman key agreement. Key agreement is a protocol by which two parties can establish a shared secret (typically a key for a symmetric cipher or MAC) by exchanging messages, with the guarantee that even if an attacker eavesdrop on the messages, he cannot recover the shared secret. Diffie-Hellman is one such key agreement protocol, relying on the difficulty of computing discrete logarithms. Notice that the Diffie-Hellman protocol is vulnerable to active attacks (man-in-the-middle attacks).</p></dd></dl></section><section><header><h2 id="advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers"><a href="#advanced,-compositional-interface-to-block-ciphers-and-stream-ciphers" class="anchor"></a>Advanced, compositional interface to block ciphers and stream ciphers</h2></header><dl><dt class="spec module" id="module-Block"><a href="#module-Block" class="anchor"></a><code><span class="keyword">module </span><a href="Block/index.html">Block</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Block</code> module provides classes that implements popular block ciphers, chaining modes, and wrapping of a block cipher as a general transform or as a hash function. The classes can be composed in a Lego-like fashion, facilitating the integration of new block ciphers, modes, etc.</p></dd></dl><dl><dt class="spec module" id="module-Stream"><a href="#module-Stream" class="anchor"></a><code><span class="keyword">module </span><a href="Stream/index.html">Stream</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Stream</code> module provides classes that implement the ARCfour stream cipher, and the wrapping of a stream cipher as a general transform. The classes can be composed in a Lego-like fashion, facilitating the integration of new stream ciphers.</p></dd></dl></section><section><header><h2 id="encoding-and-compression-of-data"><a href="#encoding-and-compression-of-data" class="anchor"></a>Encoding and compression of data</h2></header><dl><dt class="spec module" id="module-Base64"><a href="#module-Base64" class="anchor"></a><code><span class="keyword">module </span><a href="Base64/index.html">Base64</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Base64</code> module supports the encoding and decoding of binary data in base 64 format, using only alphanumeric characters that can safely be transmitted over e-mail or in URLs.</p></dd></dl><dl><dt class="spec module" id="module-Hexa"><a href="#module-Hexa" class="anchor"></a><code><span class="keyword">module </span><a href="Hexa/index.html">Hexa</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Hexa</code> module supports the encoding and decoding of binary data as hexadecimal strings. This is a popular format for transmitting keys in textual form.</p></dd></dl><dl><dt class="spec module" id="module-Zlib"><a href="#module-Zlib" class="anchor"></a><code><span class="keyword">module </span><a href="Zlib/index.html">Zlib</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The <code>Zlib</code> module supports the compression and decompression of data, using the <code>zlib</code> library. The algorithm used is Lempel-Ziv compression as in the <code>gzip</code> and <code>zip</code> compressors. While compression itself is not encryption, it is often used prior to encryption to hide regularities in the plaintext, and reduce the size of the ciphertext.</p></dd></dl></section><section><header><h2 id="error-reporting"><a href="#error-reporting" class="anchor"></a>Error reporting</h2></header><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type </span>error</code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-error.Wrong_key_size" class="anchored"><td class="def constructor"><a href="#type-error.Wrong_key_size" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Wrong_key_size</span></code></td><td class="doc"><p>The key is too long or too short for the given cipher.</p></td></tr><tr id="type-error.Wrong_IV_size" class="anchored"><td class="def constructor"><a href="#type-error.Wrong_IV_size" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Wrong_IV_size</span></code></td><td class="doc"><p>The initialization vector does not have the same size as the block size.</p></td></tr><tr id="type-error.Wrong_data_length" class="anchored"><td class="def constructor"><a href="#type-error.Wrong_data_length" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Wrong_data_length</span></code></td><td class="doc"><p>The total length of the input data for a transform is not an integral multiple of the input block size.</p></td></tr><tr id="type-error.Bad_padding" class="anchored"><td class="def constructor"><a href="#type-error.Bad_padding" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Bad_padding</span></code></td><td class="doc"><p>Incorrect padding bytes were found after decryption.</p></td></tr><tr id="type-error.Output_buffer_overflow" class="anchored"><td class="def constructor"><a href="#type-error.Output_buffer_overflow" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Output_buffer_overflow</span></code></td><td class="doc"><p>The output buffer for a transform exceeds the maximal length of a Caml string.</p></td></tr><tr id="type-error.Incompatible_block_size" class="anchored"><td class="def constructor"><a href="#type-error.Incompatible_block_size" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Incompatible_block_size</span></code></td><td class="doc"><p>A combination of two block ciphers was attempted whereby the ciphers have different block sizes, while they must have the same.</p></td></tr><tr id="type-error.Number_too_long" class="anchored"><td class="def constructor"><a href="#type-error.Number_too_long" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Number_too_long</span></code></td><td class="doc"><p>Denotes an internal error in RSA key generation or encryption.</p></td></tr><tr id="type-error.Seed_too_short" class="anchored"><td class="def constructor"><a href="#type-error.Seed_too_short" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Seed_too_short</span></code></td><td class="doc"><p>The seed given to a pseudo random number generator is too short.</p></td></tr><tr id="type-error.Message_too_long" class="anchored"><td class="def constructor"><a href="#type-error.Message_too_long" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Message_too_long</span></code></td><td class="doc"><p>The message passed to RSA encryption or decryption is greater than the modulus of the RSA key</p></td></tr><tr id="type-error.Bad_encoding" class="anchored"><td class="def constructor"><a href="#type-error.Bad_encoding" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Bad_encoding</span></code></td><td class="doc"><p>Illegal characters were found in an encoding of binary data such as base 64 or hexadecimal.</p></td></tr><tr id="type-error.Compression_error" class="anchored"><td class="def constructor"><a href="#type-error.Compression_error" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Compression_error</span><span class="keyword"> of </span>string<span class="keyword"> * </span>string</code></td><td class="doc"><p>Error during compression or decompression.</p></td></tr><tr id="type-error.No_entropy_source" class="anchored"><td class="def constructor"><a href="#type-error.No_entropy_source" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">No_entropy_source</span></code></td><td class="doc"><p>No entropy source (OS, <code>/dev/random</code> or EGD) was found for <a href="Random/index.html#val-secure_rng"><code>Cryptokit.Random.secure_rng</code></a>.</p></td></tr><tr id="type-error.Entropy_source_closed" class="anchored"><td class="def constructor"><a href="#type-error.Entropy_source_closed" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Entropy_source_closed</span></code></td><td class="doc"><p>End of file on a device or EGD entropy source.</p></td></tr><tr id="type-error.Compression_not_supported" class="anchored"><td class="def constructor"><a href="#type-error.Compression_not_supported" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Compression_not_supported</span></code></td><td class="doc"><p>The data compression functions are not available.</p></td></tr></table></dt><dd><p>Error codes for this library.</p></dd></dl><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception </span></code><code><span class="exception">Error</span><span class="keyword"> of </span><a href="index.html#type-error">error</a></code></dt><dd><p>Exception raised by functions in this library to report error conditions.</p></dd></dl></section><section><header><h2 id="miscellaneous-utilities"><a href="#miscellaneous-utilities" class="anchor"></a>Miscellaneous utilities</h2></header><dl><dt class="spec value" id="val-wipe_bytes"><a href="#val-wipe_bytes" class="anchor"></a><code><span class="keyword">val </span>wipe_bytes : bytes <span>&#45;&gt;</span> unit</code></dt><dd><p><code>wipe_bytes s</code> overwrites <code>s</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data.</p></dd></dl><dl><dt class="spec value" id="val-wipe_string"><a href="#val-wipe_string" class="anchor"></a><code><span class="keyword">val </span>wipe_string : string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>wipe_bytes s</code> overwrites <code>s</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data.</p><p><code>wipe_string s</code> overwrites <code>s</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data.</p></dd></dl><dl><dt class="spec value" id="val-xor_bytes"><a href="#val-xor_bytes" class="anchor"></a><code><span class="keyword">val </span>xor_bytes : bytes <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>wipe_string s</code> overwrites <code>s</code> with zeroes. Can be used to reduce the memory lifetime of sensitive data.</p><p><code>xor_string src spos dst dpos len</code> performs the xor (exclusive or) of characters <code>spos, ..., spos + len - 1</code> of <code>src</code> with characters <code>dpos, ..., dpos + len - 1</code> of <code>dst</code>, storing the result in <code>dst</code> starting at position <code>dpos</code>.</p></dd></dl><dl><dt class="spec value" id="val-xor_string"><a href="#val-xor_string" class="anchor"></a><code><span class="keyword">val </span>xor_string : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bytes <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>xor_string src spos dst dpos len</code> performs the xor (exclusive or) of characters <code>spos, ..., spos + len - 1</code> of <code>src</code> with characters <code>dpos, ..., dpos + len - 1</code> of <code>dst</code>, storing the result in <code>dst</code> starting at position <code>dpos</code>.</p><p>Same as <code>xor_bytes</code>, but the source is a string instead of a byte array.</p></dd></dl><dl><dt class="spec value" id="val-mod_power"><a href="#val-mod_power" class="anchor"></a><code><span class="keyword">val </span>mod_power : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p>Same as <code>xor_bytes</code>, but the source is a string instead of a byte array.</p><p><code>mod_power a b c</code> computes <code>a^b mod c</code>, where the strings <code>a</code>, <code>b</code>, <code>c</code> and the result are viewed as arbitrary-precision integers in big-endian format. Requires <code>a &lt; c</code>.</p></dd></dl><dl><dt class="spec value" id="val-mod_mult"><a href="#val-mod_mult" class="anchor"></a><code><span class="keyword">val </span>mod_mult : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>mod_power a b c</code> computes <code>a^b mod c</code>, where the strings <code>a</code>, <code>b</code>, <code>c</code> and the result are viewed as arbitrary-precision integers in big-endian format. Requires <code>a &lt; c</code>.</p><p><code>mod_mult a b c</code> computes <code>a*b mod c</code>, where the strings <code>a</code>, <code>b</code>, <code>c</code> and the result are viewed as arbitrary-precision integers in big-endian format.</p></dd></dl></section></div></body></html>