<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>D3 (d3.D3)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">d3</a> &#x00BB; D3</nav><h1>Module <code>D3</code></h1><p>js_of_ocaml bindings for the D3.js library.</p><nav class="toc"><ul><li><a href="#data-binding">Data Binding</a></li><li><a href="#selection-manipulation">Selection manipulation</a></li><li><a href="#composition-operators">Composition operators</a></li><li><a href="#casting">Casting</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> ('a, 'b) t</code></dt><dd><p>The type of a D3 operation that assumes that its parent has data of type <code>'a</code> bound to it, and which itself can act as a context with data of type <code>'b</code> bound to it.</p></dd></dl><dl><dt class="spec type" id="type-fn"><a href="#type-fn" class="anchor"></a><code><span class="keyword">type</span> ('a, 'b) fn</code><code> = <a href="../../js_of_ocaml/Dom/class-type-node/index.html">Dom.node</a> <a href="../../js_of_ocaml/Js/index.html#type-t">Js.t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>A type alias for the sorts of functions that can be used to construct <a href="index.html#val-attr"><code>attr</code></a>, <a href="index.html#val-classed"><code>classed</code></a>, <a href="index.html#val-style"><code>style</code></a>, and <a href="index.html#val-property"><code>property</code></a>, selections below.</p></dd></dl><dl><dt class="spec value" id="val-select"><a href="#val-select" class="anchor"></a><code><span class="keyword">val</span> select : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>select selector</code> selects the first descendant element that matches the specified selector string, for each element in the selection. If the current element has associated data, this data is inherited by the returned subselection, and automatically bound to the newly selected elements. If multiple elements match the selector, only the first matching element in document traversal order will be selected.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#select">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-selectAll"><a href="#val-selectAll" class="anchor"></a><code><span class="keyword">val</span> selectAll : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>selectAll selector</code> selects descendant elements that match the specified selector string, for each element in the selection. The subselection does not inherit data from the current selection; however, if the data value is specified as a function, this function will be called with the data d of the ancestor node and the group index i to determine the data bindings for the subselection.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#selectAll">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-attr"><a href="#val-attr" class="anchor"></a><code><span class="keyword">val</span> attr : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>attr name f</code> sets the <code>name</code> attribute to the specified value on all selected elements. The value is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#attr">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-classed"><a href="#val-classed" class="anchor"></a><code><span class="keyword">val</span> classed : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, bool) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>classed class f</code> sets whether or not <code>class</code> is associated with the selected elements. This is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p>This operator is a convenience routine for setting the <code>&quot;class&quot;</code> attribute; it understands that the <code>&quot;class&quot;</code> attribute is a set of tokens separated by spaces. If you want to set several classes at once use a space-separated list of class names as the first argument.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#classes">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-style"><a href="#val-style" class="anchor"></a><code><span class="keyword">val</span> style : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>style name f</code> sets the <code>name</code> CSS style property to the specified value on all selected elements. The value is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#style">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-property"><a href="#val-property" class="anchor"></a><code><span class="keyword">val</span> property : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span> <a href="../../js_of_ocaml/Js/index.html#type-t">Js.t</a>) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>property name f</code> sets the <code>name</code> property to the specified value on all selected elements. The value is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#property">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-text"><a href="#val-text" class="anchor"></a><code><span class="keyword">val</span> text : (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>text f</code> sets the text content to the specified value on all selected elements. The value is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p>The <code>text</code> operator is based on the <a href="http://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-textContent">textContent</a> property; setting the text content will replace any existing child elements.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#text">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-html"><a href="#val-html" class="anchor"></a><code><span class="keyword">val</span> html : (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>html f</code> sets the inner HTML content to the specified value on all selected elements. The value is determined by calling <code>f</code> for each element, passing it the current DOM element, the datum attached to the DOM element, and the element's index in the selection.</p><p>The <code>html</code> operator is based on the <a href="http://dev.w3.org/html5/spec-LC/apis-in-html-documents.html#innerhtml">innerHTML</a> property; setting the inner HTML content will replace any existing child elements. Also, you may prefer to use the <a href="index.html#val-append"><code>append</code></a> operator to create HTML content in a data-driven way; this operator is intended for when you want a little bit of HTML, say for rich formatting.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#html">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-append"><a href="#val-append" class="anchor"></a><code><span class="keyword">val</span> append : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>append name</code> appends a new <code>name</code> element as the last child of each element in the current selection, returning a new selection containing the appended elements. Each new element inherits the data of the current elements in the same manner as <a href="index.html#val-select"><code>select</code></a>.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#append">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-insert"><a href="#val-insert" class="anchor"></a><code><span class="keyword">val</span> insert : before:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>insert ~before name</code> inserts a new <code>name</code> element before the element matching the <code>before</code> selector, returning a new selection containing the inserted elements. If <code>before</code> does not match any elements, then the new element will be the last child as with <a href="index.html#val-append"><code>append</code></a>. Each new element inherits the data of the current elements (if any), in the same manner as <a href="index.html#val-select"><code>select</code></a>.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#insert">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val</span> remove : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>remove</code> removes the elements in the current selection from the current document. Returns the current selection (the same elements that were removed) which are now &quot;off-screen&quot;, detached from the DOM.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#remove">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-static"><a href="#val-static" class="anchor"></a><code><span class="keyword">val</span> static : string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>static name</code> appends a new <code>name</code> element as the last child of each element in the current selection, if <code>name</code> child element does not already exist. If an <code>name</code> element already does exist, then it will return a selection containing just that element.</p><p>Note that you can use multiple <code>static</code> operators to create elements with the same name.</p><pre><code class="ml">nest (select &quot;body&quot;)
  [ static &quot;div&quot;
    |. text (fun _ _ _ -&gt; &quot;first div&quot;)
  ; static &quot;div&quot;
    |. text (fun _ _ _ -&gt; &quot;second div&quot;) ] </code></pre><p>This is not part of the D3.js API.</p></dd></dl><section><header><h3 id="data-binding"><a href="#data-binding" class="anchor"></a>Data Binding</h3></header><dl><dt class="spec value" id="val-data"><a href="#val-data" class="anchor"></a><code><span class="keyword">val</span> data : (<span class="type-var">'a</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span class="type-var">'b</span> list) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><a href="https://github.com/mbostock/d3/wiki/Selections#data">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-datum"><a href="#val-datum" class="anchor"></a><code><span class="keyword">val</span> datum : (<span class="type-var">'a</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><a href="https://github.com/mbostock/d3/wiki/Selections#datum">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-enter"><a href="#val-enter" class="anchor"></a><code><span class="keyword">val</span> enter : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>enter</code> returns the enter selection: placeholder nodes for each data element for which no corresponding existing DOM element was found in the current selection. This operation can only be composed below an update selection, which is produced by the <a href="index.html#val-data"><code>data</code></a> operator.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#enter">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val</span> update : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>update</code> is a NOOP operation. It leaves the parent selection unchanged and has no side-effects.</p><p>This is not part of the D3.js API.</p></dd></dl><dl><dt class="spec value" id="val-exit"><a href="#val-exit" class="anchor"></a><code><span class="keyword">val</span> exit : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>exit</code> returns the exit selection: existing DOM elements in the current selection for which no new data element was found. This operation can only be composed below an update selection, which is produced by the <a href="index.html#val-data"><code>data</code></a> operator.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#exit">D3.js docs</a></p></dd></dl></section><section><header><h3 id="selection-manipulation"><a href="#selection-manipulation" class="anchor"></a>Selection manipulation</h3></header><dl><dt class="spec value" id="val-filter"><a href="#val-filter" class="anchor"></a><code><span class="keyword">val</span> filter : (<span class="type-var">'a</span>, bool) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>filter f</code> returns a new selection that contains only the elements for which <code>f</code> evaluates to <code>true</code>.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#filter">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-sort"><a href="#val-sort" class="anchor"></a><code><span class="keyword">val</span> sort : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int) <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>sort f</code> sorts the elements in the current selection according to the comparator function, and then re-inserts the document elements to match.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#sort">D3.js docs</a></p></dd></dl><dl><dt class="spec value" id="val-each"><a href="#val-each" class="anchor"></a><code><span class="keyword">val</span> each : (<span class="type-var">'a</span>, unit) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>each f</code> invokes <code>f</code> for each element in the current selection.</p><p><a href="https://github.com/mbostock/d3/wiki/Selections#each">D3.js docs</a></p></dd></dl></section><section><header><h3 id="composition-operators"><a href="#composition-operators" class="anchor"></a>Composition operators</h3></header><dl><dt class="spec value" id="val-(|.)"><a href="#val-(|.)" class="anchor"></a><code><span class="keyword">val</span> (|.) : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'c</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-(&lt;.&gt;)"><a href="#val-(&lt;.&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;.&gt;) : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'c</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>x |. y</code> is the equivalent of method chaining operators <code>x</code> and <code>y</code> in JavaScript. <code>&lt;.&gt;</code> is an alias for <code>|.</code>.</p></dd></dl><dl><dt class="spec value" id="val-(|-)"><a href="#val-(|-)" class="anchor"></a><code><span class="keyword">val</span> (|-) : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'c</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-chain"><a href="#val-chain" class="anchor"></a><code><span class="keyword">val</span> chain : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a> list <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-seq"><a href="#val-seq" class="anchor"></a><code><span class="keyword">val</span> seq : (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a> list <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-nest"><a href="#val-nest" class="anchor"></a><code><span class="keyword">val</span> nest : (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (<span class="type-var">'b</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a> list <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'b</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>nest x ys</code> is equivalent to <code>x |- seq ys</code>.</p></dd></dl></section><section><header><h3 id="casting"><a href="#casting" class="anchor"></a>Casting</h3></header><dl><dt class="spec value" id="val-str"><a href="#val-str" class="anchor"></a><code><span class="keyword">val</span> str : (string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-int"><a href="#val-int" class="anchor"></a><code><span class="keyword">val</span> int : (string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-flt"><a href="#val-flt" class="anchor"></a><code><span class="keyword">val</span> flt : (string <span>&#45;&gt;</span> (<span class="type-var">'a</span>, string) <a href="index.html#type-fn">fn</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> float <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">'a</span>) <a href="index.html#type-t">t</a></code></dt><dd><p><code>str attr x y</code> will set the <code>x</code> attribute to the constant string value <code>y</code>. The <code>int</code> and <code>flt</code> functions do the same thing except with constant values of different types. These convenience functions should be used with the <a href="index.html#val-attr"><code>attr</code></a>, and <a href="index.html#val-style"><code>style</code></a> functions when dealing with constant values. That way you can write code like this:</p><pre><code class="ml">selectAll &quot;rect&quot;
|. int attr  &quot;height&quot; height
|. int attr  &quot;width&quot;  height
|. str style &quot;fill&quot;   &quot;blue&quot;</code></pre><p>rather than this:</p><pre><code class="ml">selectAll &quot;rect&quot;
|. attr  &quot;height&quot; (fun _ _ _ -&gt; string_of_int height)
|. attr  &quot;width&quot;  (fun _ _ _ -&gt; string_of_int width)
|. style &quot;fill&quot;   (fun _ _ _ -&gt; &quot;blue&quot;)</code></pre></dd></dl><dl><dt class="spec module" id="module-E"><a href="#module-E" class="anchor"></a><code><span class="keyword">module</span> <a href="E/index.html">E</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Event handlers</p></dd></dl><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : ?&#8288;node:<a href="../../js_of_ocaml/Dom/index.html">Dom</a>.#node <a href="../../js_of_ocaml/Js/index.html#type-t">Js.t</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span>, <span class="type-var">_</span>) <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>run ?node op datum</code> binds <code>datum</code> to <code>node</code> and runs <code>op</code> on that element. If <code>node</code> is not provided, then the current document node will be used instead.</p><p>This is the only way to run a D3.t operation. It can be used in a variety of contexts, however its indended use is in an event loop of an application, along these lines:</p><pre><code class="ml">let main () =
  let model = ref Model.init in
  D3.run &quot;body&quot; !model view;
  Stream.iter events (fun e -&gt;
    model := handle e model;
    D3.run &quot;body&quot; !model view)
;;

main ()</code></pre></dd></dl></section></div></body></html>