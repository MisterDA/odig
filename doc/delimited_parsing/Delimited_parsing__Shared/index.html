<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Delimited_parsing__Shared (delimited_parsing.Delimited_parsing__Shared)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">delimited_parsing</a> &#x00BB; Delimited_parsing__Shared</nav><h1>Module <code>Delimited_parsing__Shared</code></h1><p>Kitchen-sink module for functions shared by multiple parsers.</p></header><dl><dt class="spec type" id="type-reader"><a href="#type-reader" class="anchor"></a><code><span class="keyword">type</span> ('a, 'b) reader</code><code> = ?&#8288;strip:bool <span>&#45;&gt;</span> ?&#8288;skip_lines:int <span>&#45;&gt;</span> ?&#8288;on_parse_error:[ `Raise | `Handle of string <a href="../../core_kernel/Core_kernel/Queue/index.html#type-t">Core.Queue.t</a> <span>&#45;&gt;</span> exn <span>&#45;&gt;</span> [ `Continue | `Finish ] ] <span>&#45;&gt;</span> header:<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>If strip is true (default is false) then spaces will be stripped from the beginning and end of fields.</p><p>If <code>skip_lines</code> is given then that number of lines will be read and discarded from the top of the file or Reader.t given.</p><p>If <code>on_parse_error</code> is `Raise any lines that fail to parse will raise an exception. If `Handle is given the offending line will be passed to the function given, which may then indicate that processing should continue or finish.</p></dd></dl><dl><dt class="spec value" id="val-buffer_size"><a href="#val-buffer_size" class="anchor"></a><code><span class="keyword">val</span> buffer_size : int</code></dt><dd><p>Recommendation based on the largest reads and writes observed off a disk or socket.</p></dd></dl><dl><dt class="spec value" id="val-drop_lines"><a href="#val-drop_lines" class="anchor"></a><code><span class="keyword">val</span> drop_lines : <a href="../../async_unix/Async_unix/Reader/index.html#type-t">Async.Reader.t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit <a href="../../async_kernel/Async_kernel/Deferred/index.html#type-t">Async.Deferred.t</a></code></dt><dd><p><code>drop_lines r n</code> reads and discards up to and including the <code>n</code>th newline from <code>r</code>.</p></dd></dl><dl><dt class="spec value" id="val-make_emit_field"><a href="#val-make_emit_field" class="anchor"></a><code><span class="keyword">val</span> make_emit_field : strip:bool <span>&#45;&gt;</span> string <a href="../../core_kernel/Core_kernel/Queue/index.html#type-t">Core.Queue.t</a> <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Buffer/index.html#type-t">Stdlib.Buffer.t</a> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> unit) <a href="../../base/Base/Staged/index.html#type-t">Core.Staged.t</a></code></dt><dd><p><code>make_emit_field ~strip row buffer</code> returns a closure which enqueues <code>buffer</code> into <code>row</code>, stripping leading and trailing whitespace if <code>strip = true</code>.</p></dd></dl><dl><dt class="spec value" id="val-make_emit_row"><a href="#val-make_emit_row" class="anchor"></a><code><span class="keyword">val</span> make_emit_row : string <a href="../../core_kernel/Core_kernel/Queue/index.html#type-t">Core.Queue.t</a> <span>&#45;&gt;</span> <a href="../Delimited_parsing/Row/index.html#type-t">Delimited_parsing.Row.t</a> <a href="../../core_kernel/Core_kernel/Queue/index.html#type-t">Core.Queue.t</a> <span>&#45;&gt;</span> <a href="../Delimited_parsing/Header/index.html#type-t">Delimited_parsing.Header.t</a> <span>&#45;&gt;</span> lineno:int <a href="../../core/Core/index.html#type-ref">Core.ref</a> <span>&#45;&gt;</span> [ `on_eof of unit <span>&#45;&gt;</span> unit ] * (unit <span>&#45;&gt;</span> unit)</code></dt><dd><p><code>make_emit_row row rows header ~lineno</code> returns <code>(`on_eof on_eof, emit_row)</code>. After zero or more calls to <code>emit_row</code> and a call to <code>on_eof</code>, <code>rows</code> will contain the parsed file.</p><p>Note that <code>rows</code> may have fewer elements than the number of calls to <code>emit_row</code>, if <code>header</code> specifies that the first <code>row</code> is a header line.</p></dd></dl></div></body></html>