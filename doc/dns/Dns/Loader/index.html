<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Loader (dns.Dns.Loader)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dns</a> &#x00BB; <a href="../index.html">Dns</a> &#x00BB; Loader</nav><h1>Module <code>Dns.Loader</code></h1></header><aside><p>How to build up a DNS trie from separate RRs.</p><dl><dt>author</dt><dd>Tim Deegan &lt;tjd\@phlegethon.org&gt;</dd></dl><dl><dt>author</dt><dd>Richard Mortier &lt;mort\@cantab.net&gt;</dd></dl></aside><dl><dt class="spec type" id="type-db"><a href="#type-db" class="anchor"></a><code><span class="keyword">type</span> db</code><code> = </code><code>{</code><table class="record"><tr id="type-db.trie" class="anchored"><td class="def field"><a href="#type-db.trie" class="anchor"></a><code>trie : <a href="../Trie/index.html#type-dnstrie">Trie.dnstrie</a>;</code></td></tr><tr id="type-db.names" class="anchored"><td class="def field"><a href="#type-db.names" class="anchor"></a><code><span class="keyword">mutable</span> names : (<a href="../Name/index.html#type-key">Name.key</a>, <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a>) <a href="../../../ocaml/Stdlib/Hashtbl/index.html#type-t">Stdlib.Hashtbl.t</a>;</code></td></tr></table><code>}</code></dt><dd><p>Loader database: the DNS trie plus a hash table of other names in use.</p></dd></dl><dl><dt class="spec value" id="val-new_db"><a href="#val-new_db" class="anchor"></a><code><span class="keyword">val</span> new_db : unit <span>&#45;&gt;</span> <a href="index.html#type-db">db</a></code></dt><dd><p>Make a new, empty database.</p></dd></dl><dl><dt class="spec value" id="val-no_more_updates"><a href="#val-no_more_updates" class="anchor"></a><code><span class="keyword">val</span> no_more_updates : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Call when guaranteed there will be no more updates.</p></dd></dl><aside><p>Insert RRs in the database: args are rdata, ttl, owner, db.</p></aside><dl><dt class="spec value" id="val-add_generic_rr"><a href="#val-add_generic_rr" class="anchor"></a><code><span class="keyword">val</span> add_generic_rr : int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_a_rr"><a href="#val-add_a_rr" class="anchor"></a><code><span class="keyword">val</span> add_a_rr : <a href="../../../ipaddr/Ipaddr/V4/index.html#type-t">Ipaddr.V4.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_aaaa_rr"><a href="#val-add_aaaa_rr" class="anchor"></a><code><span class="keyword">val</span> add_aaaa_rr : <a href="../../../ipaddr/Ipaddr/V6/index.html#type-t">Ipaddr.V6.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_ns_rr"><a href="#val-add_ns_rr" class="anchor"></a><code><span class="keyword">val</span> add_ns_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_cname_rr"><a href="#val-add_cname_rr" class="anchor"></a><code><span class="keyword">val</span> add_cname_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_soa_rr"><a href="#val-add_soa_rr" class="anchor"></a><code><span class="keyword">val</span> add_soa_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="../RR/index.html#type-serial">RR.serial</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_mb_rr"><a href="#val-add_mb_rr" class="anchor"></a><code><span class="keyword">val</span> add_mb_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_mg_rr"><a href="#val-add_mg_rr" class="anchor"></a><code><span class="keyword">val</span> add_mg_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_mr_rr"><a href="#val-add_mr_rr" class="anchor"></a><code><span class="keyword">val</span> add_mr_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_wks_rr"><a href="#val-add_wks_rr" class="anchor"></a><code><span class="keyword">val</span> add_wks_rr : <a href="../../../ipaddr/Ipaddr/V4/index.html#type-t">Ipaddr.V4.t</a> <span>&#45;&gt;</span> <a href="../../../cstruct/Cstruct/index.html#type-byte">Cstruct.byte</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_ptr_rr"><a href="#val-add_ptr_rr" class="anchor"></a><code><span class="keyword">val</span> add_ptr_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_hinfo_rr"><a href="#val-add_hinfo_rr" class="anchor"></a><code><span class="keyword">val</span> add_hinfo_rr : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_minfo_rr"><a href="#val-add_minfo_rr" class="anchor"></a><code><span class="keyword">val</span> add_minfo_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_mx_rr"><a href="#val-add_mx_rr" class="anchor"></a><code><span class="keyword">val</span> add_mx_rr : int <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_txt_rr"><a href="#val-add_txt_rr" class="anchor"></a><code><span class="keyword">val</span> add_txt_rr : string list <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_rp_rr"><a href="#val-add_rp_rr" class="anchor"></a><code><span class="keyword">val</span> add_rp_rr : <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_afsdb_rr"><a href="#val-add_afsdb_rr" class="anchor"></a><code><span class="keyword">val</span> add_afsdb_rr : int <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_x25_rr"><a href="#val-add_x25_rr" class="anchor"></a><code><span class="keyword">val</span> add_x25_rr : string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_isdn_rr"><a href="#val-add_isdn_rr" class="anchor"></a><code><span class="keyword">val</span> add_isdn_rr : string <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_rt_rr"><a href="#val-add_rt_rr" class="anchor"></a><code><span class="keyword">val</span> add_rt_rr : int <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_srv_rr"><a href="#val-add_srv_rr" class="anchor"></a><code><span class="keyword">val</span> add_srv_rr : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_dnskey_rr"><a href="#val-add_dnskey_rr" class="anchor"></a><code><span class="keyword">val</span> add_dnskey_rr : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_ds_rr"><a href="#val-add_ds_rr" class="anchor"></a><code><span class="keyword">val</span> add_ds_rr : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-add_rrsig_rr"><a href="#val-add_rrsig_rr" class="anchor"></a><code><span class="keyword">val</span> add_rrsig_rr : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <a href="../Name/index.html#type-t">Name.t</a> <span>&#45;&gt;</span> <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec exception" id="exception-TTLMismatch"><a href="#exception-TTLMismatch" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">TTLMismatch</span></code></dt><dd><p>Raised if we already had an RRSet for this name and type, but with a different TTL. Also possible: <span class="xref-unresolved" title="unresolved reference to &quot;Trie.BadName&quot;"><a href="../index.html#module-Trie"><code>Trie</code></a>.BadName</span>.</p><p>N.B. If TTLMismatch is raised, the RR was successfully added, and the RRSet now has the new ttl.</p></dd></dl></div></body></html>