<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Trie (dns.Dns.Trie)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">dns</a> &#x00BB; <a href="../index.html">Dns</a> &#x00BB; Trie</nav><h1>Module <code>Dns.Trie</code></h1></header><aside><p>Interface to 256-way radix trie for DNS lookups. Non-standard behaviour:</p><ol><li>We don't support '\000' as a character in labels (because it has a special meaning in the internal radix trie keys).</li><li>We don't support RFC2673 bitstring labels. Could be done but they're not worth the bother: nobody uses them.</li></ol><dl><dt>author</dt><dd>Tim Deegan</dd></dl></aside><dl><dt class="spec exception" id="exception-TrieCorrupt"><a href="#exception-TrieCorrupt" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">TrieCorrupt</span></code></dt><dd><p>Missing data from a SOA/cut node.</p></dd></dl><dl><dt class="spec type" id="type-dnstrie"><a href="#type-dnstrie" class="anchor"></a><code><span class="keyword">type</span> dnstrie</code></dt><dd><p>Node of the trie</p></dd></dl><dl><dt class="spec value" id="val-new_trie"><a href="#val-new_trie" class="anchor"></a><code><span class="keyword">val</span> new_trie : unit <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a></code></dt><dd><p>Make a new, empty trie.</p></dd></dl><dl><dt class="spec value" id="val-simple_lookup"><a href="#val-simple_lookup" class="anchor"></a><code><span class="keyword">val</span> simple_lookup : <a href="../Name/index.html#type-key">Name.key</a> <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> option</code></dt><dd><p>Simple lookup function: just walk the trie.</p></dd></dl><dl><dt class="spec value" id="val-lookup"><a href="#val-lookup" class="anchor"></a><code><span class="keyword">val</span> lookup : <a href="../Name/index.html#type-key">Name.key</a> <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> mdns:bool <span>&#45;&gt;</span> [&gt; `Delegated of bool * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `Found of bool * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `NXDomain of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `NXDomainNSEC of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `NoError of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `NoErrorNSEC of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `Wildcard of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> | `WildcardNSEC of <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> * <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> ]</code></dt><dd><p>Look up a DNS entry in the trie, with full return.</p></dd></dl><dl><dt class="spec value" id="val-lookup_or_insert"><a href="#val-lookup_or_insert" class="anchor"></a><code><span class="keyword">val</span> lookup_or_insert : <a href="../Name/index.html#type-key">Name.key</a> <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> ?&#8288;parent:<a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a>) <span>&#45;&gt;</span> <a href="../RR/index.html#type-dnsnode">RR.dnsnode</a></code></dt><dd><p>Return the data mapped from this key, making new data if there is none there yet.</p></dd></dl><dl><dt class="spec value" id="val-fix_flags"><a href="#val-fix_flags" class="anchor"></a><code><span class="keyword">val</span> fix_flags : <a href="../Name/index.html#type-key">Name.key</a> <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Sort out flags for a key's node: call after adding or removing NS, SOA and KEY RRs</p></dd></dl><dl><dt class="spec value" id="val-iter"><a href="#val-iter" class="anchor"></a><code><span class="keyword">val</span> iter : (<a href="../RR/index.html#type-dnsnode">RR.dnsnode</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <a href="index.html#type-dnstrie">dnstrie</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Iterate over all of the nodes in the trie.</p></dd></dl></div></body></html>