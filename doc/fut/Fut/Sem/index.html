<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sem (fut.Fut.Sem)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">fut</a> &#x00BB; <a href="../index.html">Fut</a> &#x00BB; Sem</nav><h1>Module <code>Fut.Sem</code></h1><p>Semaphores for limiting resource usage.</p><p>TODO doc.</p></header><section><header><h2 id="semaphores"><a href="#semaphores" class="anchor"></a>Semaphores</h2></header><dl><dt class="spec type" id="type-future"><a href="#type-future" class="anchor"></a><code><span class="keyword">type </span>'a future</code><code><span class="keyword"> = </span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></code></dt><dt class="spec type" id="type-token"><a href="#type-token" class="anchor"></a><code><span class="keyword">type </span>token</code></dt><dd><p>The type for tokens.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>The type for semaphores.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : capacity:int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create capacity</code> is a semaphore with a token capacity of <code>capacity</code>.</p></dd></dl><dl><dt class="spec value" id="val-capacity"><a href="#val-capacity" class="anchor"></a><code><span class="keyword">val </span>capacity : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>capacity s</code> is <code>s</code>'s token capacity.</p></dd></dl><dl><dt class="spec value" id="val-available"><a href="#val-available" class="anchor"></a><code><span class="keyword">val </span>available : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>available s</code> is <code>s</code>'s number of available tokens.</p></dd></dl><dl><dt class="spec value" id="val-take"><a href="#val-take" class="anchor"></a><code><span class="keyword">val </span>take : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-token">token</a> <a href="index.html#type-future">future</a></code></dt><dd><p><code>take s</code> is a future that determines as follows:</p><ul><li>If at call time <code>available s &gt; 0</code>, decrements <code>available s</code> and determines a token immediately.</li><li>Otherwise determines when <code>available s</code> becomes <code>&gt; 0</code> and all previous futures resulting from <code>take s</code> have been set (i.e. you are served in FIFO order).</li></ul></dd></dl><dl><dt class="spec value" id="val-return"><a href="#val-return" class="anchor"></a><code><span class="keyword">val </span>return : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-token">token</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>return s token</code> returns the token <code>token</code> to <code>s</code>. As a side effect, determines the first non set <code>take s</code> future waiting (if any).</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>token</code> was already returned or if <code>token</code> doesn't belong to <code>s</code>.</p></dd></dl></dd></dl></section></div></body></html>