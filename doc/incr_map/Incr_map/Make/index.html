<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (incr_map.Incr_map.Make)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">incr_map</a> &#x00BB; <a href="../index.html">Incr_map</a> &#x00BB; Make</nav><h1>Module <code>Incr_map.Make</code></h1></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-Incr/index.html">Incr</a> : <a href="../../../incremental_kernel/Incremental_kernel/Incremental/index.html#module-type-S_without_times">Incremental_kernel.Incremental.S_without_times</a></code></li></ul><h3 class="heading">Signature</h3><dl><dt class="spec value" id="val-filter_mapi"><a href="#val-filter_mapi" class="anchor"></a><code><span class="keyword">val</span> filter_mapi : ?&#8288;data_equal:(<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v1</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v1</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v2</span> option) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v2</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dt class="spec value" id="val-mapi"><a href="#val-mapi" class="anchor"></a><code><span class="keyword">val</span> mapi : ?&#8288;data_equal:(<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v1</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v1</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v2</span>) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v2</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dt class="spec value" id="val-filter_mapi'"><a href="#val-filter_mapi'" class="anchor"></a><code><span class="keyword">val</span> filter_mapi' : ?&#8288;cutoff:<span class="type-var">'v1</span> <a href="argument-1-Incr/Cutoff/index.html#type-t">Incr.Cutoff.t</a> <span>&#45;&gt;</span> ?&#8288;data_equal:(<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v1</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v1</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v1</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> <span class="type-var">'v2</span> option <a href="argument-1-Incr/index.html#type-t">Incr.t</a>) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v2</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dt class="spec value" id="val-mapi'"><a href="#val-mapi'" class="anchor"></a><code><span class="keyword">val</span> mapi' : ?&#8288;cutoff:<span class="type-var">'v1</span> <a href="argument-1-Incr/Cutoff/index.html#type-t">Incr.Cutoff.t</a> <span>&#45;&gt;</span> ?&#8288;data_equal:(<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v1</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v1</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v1</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> <span class="type-var">'v2</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a>) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v2</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dt class="spec value" id="val-unordered_fold"><a href="#val-unordered_fold" class="anchor"></a><code><span class="keyword">val</span> unordered_fold : ?&#8288;data_equal:(<span class="type-var">'v</span> <span>&#45;&gt;</span> <span class="type-var">'v</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;update:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> old_data:<span class="type-var">'v</span> <span>&#45;&gt;</span> new_data:<span class="type-var">'v</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span>) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> init:<span class="type-var">'acc</span> <span>&#45;&gt;</span> add:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span>) <span>&#45;&gt;</span> remove:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> data:<span class="type-var">'v</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span> <span>&#45;&gt;</span> <span class="type-var">'acc</span>) <span>&#45;&gt;</span> <span class="type-var">'acc</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dd><p><code>unordered_fold i ~init ~add ~remove</code> constructs a more incremental version of:</p><pre><code class="ml">let%map m = i in
Map.fold m ~init ~f:add</code></pre><p>assuming that <code>remove</code> is the inverse of <code>add</code>, and that the operations for different keys can be performed in any order. Note that <code>data_equal</code> defaults to <code>phys_equal</code>, but a more precise equality can be provided instead.</p><p>When the data for a key updates, by default <code>remove</code> is called on the old data and then <code>add</code> is called on the new data. <code>update</code> provides an alternative single function to call each time a key's data updates, and can be used to improve efficiency.</p></dd></dl><dl><dt class="spec value" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span class="keyword">val</span> merge : ?&#8288;data_equal_left:(<span class="type-var">'v1</span> <span>&#45;&gt;</span> <span class="type-var">'v1</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;data_equal_right:(<span class="type-var">'v2</span> <span>&#45;&gt;</span> <span class="type-var">'v2</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v1</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v2</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> f:(key:<span class="type-var">'k</span> <span>&#45;&gt;</span> [ `Left of <span class="type-var">'v1</span> | `Right of <span class="type-var">'v2</span> | `Both of <span class="type-var">'v1</span> * <span class="type-var">'v2</span> ] <span>&#45;&gt;</span> <span class="type-var">'v3</span> option) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v3</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dd><p>Like <code>merge</code> in <code>Base.Map.merge</code>. Note that <code>f</code> is called at most once per key in any given stabilization.</p></dd></dl><dl><dt class="spec value" id="val-flatten"><a href="#val-flatten" class="anchor"></a><code><span class="keyword">val</span> flatten : (<span class="type-var">'k</span>, <span class="type-var">'v</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dd><p>This is the &quot;easy&quot; version of <code>map_join</code></p></dd></dl><dl><dt class="spec value" id="val-join"><a href="#val-join" class="anchor"></a><code><span class="keyword">val</span> join : (<span class="type-var">'k</span>, <span class="type-var">'v</span> <a href="argument-1-Incr/index.html#type-t">Incr.t</a>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dd><p>The non-incremental semantics of this function is the identity function. Its purpose is to collapse the extra level of incrementality at the level of the data of the map.</p></dd></dl><dl><dt class="spec value" id="val-subrange"><a href="#val-subrange" class="anchor"></a><code><span class="keyword">val</span> subrange : ?&#8288;data_equal:(<span class="type-var">'v</span> <span>&#45;&gt;</span> <span class="type-var">'v</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> (<span class="type-var">'k</span> * <span class="type-var">'k</span>) option <a href="argument-1-Incr/index.html#type-t">Incr.t</a> <span>&#45;&gt;</span> (<span class="type-var">'k</span>, <span class="type-var">'v</span>, <span class="type-var">'cmp</span>) <a href="../../../core_kernel/Core_kernel/Map/index.html#type-t">Core_kernel.Map.t</a> <a href="argument-1-Incr/index.html#type-t">Incr.t</a></code></dt><dd><p><code>subrange map (min, max)</code> constructs an incremental submap that includes all of the keys and data from <code>map</code> between <code>min</code> and <code>max</code>, inclusive, and none of the keys outside the range.</p><p><code>subrange map None</code> is the empty map. <code>range</code> being <code>None</code> means no elements are chosen.</p><p>Note that incremental changes have a runtime of O((k + m) log n) where k is the size of the changes to the underlying map and m is the size of the changes to the elements contained by the range. The complexity of the initial computation is the same as the incremental computation, with some simplification. k = 0 because we have not made any changes to the underlying map yet, and m equals the size of the range, because the initial range is empty.</p></dd></dl><dl><dt class="spec module" id="module-Lookup"><a href="#module-Lookup" class="anchor"></a><code><span class="keyword">module</span> <a href="Lookup/index.html">Lookup</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>('k, 'v) Lookup.t</code> provides a way to lookup keys in a map which uses symmetric diffs to trigger updates of the lookups.</p></dd></dl></div></body></html>