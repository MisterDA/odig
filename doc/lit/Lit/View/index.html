<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>View (lit.Lit.View)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">lit</a> &#x00BB; <a href="../index.html">Lit</a> &#x00BB; View</nav><h1>Module <code>Lit.View</code></h1><p>Views.</p><p>A view defines a view volume in 3D space mapped to clipped space.</p><p>A view defines the rendered view volume in 3D space and the viewport on which rendering occurs on the renderer's surface.</p><p>The view volume is specified by a view transform <a href="index.html#val-tr"><code>tr</code></a> that locates and orients the view volume and a projection transform <a href="index.html#val-proj"><code>proj</code></a> that defines the shape of the volume. Multiplied toghether these transform map world space to clip space.</p><p>The view's <a href="index.html#val-viewport"><code>viewport</code></a> defines, in normalized surface coordinates, a rectangular area of the surface. The normalized device coordinates are mapped on the viewport.</p></header><section><header><h2 id="view"><a href="#view" class="anchor"></a>View</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span><a href="../index.html#type-view">view</a></code></dt><dd><p>The type for views.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : ?&#8288;src:<a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> ?&#8288;tr:Gg.m4 <span>&#45;&gt;</span> ?&#8288;proj:Gg.m4 <span>&#45;&gt;</span> ?&#8288;viewport:Gg.box2 <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create src tr proj viewport ()</code> is a view such that:</p><ul><li><code>src</code>, if present default values are taken from this view rather than the values specified below.</li><li><code>tr</code>, defines the location and orientation of the view. It is the transform that maps world coordinates to view coordinates. Defaults to <span class="xref-unresolved" title="unresolved reference to &quot;M4.id&quot;"><code>M4</code>.id</span>, i.e. we are at the origin looking at down the z-axis. It defines the builtin uniform value <a href="../Uniform/index.html#val-world_to_view"><code>Uniform.world_to_view</code></a>.</li><li><code>proj</code>, defines the viewing volume. It is the transform that maps view coordinates to clip space. Defaults to <a href="index.html#val-persp"><code>persp</code></a><code>(`H Float.pi_div_4) 1.5 1. 100.</code>. It defines the builtin uniform value <a href="../Uniform/index.html#val-view_to_clip"><code>Uniform.view_to_clip</code></a>.</li><li><code>viewport</code> a rectangular area in normalized screen coordinates of the renderer's viewport; default is <span class="xref-unresolved" title="unresolved reference to &quot;Box2.unit&quot;"><code>Box2</code>.unit</span>. It defines the builtin uniform values <a href="../Uniform/index.html#val-viewport_o"><code>Uniform.viewport_o</code></a> and <a href="../Uniform/index.html#val-viewport_size"><code>Uniform.viewport_size</code></a>.</li></ul></dd></dl><dl><dt class="spec value" id="val-tr"><a href="#val-tr" class="anchor"></a><code><span class="keyword">val </span>tr : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.m4</code></dt><dt class="spec value" id="val-proj"><a href="#val-proj" class="anchor"></a><code><span class="keyword">val </span>proj : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.m4</code></dt><dt class="spec value" id="val-viewport"><a href="#val-viewport" class="anchor"></a><code><span class="keyword">val </span>viewport : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.box2</code></dt></dl></section><section><header><h2 id="coordinate-system-transforms"><a href="#coordinate-system-transforms" class="anchor"></a>Coordinate system transforms</h2><p>TODO explain in detail coordinate systems</p></header><dl><dt class="spec value" id="val-viewport_of_surface"><a href="#val-viewport_of_surface" class="anchor"></a><code><span class="keyword">val </span>viewport_of_surface : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>viewport_of_surface view pt</code> is the normalized viewport coordinates in <code>view</code> of the normalized surface coordinates <code>pt</code>.</p></dd></dl><dl><dt class="spec value" id="val-viewport_of_ndc"><a href="#val-viewport_of_ndc" class="anchor"></a><code><span class="keyword">val </span>viewport_of_ndc : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>viewport_of_ndc view pt</code> is the normalized viewport coordinates in <code>view</code> of the normalized device coordinates <code>pt</code> in <code>view</code>.</p></dd></dl><dl><dt class="spec value" id="val-surface_of_viewport"><a href="#val-surface_of_viewport" class="anchor"></a><code><span class="keyword">val </span>surface_of_viewport : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>surface_of_viewport view pt</code> is the normalized surface coordinates of the normalized viewport coordinates <code>pt</code> in <code>view</code>.</p></dd></dl><dl><dt class="spec value" id="val-surface_of_ndc"><a href="#val-surface_of_ndc" class="anchor"></a><code><span class="keyword">val </span>surface_of_ndc : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>surface_of_ndc view pt</code> is the normalized surface coordinates of the normalized device coordinates <code>pt</code> in <code>view</code>.</p></dd></dl><dl><dt class="spec value" id="val-ndc_of_viewport"><a href="#val-ndc_of_viewport" class="anchor"></a><code><span class="keyword">val </span>ndc_of_viewport : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>ndc_of_viewport view pt</code> is the normalized device coordinates in <code>view</code> of the normalized viewport coordinates <code>pt</code> in <code>view</code>.</p></dd></dl><dl><dt class="spec value" id="val-ndc_of_surface"><a href="#val-ndc_of_surface" class="anchor"></a><code><span class="keyword">val </span>ndc_of_surface : <a href="../index.html#type-view">view</a> <span>&#45;&gt;</span> Gg.p2 <span>&#45;&gt;</span> Gg.p2</code></dt><dd><p><code>ndc_of_surface view pt</code> is the normalized device coordinates of the normalized surface coordinates <code>pt</code> in <code>view</code>.</p></dd></dl></section><section><header><h2 id="projections-and-view-matrices"><a href="#projections-and-view-matrices" class="anchor"></a>Projections and view matrices</h2></header><dl><dt class="spec type" id="type-fov"><a href="#type-fov" class="anchor"></a><code><span class="keyword">type </span>fov</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-fov.H" class="anchored"><td class="def constructor"><a href="#type-fov.H" class="anchor"></a><code><span class="keyword">| </span></code><code>`H<span class="keyword"> of </span>float</code></td></tr><tr id="type-fov.V" class="anchored"><td class="def constructor"><a href="#type-fov.V" class="anchor"></a><code><span class="keyword">| </span></code><code>`V<span class="keyword"> of </span>float</code></td></tr></table><code> ]</code></dt><dd><p>The type for field of view angles along horizontal or vertical axes.</p></dd></dl><dl><dt class="spec value" id="val-persp"><a href="#val-persp" class="anchor"></a><code><span class="keyword">val </span>persp : fov:<a href="index.html#type-fov">fov</a> <span>&#45;&gt;</span> aspect:float <span>&#45;&gt;</span> near:float <span>&#45;&gt;</span> far:float <span>&#45;&gt;</span> Gg.m4</code></dt><dd><p><code>persp fov aspect near far</code> is a perspective projection matrix such that:</p><ul><li><code>fov</code> is the field of view angle in radians along a given axis.</li><li><code>aspect</code> is the ratio between the horizontal field of view and the vertical field of view.</li><li><code>near</code> and <code>far</code> are <em>positive</em> distances to the near and far clip planes.</li></ul><p>The transform is defined as follows according to <code>fov</code>.</p><ul><li>If <code>fov = `V fovy</code>, then let <code>h = 2 * near * (tan (fovy / 2))</code> and <code>w = aspect * h</code>.</li><li>If <code>fov = `H fovx</code>, then let <code>h = w / aspec</code> and <code>w = 2 * near * (tan (fovx / 2))</code></li></ul><p>The projection maps the symmetric frustum with top of the underlying pyramid at the origin, near clip rectangle corners <code>(-w/2,-h/2,-near)</code>, <code>(w/2,h/2,-near)</code> and far plane at <code>-far</code> to the axis aligned cube with corners <code>(-1, -1, -1)</code> and <code>(1,1,1)</code>.</p></dd></dl><dl><dt class="spec value" id="val-look"><a href="#val-look" class="anchor"></a><code><span class="keyword">val </span>look : ?&#8288;up:Gg.v3 <span>&#45;&gt;</span> at:Gg.p3 <span>&#45;&gt;</span> from:Gg.p3 <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> Gg.m4</code></dt><dd><p><code>look up at ~from:pos ()</code> in layman terms this is the transform which has the effect of putting you at position <code>pos</code> looking at the point <code>at</code> and with your head tilted to match the <code>up</code> direction.</p><p>More precisely, the transform maps:</p><ul><li><code>pos</code> on the origin <span class="xref-unresolved" title="unresolved reference to &quot;P3.o&quot;"><code>P3</code>.o</span></li><li><code>oz' = V3.(unit (from - at))</code> to <span class="xref-unresolved" title="unresolved reference to &quot;V3.oz&quot;"><code>V3</code>.oz</span></li><li><code>ox' = V3.(unit (cross up oz'))</code> to <span class="xref-unresolved" title="unresolved reference to &quot;V3.ox&quot;"><code>V3</code>.ox</span></li><li><code>oy' = V3.(unit (cross oz ox'))</code> to <span class="xref-unresolved" title="unresolved reference to &quot;V3.oy&quot;"><code>V3</code>.oy</span></li></ul><p>The final up vector <code>oy'</code> matches exactly up only if <code>up</code> is orthogonal the the forward direction <code>at - from</code>.</p></dd></dl></section></div></body></html>