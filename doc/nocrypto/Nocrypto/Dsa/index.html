<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Dsa (nocrypto.Nocrypto.Dsa)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">nocrypto</a> &#x00BB; <a href="../index.html">Nocrypto</a> &#x00BB; Dsa</nav><h1>Module <code>Nocrypto.Dsa</code></h1><p><b>DSA</b> digital signature algorithm.</p><nav class="toc"><ul><li><a href="#dsa-signature-algorithm">DSA signature algorithm</a></li></ul></nav></header><section><header><h2 id="dsa-signature-algorithm"><a href="#dsa-signature-algorithm" class="anchor"></a>DSA signature algorithm</h2></header><dl><dt class="spec type" id="type-priv"><a href="#type-priv" class="anchor"></a><code><span class="keyword">type </span>priv</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-priv.p" class="anchored"><td class="def field"><a href="#type-priv.p" class="anchor"></a><code>p : Z.t;</code></td><td class="doc"><p>Modulus</p></td></tr><tr id="type-priv.q" class="anchored"><td class="def field"><a href="#type-priv.q" class="anchor"></a><code>q : Z.t;</code></td><td class="doc"><p>Subgroup order</p></td></tr><tr id="type-priv.gg" class="anchored"><td class="def field"><a href="#type-priv.gg" class="anchor"></a><code>gg : Z.t;</code></td><td class="doc"><p>Group Generator</p></td></tr><tr id="type-priv.x" class="anchored"><td class="def field"><a href="#type-priv.x" class="anchor"></a><code>x : Z.t;</code></td><td class="doc"><p>Private key proper</p></td></tr><tr id="type-priv.y" class="anchored"><td class="def field"><a href="#type-priv.y" class="anchor"></a><code>y : Z.t;</code></td><td class="doc"><p>Public component</p></td></tr></table><code>}</code></dt><dd><p>Private key. <code>p</code>, <code>q</code> and <code>gg</code> comprise <i>domain parameters</i>.</p><p><em><code>Sexplib</code> convertible</em>.</p></dd></dl><dl><dt class="spec type" id="type-pub"><a href="#type-pub" class="anchor"></a><code><span class="keyword">type </span>pub</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-pub.p" class="anchored"><td class="def field"><a href="#type-pub.p" class="anchor"></a><code>p : Z.t;</code></td></tr><tr id="type-pub.q" class="anchored"><td class="def field"><a href="#type-pub.q" class="anchor"></a><code>q : Z.t;</code></td></tr><tr id="type-pub.gg" class="anchored"><td class="def field"><a href="#type-pub.gg" class="anchor"></a><code>gg : Z.t;</code></td></tr><tr id="type-pub.y" class="anchored"><td class="def field"><a href="#type-pub.y" class="anchor"></a><code>y : Z.t;</code></td></tr></table><code>}</code></dt><dd><p>Public key, a subset of <a href="index.html#type-priv"><span>private key</span></a>.</p><p><em><code>Sexplib</code> convertible</em>.</p></dd></dl><dl><dt class="spec type" id="type-keysize"><a href="#type-keysize" class="anchor"></a><code><span class="keyword">type </span>keysize</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-keysize.Fips1024" class="anchored"><td class="def constructor"><a href="#type-keysize.Fips1024" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fips1024</code></td></tr><tr id="type-keysize.Fips2048" class="anchored"><td class="def constructor"><a href="#type-keysize.Fips2048" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fips2048</code></td></tr><tr id="type-keysize.Fips3072" class="anchored"><td class="def constructor"><a href="#type-keysize.Fips3072" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fips3072</code></td></tr><tr id="type-keysize.Exactly" class="anchored"><td class="def constructor"><a href="#type-keysize.Exactly" class="anchor"></a><code><span class="keyword">| </span></code><code>`Exactly<span class="keyword"> of </span>int<span class="keyword"> * </span>int</code></td></tr></table><code> ]</code></dt><dd><p>Key size request. Three <em>Fips</em> variants refer to FIPS-standardized L-values (<code>p</code> size) and imply the corresponding N (<code>q</code> size); The last variants specifies L and N directly.</p></dd></dl><dl><dt class="spec type" id="type-mask"><a href="#type-mask" class="anchor"></a><code><span class="keyword">type </span>mask</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-mask.No" class="anchored"><td class="def constructor"><a href="#type-mask.No" class="anchor"></a><code><span class="keyword">| </span></code><code>`No</code></td></tr><tr id="type-mask.Yes" class="anchored"><td class="def constructor"><a href="#type-mask.Yes" class="anchor"></a><code><span class="keyword">| </span></code><code>`Yes</code></td></tr><tr id="type-mask.Yes_with" class="anchored"><td class="def constructor"><a href="#type-mask.Yes_with" class="anchor"></a><code><span class="keyword">| </span></code><code>`Yes_with<span class="keyword"> of </span><a href="../Rng/index.html#type-g">Rng.g</a></code></td></tr></table><code> ]</code></dt><dd><p>Masking (cryptographic blinding) option.</p></dd></dl><dl><dt class="spec value" id="val-pub_of_priv"><a href="#val-pub_of_priv" class="anchor"></a><code><span class="keyword">val </span>pub_of_priv : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> <a href="index.html#type-pub">pub</a></code></dt><dd><p>Extract the public component from a private key.</p></dd></dl><dl><dt class="spec value" id="val-generate"><a href="#val-generate" class="anchor"></a><code><span class="keyword">val </span>generate : ?&#8288;g:<a href="../Rng/index.html#type-g">Rng.g</a> <span>&#45;&gt;</span> <a href="index.html#type-keysize">keysize</a> <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></dt><dd><p><code>generate g size</code> is a fresh <a href="index.html#type-priv"><span>private</span></a> key. The domain parameters are derived using a modified FIPS.186-4 probabilistic process, but the derivation can not be validated.</p></dd></dl><dl><dt class="spec value" id="val-sign"><a href="#val-sign" class="anchor"></a><code><span class="keyword">val </span>sign : ?&#8288;mask:<a href="index.html#type-mask">mask</a> <span>&#45;&gt;</span> ?&#8288;k:Z.t <span>&#45;&gt;</span> key:<a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t<span class="keyword"> * </span>Cstruct.t</code></dt><dd><p><code>sign mask k fips key digest</code> is the signature, a pair of <span class="xref-unresolved" title="unresolved reference to &quot;Cstruct.t&quot;"><code>Cstruct</code>.t</span>s representing <code>r</code> and <code>s</code> in big-endian.</p><p><code>digest</code> is the full digest of the actual message.</p><p><code>k</code>, the random component, can either be provided, or is deterministically derived as per RFC6979, using SHA256.</p></dd></dl><dl><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val </span>verify : key:<a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> (Cstruct.t<span class="keyword"> * </span>Cstruct.t) <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> bool</code></dt><dd><p><code>verify fips key (r, s) digest</code> verifies that the pair <code>(r, s)</code> is the signature of <code>digest</code>, the message digest, under the private counterpart to <code>key</code>.</p></dd></dl><dl><dt class="spec value" id="val-massage"><a href="#val-massage" class="anchor"></a><code><span class="keyword">val </span>massage : key:<a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>massage key digest</code> is the numeric value of <code>digest</code> taken modulo <code>q</code> and represented in the leftmost <code>bits(q)</code> bits of the result.</p><p>Both FIPS.186-4 and RFC6979 specify that only the leftmost <code>bits(q)</code> bits of <code>digest</code> are to be taken into account, but some implementations consider the entire <code>digest</code>. In cases where <a href="index.html#val-sign"><span>sign</span></a> and <a href="index.html#val-verify"><span>verify</span></a> seem incompatible with a given implementation (esp. if <a href="index.html#val-sign"><span>sign</span></a> produces signatures with the <code>s</code> component different from the other implementation's), it might help to pre-process <code>digest</code> using this function (e.g. <code>sign ~key (massage ~key:(pub_of_priv key) digest)</code>).</p></dd></dl><dl><dt class="spec module" id="module-K_gen"><a href="#module-K_gen" class="anchor"></a><code><span class="keyword">module </span><a href="K_gen/index.html">K_gen</a> : <span class="keyword">functor</span> (<a href="K_gen/argument-1-H/index.html">H</a> : <a href="../Hash/index.html#module-type-S">Hash.S</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><code>K_gen</code> can be instantiated over a hashing module to obtain an RFC6979 compliant <code>k</code>-generator for that hash.</p></dd></dl><dl><dt class="spec value" id="val-pub_of_sexp"><a href="#val-pub_of_sexp" class="anchor"></a><code><span class="keyword">val </span>pub_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-pub">pub</a></code></dt><dd><p>/*</p></dd></dl><dl><dt class="spec value" id="val-sexp_of_pub"><a href="#val-sexp_of_pub" class="anchor"></a><code><span class="keyword">val </span>sexp_of_pub : <a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dt class="spec value" id="val-priv_of_sexp"><a href="#val-priv_of_sexp" class="anchor"></a><code><span class="keyword">val </span>priv_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></dt><dt class="spec value" id="val-sexp_of_priv"><a href="#val-sexp_of_priv" class="anchor"></a><code><span class="keyword">val </span>sexp_of_priv : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dd><p>/*</p></dd></dl></section></div></body></html>