<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Rsa (nocrypto.Nocrypto.Rsa)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">nocrypto</a> &#x00BB; <a href="../index.html">Nocrypto</a> &#x00BB; Rsa</nav><h1>Module <code>Nocrypto.Rsa</code></h1><p><b>RSA</b> public-key cryptography.</p><p>Keys are taken to be trusted material, and their properties are not checked.</p><p>Messages are checked not to exceed the key size, and this is signalled via exceptions.</p><p>Private-key operations are optionally protected through RSA blinding.</p><nav class="toc"><ul><li><a href="#rsa-public-key-encryption">RSA public-key encryption</a></li><li><a href="#pkcs#1-padded-modes">PKCS#1 padded modes</a></li></ul></nav></header><section><header><h2 id="rsa-public-key-encryption"><a href="#rsa-public-key-encryption" class="anchor"></a>RSA public-key encryption</h2></header><dl><dt class="spec exception" id="exception-Insufficient_key"><a href="#exception-Insufficient_key" class="anchor"></a><code><span class="keyword">exception </span></code><code><span class="exception">Insufficient_key</span></code></dt><dd><p>Raised if the key is too small to transform the given message, i.e. if the numerical interpretation of the (potentially padded) message is not smaller than the modulus.</p><p>It is additionally raised if the message is <code>0</code> and the mode does not involve padding.</p></dd></dl><dl><dt class="spec type" id="type-pub"><a href="#type-pub" class="anchor"></a><code><span class="keyword">type </span>pub</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-pub.e" class="anchored"><td class="def field"><a href="#type-pub.e" class="anchor"></a><code>e : Z.t;</code></td><td class="doc"><p>Public exponent</p></td></tr><tr id="type-pub.n" class="anchored"><td class="def field"><a href="#type-pub.n" class="anchor"></a><code>n : Z.t;</code></td><td class="doc"><p>Modulus</p></td></tr></table><code>}</code></dt><dd><p>Public key.</p><p><em><code>Sexplib</code> convertible</em>.</p></dd></dl><dl><dt class="spec type" id="type-priv"><a href="#type-priv" class="anchor"></a><code><span class="keyword">type </span>priv</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-priv.e" class="anchored"><td class="def field"><a href="#type-priv.e" class="anchor"></a><code>e : Z.t;</code></td><td class="doc"><p>Public exponent</p></td></tr><tr id="type-priv.d" class="anchored"><td class="def field"><a href="#type-priv.d" class="anchor"></a><code>d : Z.t;</code></td><td class="doc"><p>Private exponent</p></td></tr><tr id="type-priv.n" class="anchored"><td class="def field"><a href="#type-priv.n" class="anchor"></a><code>n : Z.t;</code></td><td class="doc"><p>Modulus</p></td></tr><tr id="type-priv.p" class="anchored"><td class="def field"><a href="#type-priv.p" class="anchor"></a><code>p : Z.t;</code></td><td class="doc"><p>Prime factor <code>p</code></p></td></tr><tr id="type-priv.q" class="anchored"><td class="def field"><a href="#type-priv.q" class="anchor"></a><code>q : Z.t;</code></td><td class="doc"><p>Prime factor <code>q</code></p></td></tr><tr id="type-priv.dp" class="anchored"><td class="def field"><a href="#type-priv.dp" class="anchor"></a><code>dp : Z.t;</code></td><td class="doc"><p><code>d mod (p-1)</code></p></td></tr><tr id="type-priv.dq" class="anchored"><td class="def field"><a href="#type-priv.dq" class="anchor"></a><code>dq : Z.t;</code></td><td class="doc"><p><code>d mod (q-1)</code></p></td></tr><tr id="type-priv.q'" class="anchored"><td class="def field"><a href="#type-priv.q'" class="anchor"></a><code>q' : Z.t;</code></td><td class="doc"><p><code>q^(-1) mod p</code></p></td></tr></table><code>}</code></dt><dd><p>Private key (two-factor version).</p><p><em><code>Sexplib</code> convertible</em>.</p></dd></dl><dl><dt class="spec type" id="type-mask"><a href="#type-mask" class="anchor"></a><code><span class="keyword">type </span>mask</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-mask.No" class="anchored"><td class="def constructor"><a href="#type-mask.No" class="anchor"></a><code><span class="keyword">| </span></code><code>`No</code></td></tr><tr id="type-mask.Yes" class="anchored"><td class="def constructor"><a href="#type-mask.Yes" class="anchor"></a><code><span class="keyword">| </span></code><code>`Yes</code></td></tr><tr id="type-mask.Yes_with" class="anchored"><td class="def constructor"><a href="#type-mask.Yes_with" class="anchor"></a><code><span class="keyword">| </span></code><code>`Yes_with<span class="keyword"> of </span><a href="../Rng/index.html#type-g">Rng.g</a></code></td></tr></table><code> ]</code></dt><dd><p>Masking (cryptographic blinding) option.</p></dd></dl><dl><dt class="spec value" id="val-pub_bits"><a href="#val-pub_bits" class="anchor"></a><code><span class="keyword">val </span>pub_bits : <a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Bit-size of a public key.</p></dd></dl><dl><dt class="spec value" id="val-priv_bits"><a href="#val-priv_bits" class="anchor"></a><code><span class="keyword">val </span>priv_bits : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Bit-size of a private key.</p></dd></dl><dl><dt class="spec value" id="val-priv_of_primes"><a href="#val-priv_of_primes" class="anchor"></a><code><span class="keyword">val </span>priv_of_primes : e:Z.t <span>&#45;&gt;</span> p:Z.t <span>&#45;&gt;</span> q:Z.t <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></dt><dd><p><code>priv_of_primes e p q</code> creates <a href="index.html#type-priv"><span>priv</span></a> from a minimal description: the public exponent and the two primes.</p></dd></dl><dl><dt class="spec value" id="val-pub_of_priv"><a href="#val-pub_of_priv" class="anchor"></a><code><span class="keyword">val </span>pub_of_priv : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> <a href="index.html#type-pub">pub</a></code></dt><dd><p>Extract the public component from a private key.</p></dd></dl><dl><dt class="spec value" id="val-encrypt"><a href="#val-encrypt" class="anchor"></a><code><span class="keyword">val </span>encrypt : key:<a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>encrypt key message</code> is the encrypted <code>message</code>.</p><dl><dt>raises Insufficient_key</dt><dd><p>(see <a href="index.html#exception-Insufficient_key"><span>Insufficient_key</span></a>)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-decrypt"><a href="#val-decrypt" class="anchor"></a><code><span class="keyword">val </span>decrypt : ?&#8288;mask:<a href="index.html#type-mask">mask</a> <span>&#45;&gt;</span> key:<a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> Cstruct.t <span>&#45;&gt;</span> Cstruct.t</code></dt><dd><p><code>decrypt mask key ciphertext</code> is the decrypted <code>ciphertext</code>, left-padded with <code>0x00</code> up to <code>key</code> size.</p><dl><dt>raises Insufficient_key</dt><dd><p>(see <a href="index.html#exception-Insufficient_key"><span>Insufficient_key</span></a>)</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-generate"><a href="#val-generate" class="anchor"></a><code><span class="keyword">val </span>generate : ?&#8288;g:<a href="../Rng/index.html#type-g">Rng.g</a> <span>&#45;&gt;</span> ?&#8288;e:Z.t <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></dt><dd><p><code>generate g e bits</code> is a new <a href="index.html#type-priv"><span>priv</span></a>. <code>e</code> defaults to <code>2^16+1</code>.</p><dl><dt>raises Invalid_argument</dt><dd><p>if <code>e</code> is bad or <code>bits</code> is too small.</p></dd></dl></dd></dl></section><section><header><h2 id="pkcs#1-padded-modes"><a href="#pkcs#1-padded-modes" class="anchor"></a>PKCS#1 padded modes</h2></header><dl><dt class="spec module" id="module-PKCS1"><a href="#module-PKCS1" class="anchor"></a><code><span class="keyword">module </span><a href="PKCS1/index.html">PKCS1</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><b>PKCS v1.5</b>-padded operations, as defined by <b>PKCS #1 v1.5</b>.</p></dd></dl><dl><dt class="spec module" id="module-OAEP"><a href="#module-OAEP" class="anchor"></a><code><span class="keyword">module </span><a href="OAEP/index.html">OAEP</a> : <span class="keyword">functor</span> (<a href="OAEP/argument-1-H/index.html">H</a> : <a href="../Hash/index.html#module-type-S">Hash.S</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><b>OAEP</b>-padded encryption, as defined by <b>PKCS #1 v2.1</b>.</p></dd></dl><dl><dt class="spec module" id="module-PSS"><a href="#module-PSS" class="anchor"></a><code><span class="keyword">module </span><a href="PSS/index.html">PSS</a> : <span class="keyword">functor</span> (<a href="PSS/argument-1-H/index.html">H</a> : <a href="../Hash/index.html#module-type-S">Hash.S</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p><b>PSS</b>-based signing, as defined by <b>PKCS #1 v2.1</b>.</p></dd></dl><dl><dt class="spec value" id="val-pub_of_sexp"><a href="#val-pub_of_sexp" class="anchor"></a><code><span class="keyword">val </span>pub_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-pub">pub</a></code></dt><dd><p>/*</p></dd></dl><dl><dt class="spec value" id="val-sexp_of_pub"><a href="#val-sexp_of_pub" class="anchor"></a><code><span class="keyword">val </span>sexp_of_pub : <a href="index.html#type-pub">pub</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dt class="spec value" id="val-priv_of_sexp"><a href="#val-priv_of_sexp" class="anchor"></a><code><span class="keyword">val </span>priv_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-priv">priv</a></code></dt><dt class="spec value" id="val-sexp_of_priv"><a href="#val-sexp_of_priv" class="anchor"></a><code><span class="keyword">val </span>sexp_of_priv : <a href="index.html#type-priv">priv</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dd><p>/*</p></dd></dl></section></div></body></html>