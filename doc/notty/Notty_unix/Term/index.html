<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Term (notty.Notty_unix.Term)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">notty</a> &#x00BB; <a href="../index.html">Notty_unix</a> &#x00BB; Term</nav><h1>Module <code>Notty_unix.Term</code></h1><p>Terminal IO abstraction for fullscreen, interactive applications.</p><p>This module provides both input and output. It assumes exclusive ownership of the IO streams between <a href="index.html#val-create"><span>initialization</span></a> and <a href="index.html#val-release"><span>shutdown</span></a>.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>Representation of the terminal, giving structured access to IO.</p></dd></dl><section><header><h2 id="construction-and-destruction"><a href="#construction-and-destruction" class="anchor"></a>Construction and destruction</h2></header><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : ?&#8288;dispose:bool <span>&#45;&gt;</span> ?&#8288;nosig:bool <span>&#45;&gt;</span> ?&#8288;mouse:bool <span>&#45;&gt;</span> ?&#8288;bpaste:bool <span>&#45;&gt;</span> ?&#8288;input:Unix.file_descr <span>&#45;&gt;</span> ?&#8288;output:Unix.file_descr <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create ~dispose ~nosig ~mouse ~input ~output ()</code> creates a fresh <a href="index.html#type-t"><span>terminal</span></a>. It has the following side effects:</p><ul><li><code>Unix.tcsetattr</code> is applied to <code>input</code> to disable <em>echo</em> and <em>canonical mode</em>.</li><li><code>output</code> is set to <em>alternate screen mode</em>, and the cursor is hidden. Mouse and <em>bracketed paste</em> reporting are (optionally) enabled.</li><li><code>SIGWINCH</code> signal, normally ignored, is handled.</li></ul><p><code>~dispose</code> arranges for automatic <a href="index.html#val-release"><span>cleanup</span></a> of the terminal before the process terminates. The downside is that a reference to this terminal is retained until the program exits. Defaults to <code>true</code>.</p><p><code>~nosig</code> additionally turns off signal delivery and flow control (<em>isig</em> and <em>ixon</em>) on input. Inhibits automatic handling of <em>CTRL-{C,Z,\,S,Q}</em>. Defaults to <code>true</code>.</p><p><code>~mouse</code> activates mouse reporting. Defaults to <code>true</code>.</p><p><code>~bpaste</code> activates bracketed paste reporting. Defaults to <code>true</code>.</p><p><code>~input</code> is the input file descriptor. Defaults to <code>stdin</code>.</p><p><code>~output</code> is the output file descriptor. Defaults to <code>stdout</code>.</p></dd></dl><dl><dt class="spec value" id="val-release"><a href="#val-release" class="anchor"></a><code><span class="keyword">val </span>release : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Dispose of this terminal. Original behavior of input fd is reinstated, cursor is restored, mouse reporting disabled, and alternate mode is terminated.</p><p>It is an error to use the <a href="index.html#cmds"><span>commands</span></a> on a released terminal, and will raise <code>Invalid_argument</code>, while <code>release</code> itself is idempotent.</p></dd></dl></section><section><header><h2 id="cmds"><a href="#cmds" class="anchor"></a>Commands</h2></header><dl><dt class="spec value" id="val-image"><a href="#val-image" class="anchor"></a><code><span class="keyword">val </span>image : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Notty.image <span>&#45;&gt;</span> unit</code></dt><dd><p><code>image t i</code> sets <code>i</code> as <code>t</code>'s current image and redraws the terminal.</p></dd></dl><dl><dt class="spec value" id="val-refresh"><a href="#val-refresh" class="anchor"></a><code><span class="keyword">val </span>refresh : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>refresh t</code> redraws the terminal using the current image.</p><p>Useful if the output might have become garbled.</p></dd></dl><dl><dt class="spec value" id="val-cursor"><a href="#val-cursor" class="anchor"></a><code><span class="keyword">val </span>cursor : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (int<span class="keyword"> * </span>int) option <span>&#45;&gt;</span> unit</code></dt><dd><p><code>cursor t pos</code> sets and redraws the cursor.</p><p><code>None</code> hides it. <code>Some (x, y)</code> places it at column <code>x</code> and row <code>y</code>, with the origin at <code>(0, 0)</code>, mapping to the upper-left corner.</p></dd></dl></section><section><header><h2 id="events"><a href="#events" class="anchor"></a>Events</h2></header><dl><dt class="spec value" id="val-event"><a href="#val-event" class="anchor"></a><code><span class="keyword">val </span>event : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ Notty.Unescape.event<span class="keyword"> | </span>`Resize of int<span class="keyword"> * </span>int<span class="keyword"> | </span>`End ]</code></dt><dd><p>Wait for a new event. <code>event t</code> can be:</p><ul><li><code>#Unescape.event</code>, an <span class="xref-unresolved" title="unresolved reference to &quot;Notty.Unescape.event&quot;"><span><code>event</code></span></span> from the input fd;</li><li><code>`End</code> if the input fd is closed, or the terminal was released; or</li><li><code>`Resize (cols * rows)</code> giving the current size of the output tty, if a <code>SIGWINCH</code> was delivered before or during this call to <code>event</code>.</li></ul><p><b>Note</b> <code>event</code> is buffered. Calls can either block or immediately return. Use <a href="index.html#val-pending"><span><code>pending</code></span></a> to detect when the next call would not block.</p></dd></dl><dl><dt class="spec value" id="val-pending"><a href="#val-pending" class="anchor"></a><code><span class="keyword">val </span>pending : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>pending t</code> is <code>true</code> if the next call to <a href="index.html#val-event"><span><code>event</code></span></a> would not block and the terminal has not yet been released.</p></dd></dl></section><section><header><h2 id="properties"><a href="#properties" class="anchor"></a>Properties</h2></header><dl><dt class="spec value" id="val-size"><a href="#val-size" class="anchor"></a><code><span class="keyword">val </span>size : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int<span class="keyword"> * </span>int</code></dt><dd><p><code>size t</code> is the current size of the terminal's output tty.</p></dd></dl><dl><dt class="spec value" id="val-fds"><a href="#val-fds" class="anchor"></a><code><span class="keyword">val </span>fds : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Unix.file_descr<span class="keyword"> * </span>Unix.file_descr</code></dt><dd><p><code>fds t</code> are <code>t</code>'s input and output file descriptors.</p></dd></dl></section><section><header><h2 id="window-size-change-notifications"><a href="#window-size-change-notifications" class="anchor"></a>Window size change notifications</h2></header><dl><dt class="spec module" id="module-Winch"><a href="#module-Winch" class="anchor"></a><code><span class="keyword">module </span><a href="Winch/index.html">Winch</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Manual <code>SIGWINCH</code> handling.</p></dd></dl></section></div></body></html>