<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Json_query (ocplib-json-typed.Json_query)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ocplib-json-typed</a> &#x00BB; Json_query</nav><h1>Module <code>Json_query</code></h1><p>Queries in JSON documents</p><nav class="toc"><ul><li><a href="#paths-in-json-documents">Paths in JSON documents</a></li><li><a href="#querying-json-documents">Querying JSON documents</a></li><li><a href="#errors">Errors</a></li><li><a href="#advanced-interface-for-using-a-custom-json-representation">Advanced interface for using a custom JSON representation</a></li></ul></nav></header><section><header><h3 id="paths-in-json-documents"><a href="#paths-in-json-documents" class="anchor"></a>Paths in JSON documents</h3></header><dl><dt class="spec type" id="type-path"><a href="#type-path" class="anchor"></a><code><span class="keyword">type</span> path</code><code> = <a href="index.html#type-path_item">path_item</a> list</code></dt><dd><p>An abstract type for paths into a JSON document. A sequence of sub-tree selectors to descend into a JSON tree.</p></dd></dl><dl><dt class="spec type" id="type-path_item"><a href="#type-path_item" class="anchor"></a><code><span class="keyword">and</span> path_item</code> = <code>[ </code><table class="variant"><tr id="type-path_item.Field" class="anchored"><td class="def constructor"><a href="#type-path_item.Field" class="anchor"></a><code>| </code><code>`Field <span class="keyword">of</span> string</code></td><td class="doc"><p>A field in an object.</p></td></tr><tr id="type-path_item.Index" class="anchored"><td class="def constructor"><a href="#type-path_item.Index" class="anchor"></a><code>| </code><code>`Index <span class="keyword">of</span> int</code></td><td class="doc"><p>An index in an array.</p></td></tr><tr id="type-path_item.Star" class="anchored"><td class="def constructor"><a href="#type-path_item.Star" class="anchor"></a><code>| </code><code>`Star</code></td><td class="doc"><p>Any / every field or index.</p></td></tr><tr id="type-path_item.Next" class="anchored"><td class="def constructor"><a href="#type-path_item.Next" class="anchor"></a><code>| </code><code>`Next</code></td><td class="doc"><p>The next element after an array.</p></td></tr></table><code> ]</code></dt><dd><p>A JSON sub-tree selector. Indendent from any concrete format (JSON pointer, JSON path, etc.) The semantics depends on the use (selection, insertion, etc.)</p></dd></dl><dl><dt class="spec value" id="val-print_path_as_json_pointer"><a href="#val-print_path_as_json_pointer" class="anchor"></a><code><span class="keyword">val</span> print_path_as_json_pointer : ?&#8288;wildcards:bool <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pretty prints a path in JSON pointer format (RFC6901). May throw <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>. Use <code>~wildcards:false</code> to deactivate the support of wildcard path items, which may lead to <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-print_path_as_json_path"><a href="#val-print_path_as_json_path" class="anchor"></a><code><span class="keyword">val</span> print_path_as_json_path : ?&#8288;wildcards:bool <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Pretty prints a path in JSON path format. Use <code>~wildcards:false</code> to deactivate the support of wildcard path items, which may lead to <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-json_pointer_of_path"><a href="#val-json_pointer_of_path" class="anchor"></a><code><span class="keyword">val</span> json_pointer_of_path : ?&#8288;wildcards:bool <span>&#45;&gt;</span> <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Pretty prints a path in JSON pointer format into a fresh string. May throw <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>. Use <code>~wildcards:false</code> to deactivate the support of wildcard path items, which may lead to <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-path_of_json_pointer"><a href="#val-path_of_json_pointer" class="anchor"></a><code><span class="keyword">val</span> path_of_json_pointer : ?&#8288;wildcards:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-path">path</a></code></dt><dd><p>Parses a path from a string in JSON pointer format. May throw <a href="index.html#exception-Illegal_pointer_notation"><code>Illegal_pointer_notation</code></a>. The string is expected to be ASCII compatible, including UTF-8. Use <code>~wildcards:false</code> to deactivate the support of wildcard path items, which may lead to <a href="index.html#exception-Unsupported_path_item"><code>Unsupported_path_item</code></a>.</p></dd></dl></section><section><header><h3 id="querying-json-documents"><a href="#querying-json-documents" class="anchor"></a>Querying JSON documents</h3></header><dl><dt class="spec value" id="val-query"><a href="#val-query" class="anchor"></a><code><span class="keyword">val</span> query : <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a></code></dt><dd><p>Extracts the value located at a given path. If multiple locations satisfy the path (in presence of wildcard path items), the chosen one is unspecified. May throw <code>Not_found</code>.</p><p>This function works with JSON data represented in the <a href="../Json_repr/index.html#type-ezjsonm"><code>Json_repr.ezjsonm</code></a> format. See functor <a href="Make/index.html"><code>Make</code></a> for using another representation.</p></dd></dl><dl><dt class="spec value" id="val-query_all"><a href="#val-query_all" class="anchor"></a><code><span class="keyword">val</span> query_all : <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> list</code></dt><dd><p>Extracts the values located at a given path (may be more than one in presence of wildcard path items). The order is unspecified.</p><p>This function works with JSON data represented in the <a href="../Json_repr/index.html#type-ezjsonm"><code>Json_repr.ezjsonm</code></a> format. See functor <a href="Make/index.html"><code>Make</code></a> for using another representation.</p></dd></dl><dl><dt class="spec value" id="val-insert"><a href="#val-insert" class="anchor"></a><code><span class="keyword">val</span> insert : <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a></code></dt><dd><p>Insert a value at a given path. If multiple locations satisfy the path (in presence of wildcard path items), the chosen one is unspecified. Will create parent objects or arrays if needed, for instance inserting <code>3</code> at <code>/a/b/c</code> in <code>{}</code> will result in <code>{&quot;a&quot;:{&quot;b&quot;:{&quot;c&quot;:3}}}</code>. Inserting in an array at an index bigger than the previous size will expand the array, filling potential missing cells with <code>`Null</code>. Inserting in an array at <code>`Index n</code> where <code>n</code> is negative inserts from the last element of the array. If a value is inserted at a location where there is already one, both are merged as if with <a href="index.html#val-merge"><code>merge</code></a>. May throw <a href="index.html#exception-Cannot_merge"><code>Cannot_merge</code></a> if the path is incompatible with the original object (such as inserting in a field of something which is not an object) or if the value is to be merged with an incompatible existing value.</p><p>This function works with JSON data represented in the <a href="../Json_repr/index.html#type-ezjsonm"><code>Json_repr.ezjsonm</code></a> format. See functor <a href="Make/index.html"><code>Make</code></a> for using another representation.</p></dd></dl><dl><dt class="spec value" id="val-replace"><a href="#val-replace" class="anchor"></a><code><span class="keyword">val</span> replace : <a href="index.html#type-path">path</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a></code></dt><dd><p>Same as <a href="index.html#val-insert"><code>insert</code></a>, except that if the path leads to a pre-existing value, it is replaced with the new one instead of being merged.</p><p>This function works with JSON data represented in the <a href="../Json_repr/index.html#type-ezjsonm"><code>Json_repr.ezjsonm</code></a> format. See functor <a href="Make/index.html"><code>Make</code></a> for using another representation.</p></dd></dl><dl><dt class="spec value" id="val-merge"><a href="#val-merge" class="anchor"></a><code><span class="keyword">val</span> merge : <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a> <span>&#45;&gt;</span> <a href="../Json_repr/index.html#type-ezjsonm">Json_repr.ezjsonm</a></code></dt><dd><p>Merges two compatible JSON values. Merges <code>`Null</code> with any JSON value. Merges two deeply equal values together. Merges two objects by merging their common fields and adding all the others. Merges two arrays by merging their common cells pairwise and adding the remaining ones if one array is bigger than the other. May throw <a href="index.html#exception-Cannot_merge"><code>Cannot_merge</code></a>.</p><p>This function works with JSON data represented in the <a href="../Json_repr/index.html#type-ezjsonm"><code>Json_repr.ezjsonm</code></a> format. See functor <a href="Make/index.html"><code>Make</code></a> for using another representation.</p></dd></dl></section><section><header><h3 id="errors"><a href="#errors" class="anchor"></a>Errors</h3></header><dl><dt class="spec exception" id="exception-Cannot_merge"><a href="#exception-Cannot_merge" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Cannot_merge</span> <span class="keyword">of</span> <a href="index.html#type-path">path</a></code></dt><dd><p>When two incompatible objects are unsuccessfully merged. Comes with the path to the first incompatibility encountered.</p></dd></dl><dl><dt class="spec exception" id="exception-Illegal_pointer_notation"><a href="#exception-Illegal_pointer_notation" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Illegal_pointer_notation</span> <span class="keyword">of</span> string * int * string</code></dt><dd><p>An path litteral could not be parsed. Comes with the original string, the position and an explanation.</p></dd></dl><dl><dt class="spec exception" id="exception-Unsupported_path_item"><a href="#exception-Unsupported_path_item" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Unsupported_path_item</span> <span class="keyword">of</span> <a href="index.html#type-path_item">path_item</a> * string</code></dt><dd><p>An operation was given a path containing an unsupported construct. Comes with an explanation as its second argument.</p></dd></dl><dl><dt class="spec value" id="val-print_error"><a href="#val-print_error" class="anchor"></a><code><span class="keyword">val</span> print_error : ?&#8288;print_unknown:(<a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> exn <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> exn <span>&#45;&gt;</span> unit</code></dt><dd><p>Produces a human readable version of an error.</p></dd></dl></section><section><header><h3 id="advanced-interface-for-using-a-custom-json-representation"><a href="#advanced-interface-for-using-a-custom-json-representation" class="anchor"></a>Advanced interface for using a custom JSON representation</h3></header><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span class="keyword">module</span> <a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/argument-1-Repr/index.html">Repr</a> : <a href="../Json_repr/index.html#module-type-Repr">Json_repr.Repr</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section></div></body></html>