<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamRepository (opam-lib.OpamRepository)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-lib</a> &#x00BB; OpamRepository</nav><h1>Module <code>OpamRepository</code></h1><p>Defines on-disk package repositories, synchronised with an upstream</p><nav class="toc"><ul><li><a href="#repository-collection-operations">Repository Collection Operations</a></li><li><a href="#state">State</a></li><li><a href="#repository-backends">Repository backends</a></li></ul></nav></header><dl><dt class="spec value" id="val-packages"><a href="#val-packages" class="anchor"></a><code><span class="keyword">val </span>packages : OpamTypes.repository <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Get the list of packages</p></dd></dl><dl><dt class="spec value" id="val-packages_with_prefixes"><a href="#val-packages_with_prefixes" class="anchor"></a><code><span class="keyword">val </span>packages_with_prefixes : OpamTypes.repository <span>&#45;&gt;</span> string option OpamTypes.package_map</code></dt><dd><p>Get the list of packages (and their eventual prefixes)</p></dd></dl><dl><dt class="spec value" id="val-compilers"><a href="#val-compilers" class="anchor"></a><code><span class="keyword">val </span>compilers : OpamTypes.repository <span>&#45;&gt;</span> OpamTypes.compiler_set</code></dt><dd><p>Get the list of all compiler</p></dd></dl><dl><dt class="spec value" id="val-compilers_with_prefixes"><a href="#val-compilers_with_prefixes" class="anchor"></a><code><span class="keyword">val </span>compilers_with_prefixes : OpamTypes.repository <span>&#45;&gt;</span> string option OpamTypes.compiler_map</code></dt><dd><p>Get the list of compilers (and their eventual prefixes)</p></dd></dl><section><header><h3 id="repository-collection-operations"><a href="#repository-collection-operations" class="anchor"></a>Repository Collection Operations</h3></header><dl><dt class="spec value" id="val-sort"><a href="#val-sort" class="anchor"></a><code><span class="keyword">val </span>sort : OpamTypes.repository OpamTypes.repository_name_map <span>&#45;&gt;</span> OpamTypes.repository list</code></dt><dd><p>Sort a collection of repositories by priority</p></dd></dl><dl><dt class="spec value" id="val-package_index"><a href="#val-package_index" class="anchor"></a><code><span class="keyword">val </span>package_index : OpamTypes.repository OpamTypes.repository_name_map <span>&#45;&gt;</span> (OpamTypes.repository_name<span class="keyword"> * </span>string option) OpamTypes.package_map</code></dt><dd><p>Generate a package index from a collection of repositories</p></dd></dl><dl><dt class="spec value" id="val-compiler_index"><a href="#val-compiler_index" class="anchor"></a><code><span class="keyword">val </span>compiler_index : OpamTypes.repository OpamTypes.repository_name_map <span>&#45;&gt;</span> (OpamTypes.repository_name<span class="keyword"> * </span>string option) OpamTypes.compiler_map</code></dt><dd><p>Generate a compiler index from a collection of repositories</p></dd></dl></section><section><header><h3 id="state"><a href="#state" class="anchor"></a>State</h3></header><dl><dt class="spec value" id="val-url_checksum"><a href="#val-url_checksum" class="anchor"></a><code><span class="keyword">val </span>url_checksum : OpamFilename.t <span>&#45;&gt;</span> OpamTypes.checksums</code></dt><dd><p>Get the package archive checksum off an url file</p></dd></dl><dl><dt class="spec value" id="val-package_files"><a href="#val-package_files" class="anchor"></a><code><span class="keyword">val </span>package_files : OpamTypes.repository <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> archive:bool <span>&#45;&gt;</span> OpamTypes.filename list</code></dt><dd><p>Get all the package files</p></dd></dl><dl><dt class="spec value" id="val-package_state"><a href="#val-package_state" class="anchor"></a><code><span class="keyword">val </span>package_state : OpamTypes.repository <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> [ `all<span class="keyword"> | </span>`partial of bool ] <span>&#45;&gt;</span> OpamTypes.checksums</code></dt><dd><p>Compute a package state (ie. a list of checksums). If <code>`partial archive</code>, only the checksum of the archive within the url file (instead of the file itself), of the files/ subdirectory, and of the archive if set are returned.</p></dd></dl><dl><dt class="spec value" id="val-compiler_files"><a href="#val-compiler_files" class="anchor"></a><code><span class="keyword">val </span>compiler_files : OpamTypes.repository <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> OpamTypes.filename list</code></dt><dd><p>Get all the compiler files</p></dd></dl><dl><dt class="spec value" id="val-compiler_state"><a href="#val-compiler_state" class="anchor"></a><code><span class="keyword">val </span>compiler_state : OpamTypes.repository <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> OpamTypes.checksums</code></dt><dd><p>Compute a compiler state (ie. a list of checksums).</p></dd></dl></section><section><header><h3 id="repository-backends"><a href="#repository-backends" class="anchor"></a>Repository backends</h3></header><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val </span>init : OpamTypes.repository <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p>Initialize <i>$opam/repo/$repo</i></p></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : OpamTypes.repository <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p>Update <i>$opam/repo/$repo</i>.</p></dd></dl><dl><dt class="spec value" id="val-check_version"><a href="#val-check_version" class="anchor"></a><code><span class="keyword">val </span>check_version : OpamTypes.repository <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p>Error and exit on incompatible version</p></dd></dl><dl><dt class="spec value" id="val-pull_url"><a href="#val-pull_url" class="anchor"></a><code><span class="keyword">val </span>pull_url : OpamTypes.repository_kind <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.address list <span>&#45;&gt;</span> OpamTypes.generic_file OpamTypes.download OpamProcess.job</code></dt><dd><p>Download an url. Several mirrors can be provided, in which case they will be tried in order in case of an error.</p></dd></dl><dl><dt class="spec value" id="val-pull_url_and_fix_digest"><a href="#val-pull_url_and_fix_digest" class="anchor"></a><code><span class="keyword">val </span>pull_url_and_fix_digest : OpamTypes.repository_kind <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> string <span>&#45;&gt;</span> OpamTypes.filename <span>&#45;&gt;</span> OpamTypes.address list <span>&#45;&gt;</span> OpamTypes.generic_file OpamTypes.download OpamProcess.job</code></dt><dd><p>Pull and fix the resulting digest</p></dd></dl><dl><dt class="spec value" id="val-pull_archive"><a href="#val-pull_archive" class="anchor"></a><code><span class="keyword">val </span>pull_archive : OpamTypes.repository <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.filename OpamTypes.download OpamProcess.job</code></dt><dd><p>Pull an archive in a repository</p></dd></dl><dl><dt class="spec value" id="val-revision"><a href="#val-revision" class="anchor"></a><code><span class="keyword">val </span>revision : OpamTypes.repository <span>&#45;&gt;</span> OpamTypes.version option OpamProcess.job</code></dt><dd><p>Get the optional revision associated to a backend.</p></dd></dl><dl><dt class="spec value" id="val-make_archive"><a href="#val-make_archive" class="anchor"></a><code><span class="keyword">val </span>make_archive : ?&#8288;gener_digest:bool <span>&#45;&gt;</span> OpamTypes.repository <span>&#45;&gt;</span> string option <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p><code>make_archive ?gener_digest repo prefix package</code> builds the archive for the given <code>package</code>. By default, the digest that appears in <i>$NAME.$VERSION/url</i> is not modified, unless <code>gener_digest</code> is set.</p></dd></dl><dl><dt class="spec value" id="val-find_backend"><a href="#val-find_backend" class="anchor"></a><code><span class="keyword">val </span>find_backend : OpamTypes.repository <span>&#45;&gt;</span> (<span class="keyword">module </span>OpamRepositoryBackend.S)</code></dt><dd><p>Find a backend</p></dd></dl><dl><dt class="spec value" id="val-find_backend_by_kind"><a href="#val-find_backend_by_kind" class="anchor"></a><code><span class="keyword">val </span>find_backend_by_kind : OpamTypes.repository_kind <span>&#45;&gt;</span> (<span class="keyword">module </span>OpamRepositoryBackend.S)</code></dt></dl></section></div></body></html>