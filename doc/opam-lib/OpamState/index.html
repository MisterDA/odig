<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamState (opam-lib.OpamState)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-lib</a> &#x00BB; OpamState</nav><h1>Module <code>OpamState</code></h1><p>OPAM client state</p><nav class="toc"><ul><li><a href="#environment">Environment</a></li><li><a href="#initialisation">Initialisation</a></li><li><a href="#filters">Filters</a></li><li><a href="#helpers">Helpers</a></li><li><a href="#repositories">Repositories</a></li><li><a href="#compilers">Compilers</a></li><li><a href="#packages">Packages</a></li><li><a href="#development-packages">Development packages</a></li><li><a href="#configuration-files">Configuration files</a></li><li><a href="#locks">Locks</a></li><li><a href="#pinned-packages">Pinned packages</a></li><li><a href="#overlays">Overlays</a></li><li><a href="#system-compilers">System compilers</a></li></ul></nav></header><dl><dt class="spec module" id="module-Types"><a href="#module-Types" class="anchor"></a><code><span class="keyword">module </span><a href="Types/index.html">Types</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Client state</p></dd></dl><dl><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type </span>state</code><code><span class="keyword"> = </span><a href="Types/index.html#type-t">Types.t</a></code></dt></dl><dl><dt class="spec module" id="module-Cache"><a href="#module-Cache" class="anchor"></a><code><span class="keyword">module </span><a href="Cache/index.html">Cache</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Caching of repository loading (marshall of all parsed opam files)</p></dd></dl><dl><dt class="spec value" id="val-load_state"><a href="#val-load_state" class="anchor"></a><code><span class="keyword">val </span>load_state : ?&#8288;save_cache:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Load the client state. The string argument is to identify to call site.</p></dd></dl><dl><dt class="spec value" id="val-dump_state"><a href="#val-dump_state" class="anchor"></a><code><span class="keyword">val </span>dump_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> Pervasives.out_channel <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-with_switch"><a href="#val-with_switch" class="anchor"></a><code><span class="keyword">val </span>with_switch : OpamTypes.switch <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Adjust the switch, compiler and switch_config in a partial state</p></dd></dl><dl><dt class="spec value" id="val-load_env_state"><a href="#val-load_env_state" class="anchor"></a><code><span class="keyword">val </span>load_env_state : string <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Load state associated to env variables. All other fields are left empty.</p></dd></dl><dl><dt class="spec value" id="val-universe"><a href="#val-universe" class="anchor"></a><code><span class="keyword">val </span>universe : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.user_action <span>&#45;&gt;</span> OpamTypes.universe</code></dt><dd><p>Create a universe from the current state</p></dd></dl><section><header><h3 id="environment"><a href="#environment" class="anchor"></a>Environment</h3></header><dl><dt class="spec value" id="val-get_full_env"><a href="#val-get_full_env" class="anchor"></a><code><span class="keyword">val </span>get_full_env : force_path:bool <span>&#45;&gt;</span> ?&#8288;opam:OpamFile.OPAM.t <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.env</code></dt><dd><p>Get the current environment with OPAM specific additions. If <code>force_path</code>, the PATH is modified to ensure opam dirs are leading.</p></dd></dl><dl><dt class="spec value" id="val-get_opam_env"><a href="#val-get_opam_env" class="anchor"></a><code><span class="keyword">val </span>get_opam_env : force_path:bool <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.env</code></dt><dd><p>Get only environment modified by OPAM. If <code>force_path</code>, the PATH is modified to ensure opam dirs are leading.</p></dd></dl><dl><dt class="spec value" id="val-add_to_env"><a href="#val-add_to_env" class="anchor"></a><code><span class="keyword">val </span>add_to_env : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> ?&#8288;opam:OpamFile.OPAM.t <span>&#45;&gt;</span> OpamTypes.env <span>&#45;&gt;</span> ?&#8288;variables:OpamTypes.variable_contents option OpamVariable.Map.t <span>&#45;&gt;</span> (string<span class="keyword"> * </span>string<span class="keyword"> * </span>string) list <span>&#45;&gt;</span> OpamTypes.env</code></dt><dd><p>Update an environment.</p></dd></dl><dl><dt class="spec value" id="val-up_to_date_env"><a href="#val-up_to_date_env" class="anchor"></a><code><span class="keyword">val </span>up_to_date_env : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Check if the shell environment is in sync with the current OPAM switch</p></dd></dl><dl><dt class="spec value" id="val-eval_string"><a href="#val-eval_string" class="anchor"></a><code><span class="keyword">val </span>eval_string : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> string</code></dt><dd><p>The shell command to run by the user to set his OPAM environement (<code>eval
    `opam config env`</code>)</p></dd></dl><dl><dt class="spec value" id="val-print_env_warning_at_init"><a href="#val-print_env_warning_at_init" class="anchor"></a><code><span class="keyword">val </span>print_env_warning_at_init : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.user_config <span>&#45;&gt;</span> unit</code></dt><dd><p>Print a warning if the environment is not set-up properly on init.</p></dd></dl><dl><dt class="spec value" id="val-print_env_warning_at_switch"><a href="#val-print_env_warning_at_switch" class="anchor"></a><code><span class="keyword">val </span>print_env_warning_at_switch : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>Print a warning if the environment is not set-up properly on switch.</p></dd></dl></section><section><header><h3 id="initialisation"><a href="#initialisation" class="anchor"></a>Initialisation</h3></header><dl><dt class="spec value" id="val-update_setup_interactive"><a href="#val-update_setup_interactive" class="anchor"></a><code><span class="keyword">val </span>update_setup_interactive : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.shell <span>&#45;&gt;</span> OpamTypes.filename <span>&#45;&gt;</span> bool</code></dt><dd><p>Update the global and user configuration by asking some questions.</p></dd></dl><dl><dt class="spec value" id="val-display_setup"><a href="#val-display_setup" class="anchor"></a><code><span class="keyword">val </span>display_setup : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.shell <span>&#45;&gt;</span> OpamTypes.filename <span>&#45;&gt;</span> unit</code></dt><dd><p>Display the global and user configuration for OPAM.</p></dd></dl><dl><dt class="spec value" id="val-update_setup"><a href="#val-update_setup" class="anchor"></a><code><span class="keyword">val </span>update_setup : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.user_config option <span>&#45;&gt;</span> OpamTypes.global_config option <span>&#45;&gt;</span> unit</code></dt><dd><p>Update the user configuration.</p></dd></dl></section><section><header><h3 id="filters"><a href="#filters" class="anchor"></a>Filters</h3></header><dl><dt class="spec value" id="val-global_variable_names"><a href="#val-global_variable_names" class="anchor"></a><code><span class="keyword">val </span>global_variable_names : (string<span class="keyword"> * </span>string) list</code></dt><dd><p>Lists of available variables and their description</p></dd></dl><dl><dt class="spec value" id="val-package_variable_names"><a href="#val-package_variable_names" class="anchor"></a><code><span class="keyword">val </span>package_variable_names : (string<span class="keyword"> * </span>string) list</code></dt><dt class="spec value" id="val-get_env_var"><a href="#val-get_env_var" class="anchor"></a><code><span class="keyword">val </span>get_env_var : OpamTypes.full_variable <span>&#45;&gt;</span> OpamTypes.variable_contents option</code></dt><dd><p>Check for user-defined variable overwrite.</p></dd></dl><dl><dt class="spec value" id="val-filter_env"><a href="#val-filter_env" class="anchor"></a><code><span class="keyword">val </span>filter_env : ?&#8288;opam:OpamFile.OPAM.t <span>&#45;&gt;</span> ?&#8288;local_variables:OpamTypes.variable_contents option OpamVariable.Map.t <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.full_variable <span>&#45;&gt;</span> OpamTypes.variable_contents option</code></dt><dd><p>The main Filter.env value to be used to resolve variables in filters</p></dd></dl></section><section><header><h3 id="helpers"><a href="#helpers" class="anchor"></a>Helpers</h3></header><dl><dt class="spec value" id="val-opam"><a href="#val-opam" class="anchor"></a><code><span class="keyword">val </span>opam : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Return the OPAM file for the given package</p></dd></dl><dl><dt class="spec value" id="val-opam_opt"><a href="#val-opam_opt" class="anchor"></a><code><span class="keyword">val </span>opam_opt : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamFile.OPAM.t option</code></dt><dd><p>Return the OPAM file for the given package</p></dd></dl><dl><dt class="spec value" id="val-url"><a href="#val-url" class="anchor"></a><code><span class="keyword">val </span>url : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamFile.URL.t option</code></dt><dd><p>Return the URL file for the given package</p></dd></dl><dl><dt class="spec value" id="val-descr"><a href="#val-descr" class="anchor"></a><code><span class="keyword">val </span>descr : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamFile.Descr.t</code></dt><dd><p>Return the Descr file for the given package</p></dd></dl><dl><dt class="spec value" id="val-descr_opt"><a href="#val-descr_opt" class="anchor"></a><code><span class="keyword">val </span>descr_opt : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamFile.Descr.t option</code></dt><dd><p>Return the Descr file for the given package</p></dd></dl><dl><dt class="spec value" id="val-files"><a href="#val-files" class="anchor"></a><code><span class="keyword">val </span>files : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.dirname option</code></dt><dd><p>Return the files/ directory overlay for the given package</p></dd></dl><dl><dt class="spec value" id="val-compiler_comp"><a href="#val-compiler_comp" class="anchor"></a><code><span class="keyword">val </span>compiler_comp : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> OpamFile.Comp.t</code></dt><dd><p>Return the compiler description</p></dd></dl></section><section><header><h3 id="repositories"><a href="#repositories" class="anchor"></a>Repositories</h3></header><dl><dt class="spec value" id="val-string_of_repositories"><a href="#val-string_of_repositories" class="anchor"></a><code><span class="keyword">val </span>string_of_repositories : OpamFile.Repo_config.t OpamTypes.repository_name_map <span>&#45;&gt;</span> string</code></dt><dd><p>Pretty print a map of repositories</p></dd></dl><dl><dt class="spec value" id="val-package_index"><a href="#val-package_index" class="anchor"></a><code><span class="keyword">val </span>package_index : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> (OpamTypes.repository_name<span class="keyword"> * </span>string option) OpamTypes.package_map</code></dt><dd><p>Builds a map which says in which repository the latest metadata for a given package are. The function respect the bustom priorities given by the order of <code>priorities</code>.</p></dd></dl><dl><dt class="spec value" id="val-compiler_index"><a href="#val-compiler_index" class="anchor"></a><code><span class="keyword">val </span>compiler_index : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> (OpamTypes.repository_name<span class="keyword"> * </span>string option) OpamTypes.compiler_map</code></dt><dd><p>Build a map which says in which repository the latest metadata for a given compiler is.</p></dd></dl><dl><dt class="spec value" id="val-sorted_repositories"><a href="#val-sorted_repositories" class="anchor"></a><code><span class="keyword">val </span>sorted_repositories : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.repository list</code></dt><dd><p>Sort repositories by priority.</p></dd></dl><dl><dt class="spec value" id="val-mem_repository"><a href="#val-mem_repository" class="anchor"></a><code><span class="keyword">val </span>mem_repository : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.repository_name <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a repository exists.</p></dd></dl><dl><dt class="spec value" id="val-find_repository"><a href="#val-find_repository" class="anchor"></a><code><span class="keyword">val </span>find_repository : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.repository_name <span>&#45;&gt;</span> OpamTypes.repository</code></dt><dd><p>Find a given repostiory. Exit the program if no such repository name exists.</p></dd></dl><dl><dt class="spec value" id="val-find_repository_opt"><a href="#val-find_repository_opt" class="anchor"></a><code><span class="keyword">val </span>find_repository_opt : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.repository_name <span>&#45;&gt;</span> OpamTypes.repository option</code></dt><dd><p>Find a given repostiory.</p></dd></dl><dl><dt class="spec value" id="val-redirect"><a href="#val-redirect" class="anchor"></a><code><span class="keyword">val </span>redirect : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.repository <span>&#45;&gt;</span> (OpamTypes.repository<span class="keyword"> * </span>OpamTypes.filter option) option</code></dt><dd><p>Check the redirections.</p></dd></dl></section><section><header><h3 id="compilers"><a href="#compilers" class="anchor"></a>Compilers</h3></header><dl><dt class="spec value" id="val-install_global_config"><a href="#val-install_global_config" class="anchor"></a><code><span class="keyword">val </span>install_global_config : OpamTypes.dirname <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> OpamFile.Dot_config.t</code></dt><dd><p>(Re-)install the configuration for a given root and switch</p></dd></dl><dl><dt class="spec value" id="val-install_compiler"><a href="#val-install_compiler" class="anchor"></a><code><span class="keyword">val </span>install_compiler : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> quiet:bool <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> unit</code></dt><dd><p>Install the given compiler</p></dd></dl><dl><dt class="spec value" id="val-update_switch_config"><a href="#val-update_switch_config" class="anchor"></a><code><span class="keyword">val </span>update_switch_config : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p>Write the right compiler switch in ~/.opam/config</p></dd></dl><dl><dt class="spec value" id="val-is_compiler_installed"><a href="#val-is_compiler_installed" class="anchor"></a><code><span class="keyword">val </span>is_compiler_installed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> bool</code></dt><dd><p>Is a compiler installed ?</p></dd></dl><dl><dt class="spec value" id="val-is_switch_installed"><a href="#val-is_switch_installed" class="anchor"></a><code><span class="keyword">val </span>is_switch_installed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> bool</code></dt><dd><p>Is a switch installed ?</p></dd></dl><dl><dt class="spec value" id="val-compiler_state"><a href="#val-compiler_state" class="anchor"></a><code><span class="keyword">val </span>compiler_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.checksums OpamTypes.compiler_map</code></dt><dd><p>Global compiler state</p></dd></dl><dl><dt class="spec value" id="val-compiler_repository_state"><a href="#val-compiler_repository_state" class="anchor"></a><code><span class="keyword">val </span>compiler_repository_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.checksums OpamTypes.compiler_map</code></dt><dd><p>Repository state</p></dd></dl><dl><dt class="spec value" id="val-repository_and_prefix_of_compiler"><a href="#val-repository_and_prefix_of_compiler" class="anchor"></a><code><span class="keyword">val </span>repository_and_prefix_of_compiler : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.compiler <span>&#45;&gt;</span> (OpamTypes.repository<span class="keyword"> * </span>string option) option</code></dt><dd><p>Return the active repository for a given compiler</p></dd></dl></section><section><header><h3 id="packages"><a href="#packages" class="anchor"></a>Packages</h3></header><dl><dt class="spec value" id="val-is_name_installed"><a href="#val-is_name_installed" class="anchor"></a><code><span class="keyword">val </span>is_name_installed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a package name is installed</p></dd></dl><dl><dt class="spec value" id="val-is_package_installed"><a href="#val-is_package_installed" class="anchor"></a><code><span class="keyword">val </span>is_package_installed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> bool</code></dt><dd><p>Return whether a package is installed</p></dd></dl><dl><dt class="spec value" id="val-find_installed_package_by_name"><a href="#val-find_installed_package_by_name" class="anchor"></a><code><span class="keyword">val </span>find_installed_package_by_name : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.package</code></dt><dd><p>Return the installed package with the right name</p></dd></dl><dl><dt class="spec value" id="val-find_packages_by_name"><a href="#val-find_packages_by_name" class="anchor"></a><code><span class="keyword">val </span>find_packages_by_name : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Return all the packages with the given name</p></dd></dl><dl><dt class="spec value" id="val-packages_of_atoms"><a href="#val-packages_of_atoms" class="anchor"></a><code><span class="keyword">val </span>packages_of_atoms : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.atom list <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Return all packages satisfying one of the given atoms from a state</p></dd></dl><dl><dt class="spec value" id="val-get_package"><a href="#val-get_package" class="anchor"></a><code><span class="keyword">val </span>get_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.package</code></dt><dd><p>Gets the current version of package <code>name</code>: pinned version, installed version, max available version or max existing version, tried in this order. Raises <code>Not_found</code> only if there is no package by this name.</p></dd></dl><dl><dt class="spec value" id="val-installed_map"><a href="#val-installed_map" class="anchor"></a><code><span class="keyword">val </span>installed_map : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.version OpamTypes.name_map</code></dt><dd><p>Return a map from package names to package installed version</p></dd></dl><dl><dt class="spec value" id="val-static_base_packages"><a href="#val-static_base_packages" class="anchor"></a><code><span class="keyword">val </span>static_base_packages : OpamTypes.name list</code></dt><dd><p>A few historical package names used as base for compilers (base-xxx)</p></dd></dl><dl><dt class="spec value" id="val-base_packages"><a href="#val-base_packages" class="anchor"></a><code><span class="keyword">val </span>base_packages : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Return the installed base packages of the current compiler</p></dd></dl><dl><dt class="spec value" id="val-base_package_names"><a href="#val-base_package_names" class="anchor"></a><code><span class="keyword">val </span>base_package_names : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name_set</code></dt><dd><p>Return the names of packages marked as &quot;base&quot; in the current compiler description</p></dd></dl><dl><dt class="spec value" id="val-all_installed"><a href="#val-all_installed" class="anchor"></a><code><span class="keyword">val </span>all_installed : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Return all the collection of installed packages, for all the available packages</p></dd></dl><dl><dt class="spec value" id="val-installed_versions"><a href="#val-installed_versions" class="anchor"></a><code><span class="keyword">val </span>installed_versions : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.switch list OpamTypes.package_map</code></dt><dd><p>Return a map containing the switch where a given package is installed.</p></dd></dl><dl><dt class="spec value" id="val-installed_timestamp"><a href="#val-installed_timestamp" class="anchor"></a><code><span class="keyword">val </span>installed_timestamp : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> float</code></dt><dd><p>Returns a timestamp when the given package was last installed</p></dd></dl><dl><dt class="spec value" id="val-unknown_package"><a href="#val-unknown_package" class="anchor"></a><code><span class="keyword">val </span>unknown_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.atom <span>&#45;&gt;</span> string</code></dt><dd><p>Returns a message about an atom that doesn't exist</p></dd></dl><dl><dt class="spec value" id="val-unavailable_reason"><a href="#val-unavailable_reason" class="anchor"></a><code><span class="keyword">val </span>unavailable_reason : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.atom <span>&#45;&gt;</span> string</code></dt><dd><p>Returns an explanation why a package is not currently available</p></dd></dl><dl><dt class="spec value" id="val-download_archive"><a href="#val-download_archive" class="anchor"></a><code><span class="keyword">val </span>download_archive : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.filename option OpamProcess.job</code></dt><dd><p>Download the OPAM-package archive ($name.$version+opam.tar.gz)</p></dd></dl><dl><dt class="spec value" id="val-download_upstream"><a href="#val-download_upstream" class="anchor"></a><code><span class="keyword">val </span>download_upstream : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> OpamTypes.generic_file OpamTypes.download option OpamProcess.job</code></dt><dd><p>Download the upstream archive, add the eventual additional files and return the directory.</p></dd></dl><dl><dt class="spec value" id="val-package_state"><a href="#val-package_state" class="anchor"></a><code><span class="keyword">val </span>package_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.checksums OpamTypes.package_map</code></dt><dd><p>Global package state.</p></dd></dl><dl><dt class="spec value" id="val-package_partial_state"><a href="#val-package_partial_state" class="anchor"></a><code><span class="keyword">val </span>package_partial_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> archive:bool <span>&#45;&gt;</span> bool<span class="keyword"> * </span>OpamTypes.checksums</code></dt><dd><p>Global &amp; partial package state.</p></dd></dl><dl><dt class="spec value" id="val-package_repository_state"><a href="#val-package_repository_state" class="anchor"></a><code><span class="keyword">val </span>package_repository_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.checksums OpamTypes.package_map</code></dt><dd><p>Repository state</p></dd></dl><dl><dt class="spec value" id="val-package_repository_partial_state"><a href="#val-package_repository_partial_state" class="anchor"></a><code><span class="keyword">val </span>package_repository_partial_state : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> archive:bool <span>&#45;&gt;</span> bool<span class="keyword"> * </span>OpamTypes.checksums</code></dt><dd><p>Repository &amp; partial package state.</p></dd></dl><dl><dt class="spec value" id="val-repository_of_package"><a href="#val-repository_of_package" class="anchor"></a><code><span class="keyword">val </span>repository_of_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.repository option</code></dt><dd><p>Get the active repository for a given package</p></dd></dl><dl><dt class="spec value" id="val-repository_and_prefix_of_package"><a href="#val-repository_and_prefix_of_package" class="anchor"></a><code><span class="keyword">val </span>repository_and_prefix_of_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> (OpamTypes.repository<span class="keyword"> * </span>string option) option</code></dt><dd><p>Get the active repository for a given package</p></dd></dl><dl><dt class="spec value" id="val-add_to_reinstall"><a href="#val-add_to_reinstall" class="anchor"></a><code><span class="keyword">val </span>add_to_reinstall : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> all:bool <span>&#45;&gt;</span> OpamTypes.package_set <span>&#45;&gt;</span> unit</code></dt><dd><p>Add the given packages to the set of package to reinstall. If <code>all</code> is set, this is done for ALL the switches (useful when a package change upstream for instance). If not, only the reinstall state of the current switch is changed.</p></dd></dl><dl><dt class="spec value" id="val-copy_files"><a href="#val-copy_files" class="anchor"></a><code><span class="keyword">val </span>copy_files : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> unit</code></dt><dd><p>Return the files for a given package</p></dd></dl><dl><dt class="spec value" id="val-install_metadata"><a href="#val-install_metadata" class="anchor"></a><code><span class="keyword">val </span>install_metadata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> unit</code></dt><dd><p>Copy the repository metadata into the global state.</p></dd></dl><dl><dt class="spec value" id="val-remove_metadata"><a href="#val-remove_metadata" class="anchor"></a><code><span class="keyword">val </span>remove_metadata : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set <span>&#45;&gt;</span> unit</code></dt><dd><p>Remove some metadata from the global state if they are not used anymore.</p></dd></dl></section><section><header><h3 id="development-packages"><a href="#development-packages" class="anchor"></a>Development packages</h3></header><dl><dt class="spec value" id="val-dev_packages"><a href="#val-dev_packages" class="anchor"></a><code><span class="keyword">val </span>dev_packages : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Get all the development packages. This include the one locally pinned (for the current switch) and the global dev packages.</p></dd></dl><dl><dt class="spec value" id="val-update_dev_packages"><a href="#val-update_dev_packages" class="anchor"></a><code><span class="keyword">val </span>update_dev_packages : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p><code>update_dev_packages t</code> checks for upstream changes for packages first in the switch cache and then in the global cache. Return the packages whose contents have changed upstream. Side-effect: update the reinstall files.</p></dd></dl><dl><dt class="spec value" id="val-update_dev_package"><a href="#val-update_dev_package" class="anchor"></a><code><span class="keyword">val </span>update_dev_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> bool OpamProcess.job</code></dt><dd><p>Updates a dev or pinned package from its upstream; returns true if changed, false otherwise</p></dd></dl><dl><dt class="spec value" id="val-update_pinned_packages"><a href="#val-update_pinned_packages" class="anchor"></a><code><span class="keyword">val </span>update_pinned_packages : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name_set <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>A subset of update_dev_packages that only takes packages names and only works on pinned packages. Also updates reinstall files</p></dd></dl><dl><dt class="spec value" id="val-update_pinned_package"><a href="#val-update_pinned_package" class="anchor"></a><code><span class="keyword">val </span>update_pinned_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> ?&#8288;fixed_version:OpamTypes.version <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> bool OpamProcess.job</code></dt><dd><p>Updates a dev pinned package from its upstream; returns true if changed, false otherwise</p></dd></dl><dl><dt class="spec value" id="val-is_dev_package"><a href="#val-is_dev_package" class="anchor"></a><code><span class="keyword">val </span>is_dev_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package <span>&#45;&gt;</span> bool</code></dt><dd><p>Check whether a package is a development package</p></dd></dl><dl><dt class="spec value" id="val-find_opam_file_in_source"><a href="#val-find_opam_file_in_source" class="anchor"></a><code><span class="keyword">val </span>find_opam_file_in_source : OpamTypes.name <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> OpamTypes.filename option</code></dt><dd><p>Looks up an 'opam' file for the given named package in a source directory</p></dd></dl></section><section><header><h3 id="configuration-files"><a href="#configuration-files" class="anchor"></a>Configuration files</h3></header><dl><dt class="spec value" id="val-global_config"><a href="#val-global_config" class="anchor"></a><code><span class="keyword">val </span>global_config : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamFile.Dot_config.t</code></dt><dd><p>Return the global .config file for the current switch</p></dd></dl><dl><dt class="spec value" id="val-dot_config"><a href="#val-dot_config" class="anchor"></a><code><span class="keyword">val </span>dot_config : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamFile.Dot_config.t</code></dt><dd><p>Return the .config file for the given package</p></dd></dl></section><section><header><h3 id="locks"><a href="#locks" class="anchor"></a>Locks</h3></header><dl><dt class="spec value" id="val-check"><a href="#val-check" class="anchor"></a><code><span class="keyword">val </span>check : OpamTypes.lock <span>&#45;&gt;</span> unit</code></dt><dd><p>Apply a function while taking the right locks</p></dd></dl></section><section><header><h3 id="pinned-packages"><a href="#pinned-packages" class="anchor"></a>Pinned packages</h3></header><dl><dt class="spec value" id="val-is_pinned"><a href="#val-is_pinned" class="anchor"></a><code><span class="keyword">val </span>is_pinned : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> bool</code></dt><dd><p>Is the package name pinned ?</p></dd></dl><dl><dt class="spec value" id="val-is_locally_pinned"><a href="#val-is_locally_pinned" class="anchor"></a><code><span class="keyword">val </span>is_locally_pinned : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> bool</code></dt><dd><p>Is the package locally pinned ? (ie. not a version pinning)</p></dd></dl><dl><dt class="spec value" id="val-pinned"><a href="#val-pinned" class="anchor"></a><code><span class="keyword">val </span>pinned : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.package</code></dt><dd><p>Returns the versionned pinned package. </p><dl><dt>raises Not_found</dt><dd><p>if not pinned</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-pinned_opt"><a href="#val-pinned_opt" class="anchor"></a><code><span class="keyword">val </span>pinned_opt : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamTypes.package option</code></dt><dd><p>Returns the versionned pinned package, or <code>None</code> if not pinned</p></dd></dl><dl><dt class="spec value" id="val-pinned_packages"><a href="#val-pinned_packages" class="anchor"></a><code><span class="keyword">val </span>pinned_packages : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>The set of pinned packages in the state (warning: costly)</p></dd></dl><dl><dt class="spec value" id="val-url_of_locally_pinned_package"><a href="#val-url_of_locally_pinned_package" class="anchor"></a><code><span class="keyword">val </span>url_of_locally_pinned_package : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> OpamFile.URL.t</code></dt><dd><p>Return the URL file associated with a locally pinned package.</p></dd></dl></section><section><header><h3 id="overlays"><a href="#overlays" class="anchor"></a>Overlays</h3></header><dl><dt class="spec value" id="val-add_pinned_overlay"><a href="#val-add_pinned_overlay" class="anchor"></a><code><span class="keyword">val </span>add_pinned_overlay : ?&#8288;template:bool <span>&#45;&gt;</span> ?&#8288;version:OpamTypes.version <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> unit</code></dt><dd><p>Add overlay files for a pinned package. If no definition is found use a minimal OPAM file unless <code>template</code> is set to <code>true</code>.</p></dd></dl><dl><dt class="spec value" id="val-remove_overlay"><a href="#val-remove_overlay" class="anchor"></a><code><span class="keyword">val </span>remove_overlay : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> OpamTypes.name <span>&#45;&gt;</span> unit</code></dt><dd><p>Remove all overlay files</p></dd></dl></section><section><header><h3 id="system-compilers"><a href="#system-compilers" class="anchor"></a>System compilers</h3></header><dl><dt class="spec value" id="val-create_system_compiler_description"><a href="#val-create_system_compiler_description" class="anchor"></a><code><span class="keyword">val </span>create_system_compiler_description : OpamTypes.dirname <span>&#45;&gt;</span> unit</code></dt><dd><p>Create <i>$opam/compilers/system.com</i>. Takes the global root as argument.</p></dd></dl><dl><dt class="spec value" id="val-jobs"><a href="#val-jobs" class="anchor"></a><code><span class="keyword">val </span>jobs : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><h3 id="jobs"><a href="#jobs" class="anchor"></a>Jobs</h3></dd></dl><dl><dt class="spec value" id="val-dl_jobs"><a href="#val-dl_jobs" class="anchor"></a><code><span class="keyword">val </span>dl_jobs : <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> int</code></dt><dd><h3 id="download-jobs"><a href="#download-jobs" class="anchor"></a>Download Jobs</h3></dd></dl><aside><p>/ *</p></aside><dl><dt class="spec value" id="val-switch_reinstall_hook"><a href="#val-switch_reinstall_hook" class="anchor"></a><code><span class="keyword">val </span>switch_reinstall_hook : (OpamTypes.switch <span>&#45;&gt;</span> unit) Pervasives.ref</code></dt><dd><p>Switch reinstall hook.</p></dd></dl><dl><dt class="spec value" id="val-fix_descriptions_hook"><a href="#val-fix_descriptions_hook" class="anchor"></a><code><span class="keyword">val </span>fix_descriptions_hook : (?&#8288;save_cache:bool <span>&#45;&gt;</span> ?&#8288;verbose:bool <span>&#45;&gt;</span> <a href="index.html#type-state">state</a> <span>&#45;&gt;</span> unit) Pervasives.ref</code></dt><dd><p>Update hook</p></dd></dl></section></div></body></html>