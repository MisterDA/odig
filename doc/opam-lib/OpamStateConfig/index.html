<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamStateConfig (opam-lib.OpamStateConfig)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-lib</a> &#x00BB; OpamStateConfig</nav><h1>Module <code>OpamStateConfig</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-t.root_dir" class="anchored"><td class="def field"><a href="#type-t.root_dir" class="anchor"></a><code>root_dir : OpamFilename.Dir.t;</code></td></tr><tr id="type-t.current_switch" class="anchored"><td class="def field"><a href="#type-t.current_switch" class="anchor"></a><code>current_switch : OpamSwitch.t;</code></td></tr><tr id="type-t.switch_from" class="anchored"><td class="def field"><a href="#type-t.switch_from" class="anchor"></a><code>switch_from : [ `Env<span class="keyword"> | </span>`Command_line<span class="keyword"> | </span>`Default ];</code></td></tr><tr id="type-t.jobs" class="anchored"><td class="def field"><a href="#type-t.jobs" class="anchor"></a><code>jobs : int Lazy.t;</code></td></tr><tr id="type-t.dl_jobs" class="anchored"><td class="def field"><a href="#type-t.dl_jobs" class="anchor"></a><code>dl_jobs : int;</code></td></tr><tr id="type-t.external_tags" class="anchored"><td class="def field"><a href="#type-t.external_tags" class="anchor"></a><code>external_tags : string list;</code></td></tr><tr id="type-t.keep_build_dir" class="anchored"><td class="def field"><a href="#type-t.keep_build_dir" class="anchor"></a><code>keep_build_dir : bool;</code></td></tr><tr id="type-t.no_base_packages" class="anchored"><td class="def field"><a href="#type-t.no_base_packages" class="anchor"></a><code>no_base_packages : bool;</code></td></tr><tr id="type-t.build_test" class="anchored"><td class="def field"><a href="#type-t.build_test" class="anchor"></a><code>build_test : bool;</code></td></tr><tr id="type-t.build_doc" class="anchored"><td class="def field"><a href="#type-t.build_doc" class="anchor"></a><code>build_doc : bool;</code></td></tr><tr id="type-t.show" class="anchored"><td class="def field"><a href="#type-t.show" class="anchor"></a><code>show : bool;</code></td></tr><tr id="type-t.dryrun" class="anchored"><td class="def field"><a href="#type-t.dryrun" class="anchor"></a><code>dryrun : bool;</code></td></tr><tr id="type-t.fake" class="anchored"><td class="def field"><a href="#type-t.fake" class="anchor"></a><code>fake : bool;</code></td></tr><tr id="type-t.makecmd" class="anchored"><td class="def field"><a href="#type-t.makecmd" class="anchor"></a><code>makecmd : string Lazy.t;</code></td></tr><tr id="type-t.json_out" class="anchored"><td class="def field"><a href="#type-t.json_out" class="anchor"></a><code>json_out : string option;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-options_fun"><a href="#type-options_fun" class="anchor"></a><code><span class="keyword">type </span>'a options_fun</code><code><span class="keyword"> = </span>?&#8288;root_dir:OpamFilename.Dir.t <span>&#45;&gt;</span> ?&#8288;current_switch:OpamSwitch.t <span>&#45;&gt;</span> ?&#8288;switch_from:[ `Env<span class="keyword"> | </span>`Command_line<span class="keyword"> | </span>`Default ] <span>&#45;&gt;</span> ?&#8288;jobs:int Lazy.t <span>&#45;&gt;</span> ?&#8288;dl_jobs:int <span>&#45;&gt;</span> ?&#8288;external_tags:string list <span>&#45;&gt;</span> ?&#8288;keep_build_dir:bool <span>&#45;&gt;</span> ?&#8288;no_base_packages:bool <span>&#45;&gt;</span> ?&#8288;build_test:bool <span>&#45;&gt;</span> ?&#8288;build_doc:bool <span>&#45;&gt;</span> ?&#8288;show:bool <span>&#45;&gt;</span> ?&#8288;dryrun:bool <span>&#45;&gt;</span> ?&#8288;fake:bool <span>&#45;&gt;</span> ?&#8288;makecmd:string Lazy.t <span>&#45;&gt;</span> ?&#8288;json_out:string option <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl><dl><dt class="spec value" id="val-default"><a href="#val-default" class="anchor"></a><code><span class="keyword">val </span>default : <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val </span>set : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-setk"><a href="#val-setk" class="anchor"></a><code><span class="keyword">val </span>setk : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-r"><a href="#val-r" class="anchor"></a><code><span class="keyword">val </span>r : <a href="index.html#type-t">t</a> Pervasives.ref</code></dt><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : ?&#8288;noop:<span class="type-var">_</span> <span>&#45;&gt;</span> unit <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val </span>init : ?&#8288;noop:<span class="type-var">_</span> <span>&#45;&gt;</span> unit <a href="index.html#type-options_fun">options_fun</a></code></dt><dd><p>Sets the options, reading the environment to get default values when unspecified</p></dd></dl><dl><dt class="spec value" id="val-opamroot"><a href="#val-opamroot" class="anchor"></a><code><span class="keyword">val </span>opamroot : ?&#8288;root_dir:OpamTypes.dirname <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> OpamTypes.dirname</code></dt><dd><p>Get the initial opam root value (from default, env or optional argument). This allows to get it before doing the init, which is useful to get the configuration file used to fill some options to init()</p></dd></dl><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val </span>load : OpamTypes.dirname <span>&#45;&gt;</span> OpamFile.Config.t option</code></dt><dd><p>Loads the global configuration file, protecting against concurrent writes</p></dd></dl><dl><dt class="spec value" id="val-write"><a href="#val-write" class="anchor"></a><code><span class="keyword">val </span>write : OpamTypes.dirname <span>&#45;&gt;</span> OpamFile.Config.t <span>&#45;&gt;</span> unit</code></dt><dd><p>Writes the global configuration file, protecting against concurrent reads</p></dd></dl><dl><dt class="spec value" id="val-filter_deps"><a href="#val-filter_deps" class="anchor"></a><code><span class="keyword">val </span>filter_deps : ?&#8288;dev:bool <span>&#45;&gt;</span> OpamTypes.ext_formula <span>&#45;&gt;</span> OpamTypes.formula</code></dt><dd><p>Filters flagged dependencies in an ext_formula using the currently set options (doc, test). Build dependencies are included</p></dd></dl><dl><dt class="spec value" id="val-load_defaults"><a href="#val-load_defaults" class="anchor"></a><code><span class="keyword">val </span>load_defaults : OpamFilename.Dir.t <span>&#45;&gt;</span> bool</code></dt><dd><p>Loads the config file from the OPAM root and updates default values for all related OpamXxxConfig modules. Doesn't read the env yet, the <code>init</code> functions should still be called afterwards. OpamFormat should be initialised beforehand, as it may impact the config file loading.</p><p>Returns true if a config file was found and could be read, false otherwise</p></dd></dl></div></body></html>