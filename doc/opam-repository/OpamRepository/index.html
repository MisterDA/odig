<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamRepository (opam-repository.OpamRepository)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-repository</a> &#x00BB; OpamRepository</nav><h1>Module <code>OpamRepository</code></h1><p>Operations on repositories (update, fetch...) based on the different backends implemented in separate modules</p><nav class="toc"><ul><li><a href="#repository-backends">Repository backends</a></li></ul></nav></header><dl><dt class="spec value" id="val-packages"><a href="#val-packages" class="anchor"></a><code><span class="keyword">val </span>packages : OpamTypes.repository <span>&#45;&gt;</span> OpamTypes.package_set</code></dt><dd><p>Get the list of packages</p></dd></dl><dl><dt class="spec value" id="val-packages_with_prefixes"><a href="#val-packages_with_prefixes" class="anchor"></a><code><span class="keyword">val </span>packages_with_prefixes : OpamTypes.repository <span>&#45;&gt;</span> string option OpamTypes.package_map</code></dt><dd><p>Get the list of packages (and their possible prefix)</p></dd></dl><section><header><h3 id="repository-backends"><a href="#repository-backends" class="anchor"></a>Repository backends</h3></header><dl><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val </span>init : OpamTypes.dirname <span>&#45;&gt;</span> OpamTypes.repository_name <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p>Initialize <i>$opam/repo/$repo</i></p></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : OpamTypes.repository <span>&#45;&gt;</span> unit OpamProcess.job</code></dt><dd><p>Update <i>$opam/repo/$repo</i>. Raises <code>Failure</code> in case the update couldn't be achieved.</p></dd></dl><dl><dt class="spec value" id="val-pull_tree"><a href="#val-pull_tree" class="anchor"></a><code><span class="keyword">val </span>pull_tree : string <span>&#45;&gt;</span> ?&#8288;cache_dir:OpamTypes.dirname <span>&#45;&gt;</span> ?&#8288;cache_urls:OpamTypes.url list <span>&#45;&gt;</span> ?&#8288;working_dir:bool <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> OpamHash.t list <span>&#45;&gt;</span> OpamTypes.url list <span>&#45;&gt;</span> unit OpamTypes.download OpamProcess.job</code></dt><dd><p>Fetch an URL and put the resulting tree into the supplied directory. The URL must either point to a tree (VCS, rsync) or to a known archive type. In case of an archive, the cache is used and supplied the hashes verified, then the archive uncompressed. In case of a version-controlled URL, it's checked out, or synchronised directly if local and <code>working_dir</code> was set.</p></dd></dl><dl><dt class="spec value" id="val-pull_file"><a href="#val-pull_file" class="anchor"></a><code><span class="keyword">val </span>pull_file : string <span>&#45;&gt;</span> ?&#8288;cache_dir:OpamTypes.dirname <span>&#45;&gt;</span> ?&#8288;cache_urls:OpamTypes.url list <span>&#45;&gt;</span> ?&#8288;silent_hits:bool <span>&#45;&gt;</span> OpamTypes.filename <span>&#45;&gt;</span> OpamHash.t list <span>&#45;&gt;</span> OpamTypes.url list <span>&#45;&gt;</span> unit OpamTypes.download OpamProcess.job</code></dt><dd><p>Same as <code>pull_tree</code>, but for fetching a single file.</p></dd></dl><dl><dt class="spec value" id="val-pull_file_to_cache"><a href="#val-pull_file_to_cache" class="anchor"></a><code><span class="keyword">val </span>pull_file_to_cache : string <span>&#45;&gt;</span> cache_dir:OpamTypes.dirname <span>&#45;&gt;</span> ?&#8288;cache_urls:OpamTypes.url list <span>&#45;&gt;</span> OpamHash.t list <span>&#45;&gt;</span> OpamTypes.url list <span>&#45;&gt;</span> unit OpamTypes.download OpamProcess.job</code></dt><dd><p>Same as <code>pull_file</code>, but without a destination file: just ensures the file is present in the cache.</p></dd></dl><dl><dt class="spec value" id="val-cache_file"><a href="#val-cache_file" class="anchor"></a><code><span class="keyword">val </span>cache_file : OpamTypes.dirname <span>&#45;&gt;</span> OpamHash.t <span>&#45;&gt;</span> OpamTypes.filename</code></dt><dd><p>The file where the file with the given hash is stored under cache at given dirname.</p></dd></dl><dl><dt class="spec value" id="val-revision"><a href="#val-revision" class="anchor"></a><code><span class="keyword">val </span>revision : OpamTypes.dirname <span>&#45;&gt;</span> OpamTypes.url <span>&#45;&gt;</span> OpamTypes.version option OpamProcess.job</code></dt><dd><p>Get the optional revision associated to a backend (git hash, etc.).</p></dd></dl><dl><dt class="spec value" id="val-current_branch"><a href="#val-current_branch" class="anchor"></a><code><span class="keyword">val </span>current_branch : OpamTypes.url <span>&#45;&gt;</span> string option OpamProcess.job</code></dt><dd><p>Get the version-control branch for that url. Only applicable for local, version controlled URLs. Returns <code>None</code> in other cases.</p></dd></dl><dl><dt class="spec value" id="val-is_dirty"><a href="#val-is_dirty" class="anchor"></a><code><span class="keyword">val </span>is_dirty : OpamTypes.url <span>&#45;&gt;</span> bool OpamProcess.job</code></dt><dd><p>Returns true if the url points to a local, version-controlled directory that has uncommitted changes</p></dd></dl><dl><dt class="spec value" id="val-find_backend"><a href="#val-find_backend" class="anchor"></a><code><span class="keyword">val </span>find_backend : OpamTypes.repository <span>&#45;&gt;</span> (<span class="keyword">module </span>OpamRepositoryBackend.S)</code></dt><dd><p>Find a backend</p></dd></dl><dl><dt class="spec value" id="val-find_backend_by_kind"><a href="#val-find_backend_by_kind" class="anchor"></a><code><span class="keyword">val </span>find_backend_by_kind : OpamUrl.backend <span>&#45;&gt;</span> (<span class="keyword">module </span>OpamRepositoryBackend.S)</code></dt></dl></section></div></body></html>