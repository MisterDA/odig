<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamFileTools (opam-state.OpamFileTools)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-state</a> &#x00BB; OpamFileTools</nav><h1>Module <code>OpamFileTools</code></h1><p>Tools for manipulating and checking package definition (&quot;opam&quot;) files</p></header><dl><dt class="spec value" id="val-template"><a href="#val-template" class="anchor"></a><code><span class="keyword">val </span>template : OpamTypes.package <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Create an OPAM package template filled with common options</p></dd></dl><dl><dt class="spec value" id="val-lint"><a href="#val-lint" class="anchor"></a><code><span class="keyword">val </span>lint : ?&#8288;check_extra_files:(OpamTypes.basename<span class="keyword"> * </span>(OpamHash.t <span>&#45;&gt;</span> bool)) list <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> (int<span class="keyword"> * </span>[ `Warning<span class="keyword"> | </span>`Error ]<span class="keyword"> * </span>string) list</code></dt><dd><p>Runs several sanity checks on the opam file; returns a list of warnings. <code>`Error</code> level should be considered unfit for publication, while <code>`Warning</code> are advisory but may be accepted. The int is an identifier for this specific warning/error. If <code>check_extra_files</code> is unspecified, warning 53 won't be checked.</p></dd></dl><dl><dt class="spec value" id="val-lint_file"><a href="#val-lint_file" class="anchor"></a><code><span class="keyword">val </span>lint_file : ?&#8288;check_extra_files:(OpamTypes.basename<span class="keyword"> * </span>(OpamHash.t <span>&#45;&gt;</span> bool)) list <span>&#45;&gt;</span> OpamFile.OPAM.t OpamFile.typed_file <span>&#45;&gt;</span> (int<span class="keyword"> * </span>[ `Warning<span class="keyword"> | </span>`Error ]<span class="keyword"> * </span>string) list<span class="keyword"> * </span>OpamFile.OPAM.t option</code></dt><dd><p>Same as <code>lint</code>, but operates on a file, which allows catching parse errors too. You can specify an expected name and version. <code>check_extra_files</code> defaults to a function that will look for a <code>files/</code> directory besides <code>filename</code></p></dd></dl><dl><dt class="spec value" id="val-lint_channel"><a href="#val-lint_channel" class="anchor"></a><code><span class="keyword">val </span>lint_channel : ?&#8288;check_extra_files:(OpamTypes.basename<span class="keyword"> * </span>(OpamHash.t <span>&#45;&gt;</span> bool)) list <span>&#45;&gt;</span> OpamFile.OPAM.t OpamFile.typed_file <span>&#45;&gt;</span> Pervasives.in_channel <span>&#45;&gt;</span> (int<span class="keyword"> * </span>[ `Warning<span class="keyword"> | </span>`Error ]<span class="keyword"> * </span>string) list<span class="keyword"> * </span>OpamFile.OPAM.t option</code></dt><dd><p>Same as <code>lint_file</code>, but taking input from a channel. <code>check_extra_files</code> defaults to a function that will look for a <code>files/</code> directory besides <code>filename</code></p></dd></dl><dl><dt class="spec value" id="val-lint_string"><a href="#val-lint_string" class="anchor"></a><code><span class="keyword">val </span>lint_string : ?&#8288;check_extra_files:(OpamTypes.basename<span class="keyword"> * </span>(OpamHash.t <span>&#45;&gt;</span> bool)) list <span>&#45;&gt;</span> OpamFile.OPAM.t OpamFile.typed_file <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (int<span class="keyword"> * </span>[ `Warning<span class="keyword"> | </span>`Error ]<span class="keyword"> * </span>string) list<span class="keyword"> * </span>OpamFile.OPAM.t option</code></dt><dd><p>Like <code>lint_file</code>, but takes the file contents as a string. <code>check_extra_files</code> defaults to a function that will look for a <code>files/</code> directory besides <code>filename</code></p></dd></dl><dl><dt class="spec value" id="val-warns_to_string"><a href="#val-warns_to_string" class="anchor"></a><code><span class="keyword">val </span>warns_to_string : (int<span class="keyword"> * </span>[ `Warning<span class="keyword"> | </span>`Error ]<span class="keyword"> * </span>string) list <span>&#45;&gt;</span> string</code></dt><dd><p>Utility function to print validation results</p></dd></dl><dl><dt class="spec value" id="val-read_opam"><a href="#val-read_opam" class="anchor"></a><code><span class="keyword">val </span>read_opam : OpamTypes.dirname <span>&#45;&gt;</span> OpamFile.OPAM.t option</code></dt><dd><p>Read the opam metadata from a given directory (opam file, with possible overrides from url and descr files). Also includes the names and hashes of files below files/</p></dd></dl><dl><dt class="spec value" id="val-add_aux_files"><a href="#val-add_aux_files" class="anchor"></a><code><span class="keyword">val </span>add_aux_files : ?&#8288;dir:OpamTypes.dirname <span>&#45;&gt;</span> files_subdir_hashes:bool <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Adds data from 'url' and 'descr' files found in the specified dir or the opam file's metadata dir, if not already present in the opam file. if <code>files_subdir_hashes</code> is <code>true</code>, also adds the names and hashes of files found below 'files/'</p></dd></dl><dl><dt class="spec value" id="val-map_all_variables"><a href="#val-map_all_variables" class="anchor"></a><code><span class="keyword">val </span>map_all_variables : (OpamTypes.full_variable <span>&#45;&gt;</span> OpamTypes.full_variable) <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><h3 id="tools-to-manipulate-the-opamfile.opam.t-contents"><a href="#tools-to-manipulate-the-opamfile.opam.t-contents" class="anchor"></a>Tools to manipulate the <code>OpamFile.OPAM.t</code> contents</h3></dd></dl><dl><dt class="spec value" id="val-map_all_filters"><a href="#val-map_all_filters" class="anchor"></a><code><span class="keyword">val </span>map_all_filters : (OpamTypes.filter <span>&#45;&gt;</span> OpamTypes.filter) <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt></dl></div></body></html>