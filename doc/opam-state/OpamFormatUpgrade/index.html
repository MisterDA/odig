<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamFormatUpgrade (opam-state.OpamFormatUpgrade)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-state</a> &#x00BB; OpamFormatUpgrade</nav><h1>Module <code>OpamFormatUpgrade</code></h1><p>This modules handles the conversion from older repository and package versions to the current one</p></header><dl><dt class="spec exception" id="exception-Upgrade_done"><a href="#exception-Upgrade_done" class="anchor"></a><code><span class="keyword">exception </span></code><code><span class="exception">Upgrade_done</span><span class="keyword"> of </span>OpamFile.Config.t</code></dt><dd><p>Raised when the opam root has been updated to a newer format, and further action (opam init/update) is needed.</p></dd></dl><dl><dt class="spec value" id="val-latest_version"><a href="#val-latest_version" class="anchor"></a><code><span class="keyword">val </span>latest_version : OpamVersion.t</code></dt><dd><p>The latest version of the opam root format, that normal operation of this instance of opam requires</p></dd></dl><dl><dt class="spec value" id="val-as_necessary"><a href="#val-as_necessary" class="anchor"></a><code><span class="keyword">val </span>as_necessary : OpamSystem.lock <span>&#45;&gt;</span> OpamTypes.dirname <span>&#45;&gt;</span> OpamFile.Config.t <span>&#45;&gt;</span> unit</code></dt><dd><p>Runs the upgrade from its current format to the latest version for the opam root at the given directory. A global write lock must be supplied. If an upgrade has been done, raises <code>Upgrade_done updated_config</code>.</p></dd></dl><dl><dt class="spec value" id="val-opam_file_from_1_2_to_2_0"><a href="#val-opam_file_from_1_2_to_2_0" class="anchor"></a><code><span class="keyword">val </span>opam_file_from_1_2_to_2_0 : ?&#8288;filename:OpamFile.OPAM.t OpamFile.t <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Converts the opam file format, including rewriting availabillity conditions based on OCaml-related variables into dependencies. The filename is used to report errors</p></dd></dl><dl><dt class="spec value" id="val-opam_file"><a href="#val-opam_file" class="anchor"></a><code><span class="keyword">val </span>opam_file : ?&#8288;quiet:bool <span>&#45;&gt;</span> ?&#8288;filename:OpamFile.OPAM.t OpamFile.t <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Runs the opam file format from the file's format to current. Supplying <code>filename</code> enables additional notification messages</p></dd></dl><dl><dt class="spec value" id="val-comp_file"><a href="#val-comp_file" class="anchor"></a><code><span class="keyword">val </span>comp_file : ?&#8288;package:OpamTypes.package <span>&#45;&gt;</span> ?&#8288;descr:OpamFile.Descr.t <span>&#45;&gt;</span> OpamFile.Comp.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Convert the comp file to an opam one, using <code>OpamFile.Comp.to_package</code> and applying filter rewriting</p></dd></dl><dl><dt class="spec value" id="val-opam_file_with_aux"><a href="#val-opam_file_with_aux" class="anchor"></a><code><span class="keyword">val </span>opam_file_with_aux : ?&#8288;quiet:bool <span>&#45;&gt;</span> ?&#8288;dir:OpamTypes.dirname <span>&#45;&gt;</span> files:bool <span>&#45;&gt;</span> ?&#8288;filename:OpamFile.OPAM.t OpamFile.t <span>&#45;&gt;</span> OpamFile.OPAM.t <span>&#45;&gt;</span> OpamFile.OPAM.t</code></dt><dd><p>Runs the opam file format from the file's format to current, and adds data from 'url' and 'descr' files found in the specified dir or the opam file's metadata dir, if not already present in the opam file. If <code>files</code> is <code>true</code>, also adds the names and hashes of files found below 'files/'. Supplying <code>filename</code> enables additional notification messages</p></dd></dl></div></body></html>