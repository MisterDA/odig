<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>OpamStateConfig (opam-state.OpamStateConfig)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">opam-state</a> &#x00BB; OpamStateConfig</nav><h1>Module <code>OpamStateConfig</code></h1><p>Configuration options for the state lib (record, global reference, setter, initialisation)</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span><span class="keyword">private </span></code><code>{</code><table class="record"><tr id="type-t.root_dir" class="anchored"><td class="def field"><a href="#type-t.root_dir" class="anchor"></a><code>root_dir : OpamFilename.Dir.t;</code></td></tr><tr id="type-t.current_switch" class="anchored"><td class="def field"><a href="#type-t.current_switch" class="anchor"></a><code>current_switch : OpamSwitch.t option;</code></td></tr><tr id="type-t.switch_from" class="anchored"><td class="def field"><a href="#type-t.switch_from" class="anchor"></a><code>switch_from : [ `Env<span class="keyword"> | </span>`Command_line<span class="keyword"> | </span>`Default ];</code></td></tr><tr id="type-t.jobs" class="anchored"><td class="def field"><a href="#type-t.jobs" class="anchor"></a><code>jobs : int Lazy.t;</code></td></tr><tr id="type-t.dl_jobs" class="anchored"><td class="def field"><a href="#type-t.dl_jobs" class="anchor"></a><code>dl_jobs : int;</code></td></tr><tr id="type-t.build_test" class="anchored"><td class="def field"><a href="#type-t.build_test" class="anchor"></a><code>build_test : bool;</code></td></tr><tr id="type-t.build_doc" class="anchored"><td class="def field"><a href="#type-t.build_doc" class="anchor"></a><code>build_doc : bool;</code></td></tr><tr id="type-t.dryrun" class="anchored"><td class="def field"><a href="#type-t.dryrun" class="anchor"></a><code>dryrun : bool;</code></td></tr><tr id="type-t.makecmd" class="anchored"><td class="def field"><a href="#type-t.makecmd" class="anchor"></a><code>makecmd : string Lazy.t;</code></td></tr><tr id="type-t.ignore_constraints_on" class="anchored"><td class="def field"><a href="#type-t.ignore_constraints_on" class="anchor"></a><code>ignore_constraints_on : OpamTypes.name_set;</code></td></tr><tr id="type-t.unlock_base" class="anchored"><td class="def field"><a href="#type-t.unlock_base" class="anchor"></a><code>unlock_base : bool;</code></td></tr><tr id="type-t.no_env_notice" class="anchored"><td class="def field"><a href="#type-t.no_env_notice" class="anchor"></a><code>no_env_notice : bool;</code></td></tr><tr id="type-t.locked" class="anchored"><td class="def field"><a href="#type-t.locked" class="anchor"></a><code>locked : string option;</code></td></tr></table><code>}</code></dt><dt class="spec type" id="type-options_fun"><a href="#type-options_fun" class="anchor"></a><code><span class="keyword">type </span>'a options_fun</code><code><span class="keyword"> = </span>?&#8288;root_dir:OpamFilename.Dir.t <span>&#45;&gt;</span> ?&#8288;current_switch:OpamSwitch.t <span>&#45;&gt;</span> ?&#8288;switch_from:[ `Env<span class="keyword"> | </span>`Command_line<span class="keyword"> | </span>`Default ] <span>&#45;&gt;</span> ?&#8288;jobs:int Lazy.t <span>&#45;&gt;</span> ?&#8288;dl_jobs:int <span>&#45;&gt;</span> ?&#8288;build_test:bool <span>&#45;&gt;</span> ?&#8288;build_doc:bool <span>&#45;&gt;</span> ?&#8288;dryrun:bool <span>&#45;&gt;</span> ?&#8288;makecmd:string Lazy.t <span>&#45;&gt;</span> ?&#8288;ignore_constraints_on:OpamTypes.name_set <span>&#45;&gt;</span> ?&#8288;unlock_base:bool <span>&#45;&gt;</span> ?&#8288;no_env_notice:bool <span>&#45;&gt;</span> ?&#8288;locked:string option <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span>OpamStd.Config.Sig<span class="keyword"> with </span><span class="keyword">type </span><a href="index.html">OpamStateConfig</a>.t := <a href="index.html#type-t">t</a><span class="keyword"> and </span><span class="keyword">type </span>'a <a href="index.html">OpamStateConfig</a>.options_fun := <span class="type-var">'a</span> <a href="index.html#type-options_fun">options_fun</a></code></span></summary><dl><dt class="spec value" id="val-default"><a href="#val-default" class="anchor"></a><code><span class="keyword">val </span>default : <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val </span>set : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>) <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-setk"><a href="#val-setk" class="anchor"></a><code><span class="keyword">val </span>setk : (<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-r"><a href="#val-r" class="anchor"></a><code><span class="keyword">val </span>r : <a href="index.html#type-t">t</a> Pervasives.ref</code></dt><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : ?&#8288;noop:<span class="type-var">'a</span> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> unit) <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-init"><a href="#val-init" class="anchor"></a><code><span class="keyword">val </span>init : ?&#8288;noop:<span class="type-var">'a</span> <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> unit) <a href="index.html#type-options_fun">options_fun</a></code></dt><dt class="spec value" id="val-initk"><a href="#val-initk" class="anchor"></a><code><span class="keyword">val </span>initk : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-options_fun">options_fun</a></code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-opamroot"><a href="#val-opamroot" class="anchor"></a><code><span class="keyword">val </span>opamroot : ?&#8288;root_dir:OpamTypes.dirname <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> OpamTypes.dirname</code></dt><dd><p>Get the initial opam root value (from default, env or optional argument). This allows to get it before doing the init, which is useful to get the configuration file used to fill some options to init()</p></dd></dl><dl><dt class="spec value" id="val-load"><a href="#val-load" class="anchor"></a><code><span class="keyword">val </span>load : OpamTypes.dirname <span>&#45;&gt;</span> OpamFile.Config.t option</code></dt><dd><p>Loads the global configuration file, protecting against concurrent writes</p></dd></dl><dl><dt class="spec value" id="val-load_defaults"><a href="#val-load_defaults" class="anchor"></a><code><span class="keyword">val </span>load_defaults : OpamFilename.Dir.t <span>&#45;&gt;</span> OpamFile.Config.t option</code></dt><dd><p>Loads the config file from the OPAM root and updates default values for all related OpamXxxConfig modules. Doesn't read the env yet, the <code>init</code> functions should still be called afterwards. OpamFormat should be initialised beforehand, as it may impact the config file loading.</p><p>Returns the config file that was found, if any</p></dd></dl><dl><dt class="spec value" id="val-get_switch"><a href="#val-get_switch" class="anchor"></a><code><span class="keyword">val </span>get_switch : unit <span>&#45;&gt;</span> OpamTypes.switch</code></dt><dd><p>Returns the current switch, failing with an error message is none is set.</p></dd></dl><dl><dt class="spec value" id="val-get_switch_opt"><a href="#val-get_switch_opt" class="anchor"></a><code><span class="keyword">val </span>get_switch_opt : unit <span>&#45;&gt;</span> OpamTypes.switch option</code></dt><dd><p>Returns the current switch, if any is set.</p></dd></dl><dl><dt class="spec value" id="val-get_current_switch_from_cwd"><a href="#val-get_current_switch_from_cwd" class="anchor"></a><code><span class="keyword">val </span>get_current_switch_from_cwd : OpamFilename.Dir.t <span>&#45;&gt;</span> OpamTypes.switch option</code></dt><dd><p>The function used to locate an external switch from parents of the current directory. Takes the opam root as parameter, and rejects any external switch configured with a different root</p></dd></dl><dl><dt class="spec value" id="val-local_switch_exists"><a href="#val-local_switch_exists" class="anchor"></a><code><span class="keyword">val </span>local_switch_exists : OpamFilename.Dir.t <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> bool</code></dt><dd><p>Checks if a local switch exists and is configurade for the given root</p></dd></dl><dl><dt class="spec value" id="val-resolve_local_switch"><a href="#val-resolve_local_switch" class="anchor"></a><code><span class="keyword">val </span>resolve_local_switch : OpamFilename.Dir.t <span>&#45;&gt;</span> OpamTypes.switch <span>&#45;&gt;</span> OpamTypes.switch</code></dt><dd><p>Resolves the switch if it is a link to a global switch in the given root (return unchanged otherwise)</p></dd></dl></div></body></html>