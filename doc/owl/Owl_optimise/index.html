<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Owl_optimise (owl.Owl_optimise)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">owl</a> &#x00BB; Owl_optimise</nav><h1>Module <code>Owl_optimise</code></h1><p><code>
  Machine learning library
  Note: C layout row-major matrix
  </code></p></header><div class="spec module" id="module-MX"><a href="#module-MX" class="anchor"></a><code><span class="keyword">module </span>MX = Owl_dense_real</code></div><div class="spec module" id="module-UT"><a href="#module-UT" class="anchor"></a><code><span class="keyword">module </span>UT = Owl_utils</code></div><dl><dt class="spec value" id="val-kmeans"><a href="#val-kmeans" class="anchor"></a><code><span class="keyword">val </span>kmeans : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat<span class="keyword"> * </span>int array</code></dt><dd><p><code>
  K-means clustering algorithm
  x is the row-based data points and c is the number of clusters.
</code></p></dd></dl><dl><dt class="spec value" id="val-numerical_gradient"><a href="#val-numerical_gradient" class="anchor"></a><code><span class="keyword">val </span>numerical_gradient : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code>
  a numberical way of calculating gradient.
  x is a k x m matrix containing m classifiers of k features.
</code></p></dd></dl><dl><dt class="spec value" id="val-l1"><a href="#val-l1" class="anchor"></a><code><span class="keyword">val </span>l1 : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> L1 regularisation and its subgradient </code></p></dd></dl><dl><dt class="spec value" id="val-l1_grad"><a href="#val-l1_grad" class="anchor"></a><code><span class="keyword">val </span>l1_grad : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-l2"><a href="#val-l2" class="anchor"></a><code><span class="keyword">val </span>l2 : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> L2 regularisation and its grandient </code></p></dd></dl><dl><dt class="spec value" id="val-l2_grad"><a href="#val-l2_grad" class="anchor"></a><code><span class="keyword">val </span>l2_grad : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dt class="spec value" id="val-elastic"><a href="#val-elastic" class="anchor"></a><code><span class="keyword">val </span>elastic : float <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Elastic net regularisation and its gradient
  &quot;a&quot; is the weight on l1 regularisation term. </code></p></dd></dl><dl><dt class="spec value" id="val-elastic_grad"><a href="#val-elastic_grad" class="anchor"></a><code><span class="keyword">val </span>elastic_grad : float <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-noreg"><a href="#val-noreg" class="anchor"></a><code><span class="keyword">val </span>noreg : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> No regularisation and its gradient </code></p></dd></dl><dl><dt class="spec value" id="val-noreg_grad"><a href="#val-noreg_grad" class="anchor"></a><code><span class="keyword">val </span>noreg_grad : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-square_loss"><a href="#val-square_loss" class="anchor"></a><code><span class="keyword">val </span>square_loss : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> least square loss function </code></p></dd></dl><dl><dt class="spec value" id="val-square_grad"><a href="#val-square_grad" class="anchor"></a><code><span class="keyword">val </span>square_grad : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-hinge_loss"><a href="#val-hinge_loss" class="anchor"></a><code><span class="keyword">val </span>hinge_loss : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> hinge loss function </code></p></dd></dl><dl><dt class="spec value" id="val-hinge_grad"><a href="#val-hinge_grad" class="anchor"></a><code><span class="keyword">val </span>hinge_grad : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-hinge2_loss"><a href="#val-hinge2_loss" class="anchor"></a><code><span class="keyword">val </span>hinge2_loss : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> squared hinge loss function </code></p></dd></dl><dl><dt class="spec value" id="val-hinge2_grad"><a href="#val-hinge2_grad" class="anchor"></a><code><span class="keyword">val </span>hinge2_grad : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span> option</code></dt><dt class="spec value" id="val-softmax_loss"><a href="#val-softmax_loss" class="anchor"></a><code><span class="keyword">val </span>softmax_loss : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> option</code></dt><dd><p><code> softmax loss function </code></p></dd></dl><dl><dt class="spec value" id="val-softmax_grad"><a href="#val-softmax_grad" class="anchor"></a><code><span class="keyword">val </span>softmax_grad : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span> option</code></dt></dl><aside><p><code> logistic loss function </code></p></aside><dl><dt class="spec value" id="val-log_loss"><a href="#val-log_loss" class="anchor"></a><code><span class="keyword">val </span>log_loss : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-log_grad"><a href="#val-log_grad" class="anchor"></a><code><span class="keyword">val </span>log_grad : <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dt class="spec value" id="val-constant_rate"><a href="#val-constant_rate" class="anchor"></a><code><span class="keyword">val </span>constant_rate : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> float</code></dt><dt class="spec value" id="val-optimal_rate"><a href="#val-optimal_rate" class="anchor"></a><code><span class="keyword">val </span>optimal_rate : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float</code></dt><dt class="spec value" id="val-decr_rate"><a href="#val-decr_rate" class="anchor"></a><code><span class="keyword">val </span>decr_rate : float <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float</code></dt><dt class="spec value" id="val-when_stable"><a href="#val-when_stable" class="anchor"></a><code><span class="keyword">val </span>when_stable : float <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-when_enough"><a href="#val-when_enough" class="anchor"></a><code><span class="keyword">val </span>when_enough : float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-_sgd_basic"><a href="#val-_sgd_basic" class="anchor"></a><code><span class="keyword">val </span>_sgd_basic : int <span>&#45;&gt;</span> (float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float) <span>&#45;&gt;</span> (float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> (<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> (<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> (<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> (<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> float <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code>
  Stochastic Gradient Descent (SGD) algorithm
  b : batch size
  s : step size
  t : stop criteria
  l : loss function
  g : gradient function of the loss function
  r : regularisation function
  o : gradient fucntion of the regularisation function
  a : weight on the regularisation term, common setting is 0.0001
  i : whether to include intercept or not, default value is false
  p : model parameters (k * m), each column is a classifier. So we have m classifier of k features.
  x : data matrix (n x k), each row is a data point. So we have n datea points of k features each.
  y : labeled data (n x m), n data points and each is labeled with m classifiers
</code></p></dd></dl><dl><dt class="spec value" id="val-sgd"><a href="#val-sgd" class="anchor"></a><code><span class="keyword">val </span>sgd : ?&#8288;b:int <span>&#45;&gt;</span> ?&#8288;s:(float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> float) <span>&#45;&gt;</span> ?&#8288;t:(float <span>&#45;&gt;</span> int <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> ?&#8288;l:(<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> ?&#8288;g:(<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> ?&#8288;r:(<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> ?&#8288;o:(<a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat) <span>&#45;&gt;</span> ?&#8288;a:float <span>&#45;&gt;</span> ?&#8288;i:bool <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code>
  wrapper of the _sgd_basic fucntion
</code></p></dd></dl><dl><dt class="spec value" id="val-gradient_descent"><a href="#val-gradient_descent" class="anchor"></a><code><span class="keyword">val </span>gradient_descent : <span class="type-var">'a</span> option</code></dt><dt class="spec value" id="val-svm_regression"><a href="#val-svm_regression" class="anchor"></a><code><span class="keyword">val </span>svm_regression : ?&#8288;i:bool <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Support Vector Machine regression
  i : whether to include intercept bias in parameters
  note that the values in y are either +1 or -1.
 </code></p></dd></dl><dl><dt class="spec value" id="val-ols_regression"><a href="#val-ols_regression" class="anchor"></a><code><span class="keyword">val </span>ols_regression : ?&#8288;i:bool <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Ordinary Least Square regression
  i : whether to include intercept bias in parameters
</code></p></dd></dl><dl><dt class="spec value" id="val-ridge_regression"><a href="#val-ridge_regression" class="anchor"></a><code><span class="keyword">val </span>ridge_regression : ?&#8288;i:bool <span>&#45;&gt;</span> ?&#8288;a:float <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Ridge regression
  i : whether to include intercept bias in parameters
  a : weight on the regularisation term
  TODO: how to choose a automatically
</code></p></dd></dl><dl><dt class="spec value" id="val-lasso_regression"><a href="#val-lasso_regression" class="anchor"></a><code><span class="keyword">val </span>lasso_regression : ?&#8288;i:bool <span>&#45;&gt;</span> ?&#8288;a:float <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Lasso regression
  i : whether to include intercept bias in parameters
  a : weight on the regularisation term
  TODO: how to choose a automatically
</code></p></dd></dl><dl><dt class="spec value" id="val-logistic_regression"><a href="#val-logistic_regression" class="anchor"></a><code><span class="keyword">val </span>logistic_regression : ?&#8288;i:bool <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat <span>&#45;&gt;</span> <a href="index.html#module-MX">MX</a>.mat</code></dt><dd><p><code> Logistic regression
  i : whether to include intercept bias in parameters
  a : weight on the regularisation term
  note that the values in y are either +1 or 0.
</code></p></dd></dl></div></body></html>