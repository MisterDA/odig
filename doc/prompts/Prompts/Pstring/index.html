<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pstring (prompts.Prompts.Pstring)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">prompts</a> &#x00BB; <a href="../index.html">Prompts</a> &#x00BB; Pstring</nav><h1>Module <code>Prompts.Pstring</code></h1><p>Pointed strings.</p><p>A pointed string is a string with two distinguished positions: a cursor and a mark. These <a href="index.html#positions"><span>positions</span></a> make it easy to transform the pointed string through <a href="index.html#actions"><span>actions</span></a> which toghether with <a href="index.html#spans"><span>spans</span></a> make it easy to devise a wide range of human text editing and navigation operations.</p><p><b>Warning.</b> Here are a few assumptions made by the module to take into account:</p><ul><li>The current implementation assumes you act on small strings and that you mostly append to them. Usable for REPLs or form text fields.</li><li>Assumes cursor positions are always in the bounds of the string. <code>Invalid_argument</code>s might get raised otherwise.</li><li>Assumes mark positions are not negative. <code>Invalid_argument</code>s might get raised otherwise. Mark positions can however be out of bounds.</li></ul><nav class="toc"><ul><li><a href="#positions">Positions</a></li><li><a href="#pointed">Pointed strings</a></li><li><a href="#spans">Spans</a></li><li><a href="#actions">Actions</a></li></ul></nav></header><section><header><h2 id="positions"><a href="#positions" class="anchor"></a>Positions</h2><p>Position are the slits found before and after each byte of the string. For a string of length <code>l</code> they are in the range [<code>0</code>;<code>l</code>].</p><pre>positions  0   1   2   3   4    l-1    l
           +---+---+---+---+     +-----+
  indices  | 0 | 1 | 2 | 3 | ... | l-1 |
           +---+---+---+---+     +-----+</pre></header></section><section><header><h2 id="pointed"><a href="#pointed" class="anchor"></a>Pointed strings</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>The type for pointed strings.</p></dd></dl><dl><dt class="spec value" id="val-v"><a href="#val-v" class="anchor"></a><code><span class="keyword">val </span>v : ?&#8288;cursor:int <span>&#45;&gt;</span> ?&#8288;mark:int <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>v ~cursor ~mark s</code> points the string <code>s</code> with cursor position <code>cursor</code> (defaults to <code>0</code>) and mark position <code>mark</code> (defaults to <code>cursor</code>).</p></dd></dl><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val </span>empty : <a href="index.html#type-t">t</a></code></dt><dd><p><code>empty</code> is <code>v &quot;&quot;</code>.</p></dd></dl><dl><dt class="spec value" id="val-cursor"><a href="#val-cursor" class="anchor"></a><code><span class="keyword">val </span>cursor : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>cursor p</code> is <code>p</code>'s cursor position.</p></dd></dl><dl><dt class="spec value" id="val-mark"><a href="#val-mark" class="anchor"></a><code><span class="keyword">val </span>mark : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>mark p</code> is <code>p</code>'s mark position.</p></dd></dl><dl><dt class="spec value" id="val-string"><a href="#val-string" class="anchor"></a><code><span class="keyword">val </span>string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>string p</code> is <code>p</code>'s string.</p></dd></dl><dl><dt class="spec value" id="val-max_pos"><a href="#val-max_pos" class="anchor"></a><code><span class="keyword">val </span>max_pos : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>max_pos t</code> is <code>p</code>'s maximal position.</p></dd></dl><dl><dt class="spec value" id="val-length"><a href="#val-length" class="anchor"></a><code><span class="keyword">val </span>length : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>length p</code> is <code>p</code>'s length.</p></dd></dl><dl><dt class="spec value" id="val-ends_with"><a href="#val-ends_with" class="anchor"></a><code><span class="keyword">val </span>ends_with : ?&#8288;cursor:bool <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>ends_with ~cursor s p</code> is <code>true</code> iff <code>p</code> ends with <code>s</code> and, if <code>cursor</code> is <code>true</code>, the cursor position is <code>max_pos p</code>. If <code>false</code> (default) the cursor position doesn't matter.</p></dd></dl></section><section><header><h2 id="spans"><a href="#spans" class="anchor"></a>Spans</h2><p>Spans are functions that determine (possibly empty) substrings of the pointed string that start or end at the cursor position.</p></header><dl><dt class="spec type" id="type-dir"><a href="#type-dir" class="anchor"></a><code><span class="keyword">type </span>dir</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-dir.Left" class="anchored"><td class="def constructor"><a href="#type-dir.Left" class="anchor"></a><code><span class="keyword">| </span></code><code>`Left</code></td></tr><tr id="type-dir.Right" class="anchored"><td class="def constructor"><a href="#type-dir.Right" class="anchor"></a><code><span class="keyword">| </span></code><code>`Right</code></td></tr></table><code> ]</code></dt><dd><p>The type for directions.</p></dd></dl><dl><dt class="spec type" id="type-span"><a href="#type-span" class="anchor"></a><code><span class="keyword">type </span>span</code><code><span class="keyword"> = </span><a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> cursor:int <span>&#45;&gt;</span> mark:int <span>&#45;&gt;</span> int</code></dt><dd><p>The type for spans. Given a direction, the pointed string, the cursor and mark positions returns the position of the span's other end. This can be either the start or end of the span, regardless of direction. If <code>cursor</code> is returned the span is empty.</p></dd></dl><dl><dt class="spec value" id="val-span_byte"><a href="#val-span_byte" class="anchor"></a><code><span class="keyword">val </span>span_byte : <a href="index.html#type-span">span</a></code></dt><dd><p><code>span_byte</code> spans a byte in either direction, if possible.</p></dd></dl><dl><dt class="spec value" id="val-span_line"><a href="#val-span_line" class="anchor"></a><code><span class="keyword">val </span>span_line : <a href="index.html#type-span">span</a></code></dt><dd><p><code>span_line</code> spans a line in either direction. Starting at the cursor position this is the position before the next <code>'\n'</code> or <code>'\r'</code> when running in the corresponding direction. If there is no such character this will be the first (<code>`Left</code>) or last position (<code>`Right</code>).</p></dd></dl><dl><dt class="spec value" id="val-span_string"><a href="#val-span_string" class="anchor"></a><code><span class="keyword">val </span>span_string : <a href="index.html#type-span">span</a></code></dt><dd><p><code>span_string</code> spans the pointed string's maximal extent in either direction. This is the first position (<code>`Left</code>) or the last one (<code>`Right</code>).</p></dd></dl><dl><dt class="spec value" id="val-span_mark"><a href="#val-span_mark" class="anchor"></a><code><span class="keyword">val </span>span_mark : <a href="index.html#type-span">span</a></code></dt><dd><p><code>span_mark</code> spans to the mark position or the empty span if the mark is out of bounds.</p></dd></dl></section><section><header><h2 id="actions"><a href="#actions" class="anchor"></a>Actions</h2><p>In the functions below <code>span</code> defaults to <a href="index.html#val-span_byte"><code>span_byte</code></a>.</p></header><dl><dt class="spec value" id="val-set_cursor"><a href="#val-set_cursor" class="anchor"></a><code><span class="keyword">val </span>set_cursor : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set_cursor p c</code> is <code>p</code> with cursor position <code>c</code>.</p></dd></dl><dl><dt class="spec value" id="val-set_mark"><a href="#val-set_mark" class="anchor"></a><code><span class="keyword">val </span>set_mark : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>mark p m</code> is <code>p</code> with mark position <code>m</code>.</p></dd></dl><dl><dt class="spec value" id="val-move_to_mark"><a href="#val-move_to_mark" class="anchor"></a><code><span class="keyword">val </span>move_to_mark : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>move_to_mark p</code> is <code>p</code> with cursor position <code>mark p</code> except if out of bounds in which case the cursor position is left unchanged.</p></dd></dl><dl><dt class="spec value" id="val-move"><a href="#val-move" class="anchor"></a><code><span class="keyword">val </span>move : ?&#8288;span:<a href="index.html#type-span">span</a> <span>&#45;&gt;</span> <a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>move ~span dir p</code> is <code>p</code> with cursor position at the span's start (<code>dir</code> is <code>`Left</code>) or end (<code>dir</code> is <code>`Right</code>) position.</p></dd></dl><dl><dt class="spec value" id="val-move_span"><a href="#val-move_span" class="anchor"></a><code><span class="keyword">val </span>move_span : ?&#8288;span:<a href="index.html#type-span">span</a> <span>&#45;&gt;</span> <a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a><span class="keyword"> * </span>string</code></dt><dd><p><code>move_span</code> is like <a href="index.html#val-move"><code>move</code></a> but also returns the move's span (can be empty).</p></dd></dl><dl><dt class="spec value" id="val-delete"><a href="#val-delete" class="anchor"></a><code><span class="keyword">val </span>delete : ?&#8288;span:<a href="index.html#type-span">span</a> <span>&#45;&gt;</span> <a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>delete ~span dir p</code> is <code>p</code> with the span's substring deleted. The cursor position changes only when the span ends up on the left of the cursor.</p></dd></dl><dl><dt class="spec value" id="val-delete_span"><a href="#val-delete_span" class="anchor"></a><code><span class="keyword">val </span>delete_span : ?&#8288;span:<a href="index.html#type-span">span</a> <span>&#45;&gt;</span> <a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a><span class="keyword"> * </span>string</code></dt><dd><p><code>delete_span</code> is like <a href="index.html#type-span"><code>span</code></a> but also returns the deleted span (can be empty).</p></dd></dl><dl><dt class="spec value" id="val-insert"><a href="#val-insert" class="anchor"></a><code><span class="keyword">val </span>insert : <a href="index.html#type-dir">dir</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>insert dir s</code> inserts <code>s</code> on the left or right of the cursor position. The cursor position changes when <code>dir</code> is <code>`Left</code> due to the insertion.</p></dd></dl></section></div></body></html>