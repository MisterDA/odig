<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bcrypt (safepass.Bcrypt)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">safepass</a> &#x00BB; Bcrypt</nav><h1>Module <code>Bcrypt</code></h1><p>Module for safe salting and hashing of passwords using the Bcrypt algorithm.</p><nav class="toc"><ul><li><a href="#exceptions">Exceptions</a></li><li><a href="#type-definitions">Type definitions</a></li><li><a href="#public-functions-and-values">Public functions and values</a></li></ul></nav></header><section><header><h2 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h2></header><dl><dt class="spec exception" id="exception-Invalid_count"><a href="#exception-Invalid_count" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Invalid_count</span> <span class="keyword">of</span> int</code></dt><dd><p>The provided <code>count</code> is invalid. The <code>count</code> must be an integer between 4 and 31, inclusive.</p></dd></dl><dl><dt class="spec exception" id="exception-Invalid_seed"><a href="#exception-Invalid_seed" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Invalid_seed</span> <span class="keyword">of</span> string</code></dt><dd><p>The given string <code>seed</code> cannot be used as seed. Please provide a string at least 16 bytes long.</p></dd></dl><dl><dt class="spec exception" id="exception-Urandom_error"><a href="#exception-Urandom_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Urandom_error</span> <span class="keyword">of</span> exn</code></dt><dd><p>An exception occurred obtaining random seed from <code>/dev/urandom</code>.</p></dd></dl><dl><dt class="spec exception" id="exception-Gensalt_error"><a href="#exception-Gensalt_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Gensalt_error</span></code></dt><dd><p>An exception occurred in backend's <code>_crypt_gensalt_blowfish_rn</code> function.</p></dd></dl><dl><dt class="spec exception" id="exception-Bcrypt_error"><a href="#exception-Bcrypt_error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Bcrypt_error</span></code></dt><dd><p>An exception ocurred in backend's <code>_crypt_blowfish_rn</code> function.</p></dd></dl></section><section><header><h2 id="type-definitions"><a href="#type-definitions" class="anchor"></a>Type definitions</h2></header><dl><dt class="spec type" id="type-hash"><a href="#type-hash" class="anchor"></a><code><span class="keyword">type</span> hash</code></dt><dd><p>Abstract type holding a password in salted and hashed form. Use function <a href="index.html#type-hash"><code>hash</code></a> to generate a hash.</p></dd></dl><dl><dt class="spec type" id="type-variant"><a href="#type-variant" class="anchor"></a><code><span class="keyword">type</span> variant</code><code> = </code><table class="variant"><tr id="type-variant.A" class="anchored"><td class="def constructor"><a href="#type-variant.A" class="anchor"></a><code>| </code><code><span class="constructor">A</span></code></td></tr><tr id="type-variant.Y" class="anchored"><td class="def constructor"><a href="#type-variant.Y" class="anchor"></a><code>| </code><code><span class="constructor">Y</span></code></td></tr><tr id="type-variant.B" class="anchored"><td class="def constructor"><a href="#type-variant.B" class="anchor"></a><code>| </code><code><span class="constructor">B</span></code></td></tr></table></dt><dd><p>Supported variants of the Bcrypt algorithm.</p></dd></dl></section><section><header><h2 id="public-functions-and-values"><a href="#public-functions-and-values" class="anchor"></a>Public functions and values</h2></header><dl><dt class="spec value" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span class="keyword">val</span> hash : ?&#8288;count:int <span>&#45;&gt;</span> ?&#8288;variant:<a href="index.html#type-variant">variant</a> <span>&#45;&gt;</span> ?&#8288;seed:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-hash">hash</a></code></dt><dd><p>Call <code>hash ?count ?variant ?seed password</code> to hash the given password string. The password is automatically salted before hashing. If <code>seed</code> is not given, the salting procedure automatically fetches a seed from <code>/dev/urandom</code>. If given, <code>seed</code> must be a string at least 16 bytes long. The <code>count</code> parameter is the log<sub>2</sub> number of Blowfish iterations to use in the hashing procedure. Its default value is 6, and any integer between 4 and 31 (inclusive) may be used. Finally, <code>variant</code> picks which of the Bcrypt variants to use (defaults to <code>Y</code>).</p></dd></dl><dl><dt class="spec value" id="val-verify"><a href="#val-verify" class="anchor"></a><code><span class="keyword">val</span> verify : string <span>&#45;&gt;</span> <a href="index.html#type-hash">hash</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Call <code>verify password hash</code> to verify if the given password matches the previously hashed password.</p></dd></dl><dl><dt class="spec value" id="val-hash_of_string"><a href="#val-hash_of_string" class="anchor"></a><code><span class="keyword">val</span> hash_of_string : string <span>&#45;&gt;</span> <a href="index.html#type-hash">hash</a></code></dt><dd><p>Convert <code>string</code> to <a href="index.html#type-hash"><code>hash</code></a></p></dd></dl><dl><dt class="spec value" id="val-string_of_hash"><a href="#val-string_of_hash" class="anchor"></a><code><span class="keyword">val</span> string_of_hash : <a href="index.html#type-hash">hash</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Convert <a href="index.html#type-hash"><code>hash</code></a> to <code>string</code></p></dd></dl></section></div></body></html>