<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sequencer_table (sequencer_table.Sequencer_table)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">sequencer_table</a> &#x00BB; Sequencer_table</nav><h1>Module <code>Sequencer_table</code></h1><p>A table of sequencers indexed by key, so that at any moment for each key there is at most one job running.</p><p>An <code>'a Sequencer_table.Make(Key).t</code> is similar in concept to:</p><pre><code class="ml">{ mutable state : 'a option
; jobs  : 'a option Throttle.Sequencer.t
} Key.Table.t</code></pre><p>It allows one to run jobs that are indexed by a key, while allowing jobs with distinct keys to run simultaneously, and ensuring that for any given key, at most one job with that key is running at a time. A sequencer table maintains optional state for each key, and supplies that state to each running job indexed by the key.</p><p>The implementation of a sequencer table is optimized for having a large number of keys with state, while only a few keys with active jobs at any given time. So, it is implemented with two tables, one of states and one of sequencers:</p><pre><code class="ml">{ states : 'a Key.Table.t
; jobs   : ('a option -&gt; unit Deferred.t) Sequencer.t Key.Table.t
}</code></pre><p>The implementation automatically adds a sequencer to the <code>jobs</code> table, if necessary, when one adds a job, and automatically removes a sequencer from the <code>jobs</code> table whenever the sequencer has no jobs to run.</p><p>The implementation does not automatically release state; one must call <code>set_state t
    ~key None</code>.</p></header><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span class="keyword">module</span> <a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/argument-1-Key/index.html">Key</a> : <a href="../../core/Core/index.html#module-type-Hashable">Core.Hashable</a>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></div></body></html>