<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Base (spotlib.Spotlib.Base)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">spotlib</a> &#x00BB; <a href="../index.html">Spotlib</a> &#x00BB; Base</nav><h1>Module <code>Spotlib.Base</code></h1><nav class="toc"><ul><li><a href="#common-types">Common types</a></li><li><a href="#function-compositions-and-other-operators">Function compositions and other operators</a></li><li><a href="#imperative-operations">Imperative operations</a></li><li><a href="#i/o">I/O</a></li><li><a href="#misc-things">Misc things</a></li><li><a href="#comparison">Comparison</a></li></ul></nav></header><aside><p>Basic functionns. They are accessible via <code>open Spotlib.Spot</code></p></aside><section><header><h6 id="common-types"><a href="#common-types" class="anchor"></a>Common types</h6></header><dl><dt class="spec type" id="type-poly_result"><a href="#type-poly_result" class="anchor"></a><code><span class="keyword">type</span> ('a, 'b) poly_result</code> = <code>[ </code><table class="variant"><tr id="type-poly_result.Ok" class="anchored"><td class="def constructor"><a href="#type-poly_result.Ok" class="anchor"></a><code>| </code><code>`Ok <span class="keyword">of</span> <span class="type-var">'a</span></code></td></tr><tr id="type-poly_result.Error" class="anchored"><td class="def constructor"><a href="#type-poly_result.Error" class="anchor"></a><code>| </code><code>`Error <span class="keyword">of</span> <span class="type-var">'b</span></code></td></tr></table><code> ]</code></dt><dd><p>Result/Either monad using polymorphic variant. Obsolete. Use the primitive type <code>result</code> instead.</p></dd></dl></section><section><header><h6 id="function-compositions-and-other-operators"><a href="#function-compositions-and-other-operators" class="anchor"></a>Function compositions and other operators</h6></header><dl><dt class="spec value" id="val-(**)"><a href="#val-(**)" class="anchor"></a><code><span class="keyword">val</span> (**) : (<span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'c</span></code></dt><dd><p>Functional composition. Haskell's (.) Use <code>power</code> if you want to use the original <code>( ** )</code>.</p></dd></dl><dl><dt class="spec value" id="val-(*&lt;)"><a href="#val-(*&lt;)" class="anchor"></a><code><span class="keyword">val</span> (*&lt;) : (<span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'c</span></code></dt><dd><p>Same as <code>( ** )</code>.</p></dd></dl><dl><dt class="spec value" id="val-(*&gt;)"><a href="#val-(*&gt;)" class="anchor"></a><code><span class="keyword">val</span> (*&gt;) : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> (<span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'c</span></code></dt><dd><p>Functional composition in swapped order. Same as Haskell's <code>(&gt;&gt;&gt;)</code></p></dd></dl><dl><dt class="spec external" id="val-power"><a href="#val-power" class="anchor"></a><code><span class="keyword">val</span> power : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float</code></dt><dd><p>Replacement of <code>( ** )</code></p></dd></dl><dl><dt class="spec external" id="val-(&amp;)"><a href="#val-(&amp;)" class="anchor"></a><code><span class="keyword">val</span> (&amp;) : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Haskell's <code>($)</code>.</p></dd></dl><dl><dt class="spec external" id="val-(&amp;~)"><a href="#val-(&amp;~)" class="anchor"></a><code><span class="keyword">val</span> (&amp;~) : (f:<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Haskell's <code>($)</code>, with label 'f'.</p></dd></dl><dl><dt class="spec external" id="val-id"><a href="#val-id" class="anchor"></a><code><span class="keyword">val</span> id : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl><dl><dt class="spec value" id="val-(|-)"><a href="#val-(|-)" class="anchor"></a><code><span class="keyword">val</span> (|-) : <span class="type-var">'a</span> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>&quot;tee&quot;. <code>v |-- f</code> is <code>v</code> but <code>f v</code> is run before <code>v</code> is returned</p></dd></dl><dl><dt class="spec value" id="val-flip"><a href="#val-flip" class="anchor"></a><code><span class="keyword">val</span> flip : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'c</span></code></dt><dd><p><code>flip</code> of Haskell</p></dd></dl><dl><dt class="spec value" id="val-(~~)"><a href="#val-(~~)" class="anchor"></a><code><span class="keyword">val</span> (~~) : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> f:<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Super <code>flip</code> of Haskell. The first argument is labeled and becomes commutative.</p></dd></dl><dl><dt class="spec value" id="val-flipf"><a href="#val-flipf" class="anchor"></a><code><span class="keyword">val</span> flipf : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> f:<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Super <code>flip</code> of Haskell. The first argument is labeled and becomes commutative.</p></dd></dl><dl><dt class="spec value" id="val-flip2"><a href="#val-flip2" class="anchor"></a><code><span class="keyword">val</span> flip2 : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'d</span></code></dt><dd><p><code>flip f x2 x3 x1 = f x1 x2 x3</code></p></dd></dl></section><section><header><h6 id="imperative-operations"><a href="#imperative-operations" class="anchor"></a>Imperative operations</h6></header><dl><dt class="spec value" id="val-with_ref"><a href="#val-with_ref" class="anchor"></a><code><span class="keyword">val</span> with_ref : <span class="type-var">'a</span> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <a href="../../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> * <span class="type-var">'b</span></code></dt><dt class="spec value" id="val-with_ref_"><a href="#val-with_ref_" class="anchor"></a><code><span class="keyword">val</span> with_ref_ : <span class="type-var">'a</span> <span>&#45;&gt;</span> (<span class="type-var">'a</span> <a href="../../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_ref</code> and <code>with_ref_</code> runs a function with a reference with the specified initial value.</p></dd></dl></section><section><header><h6 id="i/o"><a href="#i/o" class="anchor"></a>I/O</h6></header><dl><dt class="spec value" id="val-with_oc"><a href="#val-with_oc" class="anchor"></a><code><span class="keyword">val</span> with_oc : <a href="../../../ocaml/Stdlib/index.html#type-out_channel">Stdlib.out_channel</a> <span>&#45;&gt;</span> (<a href="../../../ocaml/Stdlib/index.html#type-out_channel">Stdlib.out_channel</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dt class="spec value" id="val-with_ic"><a href="#val-with_ic" class="anchor"></a><code><span class="keyword">val</span> with_ic : <a href="../../../ocaml/Stdlib/index.html#type-in_channel">Stdlib.in_channel</a> <span>&#45;&gt;</span> (<a href="../../../ocaml/Stdlib/index.html#type-in_channel">Stdlib.in_channel</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl></section><section><header><h6 id="misc-things"><a href="#misc-things" class="anchor"></a>Misc things</h6></header><dl><dt class="spec value" id="val-sprintf"><a href="#val-sprintf" class="anchor"></a><code><span class="keyword">val</span> sprintf : (<span class="type-var">'a</span>,Â unit,Â string) <a href="../../../ocaml/Stdlib/index.html#type-format">Stdlib.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>Printf.sprintf</code> is available without tying <code>Printf.</code></p></dd></dl><dl><dt class="spec value" id="val-ksprintf"><a href="#val-ksprintf" class="anchor"></a><code><span class="keyword">val</span> ksprintf : (string <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> (<span class="type-var">'b</span>,Â unit,Â string,Â <span class="type-var">'a</span>) <a href="../../../ocaml/Stdlib/index.html#type-format4">Stdlib.format4</a> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>Printf.ksprintf</code> is available without tying <code>Printf.</code></p></dd></dl><dl><dt class="spec value" id="val-(!%)"><a href="#val-(!%)" class="anchor"></a><code><span class="keyword">val</span> (!%) : (<span class="type-var">'a</span>,Â unit,Â string) <a href="../../../ocaml/Stdlib/index.html#type-format">Stdlib.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>Printf.sprintf</code>, prefix style. Bought from ITPL.</p></dd></dl><dl><dt class="spec value" id="val-(!!%)"><a href="#val-(!!%)" class="anchor"></a><code><span class="keyword">val</span> (!!%) : (<span class="type-var">'a</span>,Â <a href="../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>,Â unit) <a href="../../../ocaml/Stdlib/index.html#type-format">Stdlib.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>Format.eprintf</code>, prefix style.</p></dd></dl><dl><dt class="spec value" id="val-memoize_gen"><a href="#val-memoize_gen" class="anchor"></a><code><span class="keyword">val</span> memoize_gen : ((<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) * (<span class="type-var">'a</span>,Â <span class="type-var">'b</span>) <a href="../../../ocaml/Stdlib/Hashtbl/index.html#type-t">Stdlib.Hashtbl.t</a></code></dt><dd><p>Generic memozation by hash with fixed point. You can call memoized self inside:</p><p>memoize_gen (fun self -&gt; .... self v ....) f</p></dd></dl><dl><dt class="spec value" id="val-memoize"><a href="#val-memoize" class="anchor"></a><code><span class="keyword">val</span> memoize : (<span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span>) <span>&#45;&gt;</span> <span class="type-var">'c</span> <span>&#45;&gt;</span> <span class="type-var">'d</span></code></dt><dd><p>Memozation by hash</p></dd></dl><dl><dt class="spec value" id="val-memoize_rec"><a href="#val-memoize_rec" class="anchor"></a><code><span class="keyword">val</span> memoize_rec : ((<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Memozation by hash with fixed point. You can call memoized self inside:</p><p>memoize_rec (fun self -&gt; .... self v ....) f</p></dd></dl><dl><dt class="spec value" id="val-time"><a href="#val-time" class="anchor"></a><code><span class="keyword">val</span> time : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> * float</code></dt><dd><p>Simple profiling. Returns seconds. If <code>f a</code> raises an exception <code>e</code>, then <code>time f a</code> raises <code>e</code> too.</p></dd></dl><dl><dt class="spec value" id="val-(+=)"><a href="#val-(+=)" class="anchor"></a><code><span class="keyword">val</span> (+=) : int <a href="../../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-(-=)"><a href="#val-(-=)" class="anchor"></a><code><span class="keyword">val</span> (-=) : int <a href="../../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-find_by_iter"><a href="#val-find_by_iter" class="anchor"></a><code><span class="keyword">val</span> find_by_iter : ((<span class="type-var">'a</span> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> <span class="type-var">'collection</span> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> <span class="type-var">'collection</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> option</code></dt><dd><p>find the first element where <code>predicate</code> holds by iteration <code>find_by_iter iterator predicate colleciton</code></p></dd></dl><dl><dt class="spec value" id="val-find_in_tree"><a href="#val-find_in_tree" class="anchor"></a><code><span class="keyword">val</span> find_in_tree : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> list) <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'res</span> option) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'res</span> option</code></dt><dd><p><code>find_in_tree get_subs p a</code> visits <code>a</code> and finds the first sub node in which <code>p</code> holds. <code>get_subs</code> returns the sub nodes of a node.</p></dd></dl><dl><dt class="spec value" id="val-loop"><a href="#val-loop" class="anchor"></a><code><span class="keyword">val</span> loop : (<span class="type-var">'a</span> <span>&#45;&gt;</span> [&lt; `Continue of <span class="type-var">'a</span> | `Break of <span class="type-var">'b</span> ]) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p>Keep repeating a function until a final result is producted.</p></dd></dl></section><section><header><h6 id="comparison"><a href="#comparison" class="anchor"></a>Comparison</h6></header><dl><dt class="spec value" id="val-compare_on"><a href="#val-compare_on" class="anchor"></a><code><span class="keyword">val</span> compare_on : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare_on f a b</code> compares <code>a</code> and <code>b</code> not by themselves but by <code>f a</code> and <code>f b</code>.</p></dd></dl><dl><dt class="spec value" id="val-rev_compare_on"><a href="#val-rev_compare_on" class="anchor"></a><code><span class="keyword">val</span> rev_compare_on : (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> int</code></dt><dd><p><code>rev_compare_on f a b = - (compare_on f a b)</code></p></dd></dl><dl><dt class="spec value" id="val-add_if_not_mem"><a href="#val-add_if_not_mem" class="anchor"></a><code><span class="keyword">val</span> add_if_not_mem : <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> list <a href="../../../ocaml/Stdlib/index.html#type-ref">Stdlib.ref</a> <span>&#45;&gt;</span> [&gt; `AlreadyIn | `NewlyAdded ]</code></dt><dd><p><code>add_if_not_mem</code> adds <code>a</code> to <code>asref</code> if <code>not (List.mem a !asref)</code> then return <code>`NewlyAdded</code>. Otherwise it returns <code>`AlreadIn</code> and <code>asref</code> is not modified.</p></dd></dl><aside><p>String &lt;-&gt; bytes conversions</p></aside><dl><dt class="spec value" id="val-(!&lt;$)"><a href="#val-(!&lt;$)" class="anchor"></a><code><span class="keyword">val</span> (!&lt;$) : string <span>&#45;&gt;</span> bytes</code></dt><dt class="spec value" id="val-(!&gt;$)"><a href="#val-(!&gt;$)" class="anchor"></a><code><span class="keyword">val</span> (!&gt;$) : bytes <span>&#45;&gt;</span> string</code></dt></dl></section></div></body></html>