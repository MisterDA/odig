<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sqlite3 (sqlite3.Sqlite3)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">sqlite3</a> &#x00BB; Sqlite3</nav><h1>Module <code>Sqlite3</code></h1><p>API for Sqlite 3.* databases</p><nav class="toc"><ul><li><a href="#exceptions">Exceptions</a></li><li><a href="#types">Types</a></li><li><a href="#return-codes">Return codes</a></li><li><a href="#column-data-types">Column data types</a></li><li><a href="#general-database-operations">General database operations</a></li><li><a href="#fine-grained-query-operations">Fine grained query operations</a></li><li><a href="#data-query">Data query</a></li><li><a href="#binding-data-to-the-query">Binding data to the query</a></li><li><a href="#stepwise-query-convenience-functions">Stepwise query convenience functions</a></li><li><a href="#user-defined-functions">User-defined functions</a></li></ul></nav></header><section><header><h3 id="exceptions"><a href="#exceptions" class="anchor"></a>Exceptions</h3></header><dl><dt class="spec exception" id="exception-InternalError"><a href="#exception-InternalError" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">InternalError</span> <span class="keyword">of</span> string</code></dt><dd><p><code>InternalError reason</code> is raised when the bindings detect an unknown/unsupported situation.</p></dd></dl><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Error</span> <span class="keyword">of</span> string</code></dt><dd><p><code>Error reason</code> is raised when some SQL operation is called on a nonexistent handle and the functions does not return a return code, or if there is no error code corresponding to this error. Functions returning return codes communicate errors by returning the specific error code.</p></dd></dl><dl><dt class="spec exception" id="exception-RangeError"><a href="#exception-RangeError" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">RangeError</span> <span class="keyword">of</span> int * int</code></dt><dd><p><code>RangeError (index, maximum)</code> is raised if some column or bind operation refers to a nonexistent column or binding. The first entry of the returned tuple is the specified index, the second is the limit which was violated.</p></dd></dl></section><section><header><h3 id="types"><a href="#types" class="anchor"></a>Types</h3></header><dl><dt class="spec type" id="type-db"><a href="#type-db" class="anchor"></a><code><span class="keyword">type</span> db</code></dt><dd><p>Database handle. Used to store information regarding open databases and the error code from the last operation if the function implementing that operation takes a database handle as a parameter.</p><dl><dt>see <a href="https://sqlite.org/threadsafe.html">https://sqlite.org/threadsafe.html</a></dt><dd><p>about thread safety when accessing database handles and also consider using the <code>mutex</code> flag with <a href="index.html#val-db_open"><code>db_open</code></a> if necessary.</p><p>NOTE: database handles are closed (see <a href="index.html#val-db_close"><code>db_close</code></a>) automatically when they are reclaimed by the GC unless they have already been closed earlier by the user. It is good practice to manually close database handles to free resources as quickly as possible.</p></dd></dl></dd></dl><dl><dt class="spec type" id="type-stmt"><a href="#type-stmt" class="anchor"></a><code><span class="keyword">type</span> stmt</code></dt><dd><p>Compiled statement handle. Stores information about compiled statements created by the <code>prepare</code> or <code>prepare_tail</code> functions.</p><dl><dt>see <a href="https://sqlite.org/threadsafe.html">https://sqlite.org/threadsafe.html</a></dt><dd><p>about thread safety when accessing statement handles.</p></dd></dl></dd></dl><dl><dt class="spec type" id="type-header"><a href="#type-header" class="anchor"></a><code><span class="keyword">type</span> header</code><code> = string</code></dt><dd><p>Type of name of a column returned by queries.</p></dd></dl><dl><dt class="spec type" id="type-headers"><a href="#type-headers" class="anchor"></a><code><span class="keyword">type</span> headers</code><code> = <a href="index.html#type-header">header</a> array</code></dt><dd><p>Type of names of columns returned by queries.</p></dd></dl><dl><dt class="spec type" id="type-row"><a href="#type-row" class="anchor"></a><code><span class="keyword">type</span> row</code><code> = string option array</code></dt><dd><p>Type of row data (with potential NULL-values)</p></dd></dl><dl><dt class="spec type" id="type-row_not_null"><a href="#type-row_not_null" class="anchor"></a><code><span class="keyword">type</span> row_not_null</code><code> = string array</code></dt><dd><p>Type of row data (without NULL-values)</p></dd></dl></section><section><header><h3 id="return-codes"><a href="#return-codes" class="anchor"></a>Return codes</h3></header><div class="spec module" id="module-Rc"><a href="#module-Rc" class="anchor"></a><code><span class="keyword">module</span> <a href="Rc/index.html">Rc</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h3 id="column-data-types"><a href="#column-data-types" class="anchor"></a>Column data types</h3></header><div class="spec module" id="module-Data"><a href="#module-Data" class="anchor"></a><code><span class="keyword">module</span> <a href="Data/index.html">Data</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h3 id="general-database-operations"><a href="#general-database-operations" class="anchor"></a>General database operations</h3></header><dl><dt class="spec value" id="val-db_open"><a href="#val-db_open" class="anchor"></a><code><span class="keyword">val</span> db_open : ?&#8288;mode:[ `READONLY | `NO_CREATE ] <span>&#45;&gt;</span> ?&#8288;uri:bool <span>&#45;&gt;</span> ?&#8288;memory:bool <span>&#45;&gt;</span> ?&#8288;mutex:[ `NO | `FULL ] <span>&#45;&gt;</span> ?&#8288;cache:[ `SHARED | `PRIVATE ] <span>&#45;&gt;</span> ?&#8288;vfs:string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-db">db</a></code></dt><dd><p><code>db_open ?mode ?uri ?memory ?mutex ?cache ?vfs filename</code> opens the database file <code>filename</code>, and returns a database handle.</p><p>Special filenames: &quot;:memory:&quot; and &quot;&quot; open an in-memory or temporary database respectively. Behaviour explained here: https://www.sqlite.org/inmemorydb.html</p><p>The optional arguments <code>mode</code>, <code>uri</code>, <code>memory</code> and <code>mutex</code> are only meaningful with SQLite versions &gt;= 3.5, <code>cache</code> only for versions &gt;= 3.6.18. For older versions an exception will be raised if any of them is set to a non-default value. The database is opened read-only if <code>`READONLY</code> is passed as mode. The database file will not be created if it is missing and <code>`NO_CREATE</code> is set. The <code>uri</code> parameter enables URI filename interpretation and corresponds to <code>SQLITE_OPEN_URI</code> in the SQLite3 API. The <code>memory</code> parameter opens an in-memory database and corresponds to <code>SQLITE_OPEN_MEMORY</code> in the SQLite3 API. <code>mutex</code> determines how the database is accessed. The mutex parameters <code>`NO</code> and <code>`FULL</code> correspond to <code>SQLITE_OPEN_NOMUTEX</code> and <code>SQLITE_OPEN_FULLMUTEX</code> in the SQLite3 API respectively. The cache parameters <code>`SHARED</code> and <code>`PRIVATE</code> correspond to <code>SQLITE_OPEN_SHAREDCACHE</code> and <code>SQLITE_OPEN_PRIVATECACHE</code> in the SQLite3 API respectively.</p><dl><dt>parameter mode</dt><dd><p>default = read-write, create</p></dd></dl><dl><dt>parameter uri</dt><dd><p>default = false</p></dd></dl><dl><dt>parameter memory</dt><dd><p>default = false</p></dd></dl><dl><dt>parameter mutex</dt><dd><p>default = nothing</p></dd></dl><dl><dt>parameter cache</dt><dd><p>default = nothing</p></dd></dl><dl><dt>parameter vfs</dt><dd><p>default = nothing</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-db_close"><a href="#val-db_close" class="anchor"></a><code><span class="keyword">val</span> db_close : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>db_close db</code> closes database <code>db</code> and invalidates the handle.</p><dl><dt>returns</dt><dd><p><code>false</code> if database was busy (database not closed in this case!), <code>true</code> otherwise.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-enable_load_extension"><a href="#val-enable_load_extension" class="anchor"></a><code><span class="keyword">val</span> enable_load_extension : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> bool</code></dt><dd><p><code>enable_load_extension db onoff</code> enable/disable the sqlite3 load extension. </p><dl><dt>returns</dt><dd><p><code>false</code> if the operation fails, <code>true</code> otherwise.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-errcode"><a href="#val-errcode" class="anchor"></a><code><span class="keyword">val</span> errcode : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>errcode db</code> </p><dl><dt>returns</dt><dd><p>the error code of the last operation on database <code>db</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-errmsg"><a href="#val-errmsg" class="anchor"></a><code><span class="keyword">val</span> errmsg : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>errmsg db</code> </p><dl><dt>returns</dt><dd><p>the error message of the last operation on database <code>db</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-last_insert_rowid"><a href="#val-last_insert_rowid" class="anchor"></a><code><span class="keyword">val</span> last_insert_rowid : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> int64</code></dt><dd><p><code>last_insert_rowid db</code> </p><dl><dt>returns</dt><dd><p>the index of the row inserted by the last operation on database <code>db</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-exec"><a href="#val-exec" class="anchor"></a><code><span class="keyword">val</span> exec : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> ?&#8288;cb:(<a href="index.html#type-row">row</a> <span>&#45;&gt;</span> <a href="index.html#type-headers">headers</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>exec db ?cb sql</code> performs SQL-operation <code>sql</code> on database <code>db</code>. If the operation contains query statements, then the callback function <code>cb</code> will be called for each matching row. The first parameter of the callback is the contents of the row, the second paramater are the headers of the columns associated with the row. Exceptions raised within the callback will abort the execution and escape <a href="index.html#val-exec"><code>exec</code></a>.</p><dl><dt>returns</dt><dd><p>the return code of the operation.</p></dd></dl><dl><dt>parameter cb</dt><dd><p>default = no callback</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-exec_no_headers"><a href="#val-exec_no_headers" class="anchor"></a><code><span class="keyword">val</span> exec_no_headers : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> cb:(<a href="index.html#type-row">row</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>exec_no_headers db ?cb sql</code> performs SQL-operation <code>sql</code> on database <code>db</code>. If the operation contains query statements, then the callback function <code>cb</code> will be called for each matching row. The parameter of the callback is the contents of the row. Exceptions raised within the callback will abort the execution and escape <a href="index.html#val-exec_no_headers"><code>exec_no_headers</code></a>.</p><dl><dt>returns</dt><dd><p>the return code of the operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-exec_not_null"><a href="#val-exec_not_null" class="anchor"></a><code><span class="keyword">val</span> exec_not_null : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> cb:(<a href="index.html#type-row_not_null">row_not_null</a> <span>&#45;&gt;</span> <a href="index.html#type-headers">headers</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>exec_not_null db ~cb sql</code> performs SQL-operation <code>sql</code> on database <code>db</code>. If the operation contains query statements, then the callback function <code>cb</code> will be called for each matching row. The first parameter of the callback is the contents of the row, which must not contain NULL-values, the second paramater are the headers of the columns associated with the row. Exceptions raised within the callback will abort the execution and escape <a href="index.html#val-exec_not_null"><code>exec_not_null</code></a>.</p><dl><dt>returns</dt><dd><p>the return code of the operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if a row contains NULL.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-exec_not_null_no_headers"><a href="#val-exec_not_null_no_headers" class="anchor"></a><code><span class="keyword">val</span> exec_not_null_no_headers : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> cb:(<a href="index.html#type-row_not_null">row_not_null</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>exec_not_null_no_headers db ~cb sql</code> performs SQL-operation <code>sql</code> on database <code>db</code>. If the operation contains query statements, then the callback function <code>cb</code> will be called for each matching row. The parameter of the callback is the contents of the row, which must not contain NULL-values. Exceptions raised within the callback will abort the execution and escape <a href="index.html#val-exec_not_null_no_headers"><code>exec_not_null_no_headers</code></a>.</p><dl><dt>returns</dt><dd><p>the return code of the operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if a row contains NULL.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-changes"><a href="#val-changes" class="anchor"></a><code><span class="keyword">val</span> changes : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>changes db</code> </p><dl><dt>returns</dt><dd><p>the number of rows that were changed or inserted or deleted by the most recently completed SQL statement on database <code>db</code>.</p></dd></dl></dd></dl></section><section><header><h3 id="fine-grained-query-operations"><a href="#fine-grained-query-operations" class="anchor"></a>Fine grained query operations</h3></header><dl><dt class="spec value" id="val-prepare"><a href="#val-prepare" class="anchor"></a><code><span class="keyword">val</span> prepare : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-stmt">stmt</a></code></dt><dd><p><code>prepare db sql</code> compile SQL-statement <code>sql</code> for database <code>db</code> into bytecode. The statement may be only partially compiled. In this case <a href="index.html#val-prepare_tail"><code>prepare_tail</code></a> can be called on the returned statement to compile the remaining part of the SQL-statement.</p><p>NOTE: this really uses the C-function <code>sqlite3_prepare_v2</code>, i.e. avoids the older, deprecated <code>sqlite3_prepare</code>-function.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement could not be prepared.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-prepare_tail"><a href="#val-prepare_tail" class="anchor"></a><code><span class="keyword">val</span> prepare_tail : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="index.html#type-stmt">stmt</a> option</code></dt><dd><p><code>prepare_tail stmt</code> compile the remaining part of the SQL-statement <code>stmt</code> to bytecode. </p><dl><dt>returns</dt><dd><p><code>None</code> if there was no remaining part, or <code>Some remaining_part</code> otherwise.</p><p>NOTE: this really uses the C-function <code>sqlite3_prepare_v2</code>, i.e. avoids the older, deprecated <code>sqlite3_prepare</code>-function.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement could not be prepared.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-recompile"><a href="#val-recompile" class="anchor"></a><code><span class="keyword">val</span> recompile : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>recompile stmt</code> recompiles the SQL-statement associated with <code>stmt</code> to bytecode. The statement may be only partially compiled. In this case <a href="index.html#val-prepare_tail"><code>prepare_tail</code></a> can be called on the statement to compile the remaining part of the SQL-statement. Call this function if the statement expires due to some schema change.</p><dl><dt>raises SqliteError</dt><dd><p>if the statement could not be recompiled.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-step"><a href="#val-step" class="anchor"></a><code><span class="keyword">val</span> step : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>step stmt</code> performs one step of the query associated with SQL-statement <code>stmt</code>.</p><dl><dt>returns</dt><dd><p>the return code of this operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the step could not be executed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-finalize"><a href="#val-finalize" class="anchor"></a><code><span class="keyword">val</span> finalize : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>finalize stmt</code> finalizes the statement <code>stmt</code>. After finalization, the only valid usage of the statement is to use it in <a href="index.html#val-prepare_tail"><code>prepare_tail</code></a>, or to <a href="index.html#val-recompile"><code>recompile</code></a> it.</p><dl><dt>returns</dt><dd><p>the return code of this operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement could not be finalized.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-reset"><a href="#val-reset" class="anchor"></a><code><span class="keyword">val</span> reset : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>reset stmt</code> resets the statement <code>stmt</code>, e.g. to restart the query, perhaps with different bindings.</p><dl><dt>returns</dt><dd><p>the return code of this operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement could not be reset.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-sleep"><a href="#val-sleep" class="anchor"></a><code><span class="keyword">val</span> sleep : int <span>&#45;&gt;</span> int</code></dt><dd><p><code>sleep ms</code> sleeps at least <code>ms</code> milliseconds. </p><dl><dt>returns</dt><dd><p>the number of milliseconds of sleep actually requested from the operating system.</p></dd></dl></dd></dl></section><section><header><h3 id="data-query"><a href="#data-query" class="anchor"></a>Data query</h3></header><dl><dt class="spec value" id="val-data_count"><a href="#val-data_count" class="anchor"></a><code><span class="keyword">val</span> data_count : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>data_count stmt</code> </p><dl><dt>returns</dt><dd><p>the number of columns in the result of the last step of statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-column_count"><a href="#val-column_count" class="anchor"></a><code><span class="keyword">val</span> column_count : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>column_count stmt</code> </p><dl><dt>returns</dt><dd><p>the number of columns that would be returned by executing statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-column_blob"><a href="#val-column_blob" class="anchor"></a><code><span class="keyword">val</span> column_blob : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string option</code></dt><dd><p><code>column_blob stmt n</code> </p><dl><dt>returns</dt><dd><p><code>Some bytes</code> in column <code>n</code> of the result of the last step of statement <code>stmt</code>, or <code>None</code> if NULL.</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-column"><a href="#val-column" class="anchor"></a><code><span class="keyword">val</span> column : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a></code></dt><dd><p><code>column stmt n</code> </p><dl><dt>returns</dt><dd><p>the data in column <code>n</code> of the result of the last step of statement <code>stmt</code>.</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-column_name"><a href="#val-column_name" class="anchor"></a><code><span class="keyword">val</span> column_name : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-header">header</a></code></dt><dd><p><code>column_name stmt n</code> </p><dl><dt>returns</dt><dd><p>the header of column <code>n</code> in the result set of statement <code>stmt</code>.</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-column_decltype"><a href="#val-column_decltype" class="anchor"></a><code><span class="keyword">val</span> column_decltype : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string option</code></dt><dd><p><code>column_decltype stmt n</code> </p><dl><dt>returns</dt><dd><p>the declared type of the specified column in the result set of statement <code>stmt</code>.</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl></section><section><header><h3 id="binding-data-to-the-query"><a href="#binding-data-to-the-query" class="anchor"></a>Binding data to the query</h3></header><dl><dt class="spec value" id="val-bind"><a href="#val-bind" class="anchor"></a><code><span class="keyword">val</span> bind : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>bind stmt n data</code> binds the value <code>data</code> to the free variable at position <code>n</code> of statement <code>stmt</code>. NOTE: the first variable has index <code>1</code>!</p><dl><dt>returns</dt><dd><p>the return code of this operation.</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-bind_parameter_count"><a href="#val-bind_parameter_count" class="anchor"></a><code><span class="keyword">val</span> bind_parameter_count : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>bind_parameter_count stmt</code> </p><dl><dt>returns</dt><dd><p>the number of free variables in statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-bind_parameter_name"><a href="#val-bind_parameter_name" class="anchor"></a><code><span class="keyword">val</span> bind_parameter_name : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> string option</code></dt><dd><p><code>bind_parameter_name stmt n</code> </p><dl><dt>returns</dt><dd><p><code>Some parameter_name</code> of the free variable at position <code>n</code> of statement <code>stmt</code>, or <code>None</code> if it is ordinary (&quot;?&quot;).</p></dd></dl><dl><dt>raises RangeError</dt><dd><p>if <code>n</code> is out of range.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-bind_parameter_index"><a href="#val-bind_parameter_index" class="anchor"></a><code><span class="keyword">val</span> bind_parameter_index : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> int</code></dt><dd><p><code>bind_parameter_index stmt name</code> </p><dl><dt>returns</dt><dd><p>the position of the free variable with name <code>name</code> in statement <code>stmt</code>.</p></dd></dl><dl><dt>raises Not_found</dt><dd><p>if <code>name</code> was not found.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-clear_bindings"><a href="#val-clear_bindings" class="anchor"></a><code><span class="keyword">val</span> clear_bindings : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="Rc/index.html#type-t">Rc.t</a></code></dt><dd><p><code>clear_bindings stmt</code> resets all bindings associated with prepared statement <code>stmt</code>.</p><dl><dt>returns</dt><dd><p>the return code of this operation.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl></section><section><header><h3 id="stepwise-query-convenience-functions"><a href="#stepwise-query-convenience-functions" class="anchor"></a>Stepwise query convenience functions</h3></header><dl><dt class="spec value" id="val-row_blobs"><a href="#val-row_blobs" class="anchor"></a><code><span class="keyword">val</span> row_blobs : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="index.html#type-row">row</a></code></dt><dd><p><code>row_blobs stmt</code> </p><dl><dt>returns</dt><dd><p>the row returned by the last query step performed with statement <code>stmt</code> (array of optional blobs).</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-row_data"><a href="#val-row_data" class="anchor"></a><code><span class="keyword">val</span> row_data : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> array</code></dt><dd><p><code>row_data stmt</code> </p><dl><dt>returns</dt><dd><p>all data values in the row returned by the last query step performed with statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-row_names"><a href="#val-row_names" class="anchor"></a><code><span class="keyword">val</span> row_names : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> <a href="index.html#type-headers">headers</a></code></dt><dd><p><code>row_names stmt</code> </p><dl><dt>returns</dt><dd><p>all column headers of the row returned by the last query step performed with statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-row_decltypes"><a href="#val-row_decltypes" class="anchor"></a><code><span class="keyword">val</span> row_decltypes : <a href="index.html#type-stmt">stmt</a> <span>&#45;&gt;</span> string option array</code></dt><dd><p><code>row_decltypes stmt</code> </p><dl><dt>returns</dt><dd><p>all column type declarations of the row returned by the last query step performed with statement <code>stmt</code>.</p></dd></dl><dl><dt>raises SqliteError</dt><dd><p>if the statement is invalid.</p></dd></dl></dd></dl></section><section><header><h3 id="user-defined-functions"><a href="#user-defined-functions" class="anchor"></a>User-defined functions</h3></header><dl><dt class="spec value" id="val-create_funN"><a href="#val-create_funN" class="anchor"></a><code><span class="keyword">val</span> create_funN : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> array <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_funN db name f</code> registers function <code>f</code> under name <code>name</code> with database handle <code>db</code>. The function has arity <code>N</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-create_fun0"><a href="#val-create_fun0" class="anchor"></a><code><span class="keyword">val</span> create_fun0 : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (unit <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_funN db name f</code> registers function <code>f</code> under name <code>name</code> with database handle <code>db</code>. The function has arity <code>0</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-create_fun1"><a href="#val-create_fun1" class="anchor"></a><code><span class="keyword">val</span> create_fun1 : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_fun1 db name f</code> registers function <code>f</code> under name <code>name</code> with database handle <code>db</code>. The function has arity <code>1</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-create_fun2"><a href="#val-create_fun2" class="anchor"></a><code><span class="keyword">val</span> create_fun2 : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_fun2 db name f</code> registers function <code>f</code> under name <code>name</code> with database handle <code>db</code>. The function has arity <code>2</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-create_fun3"><a href="#val-create_fun3" class="anchor"></a><code><span class="keyword">val</span> create_fun3 : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> (<a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a> <span>&#45;&gt;</span> <a href="Data/index.html#type-t">Data.t</a>) <span>&#45;&gt;</span> unit</code></dt><dd><p><code>create_fun3 db name f</code> registers function <code>f</code> under name <code>name</code> with database handle <code>db</code>. The function has arity <code>3</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-delete_function"><a href="#val-delete_function" class="anchor"></a><code><span class="keyword">val</span> delete_function : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>delete_function db name</code> deletes function with name <code>name</code> from database handle <code>db</code>.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-busy_timeout"><a href="#val-busy_timeout" class="anchor"></a><code><span class="keyword">val</span> busy_timeout : <a href="index.html#type-db">db</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>busy_timeout db ms</code> sets a busy handler that sleeps for a specified amount of time when a table is locked. The handler will sleep multiple times until at least <code>ms</code> milliseconds of sleeping have accumulated.</p><dl><dt>raises SqliteError</dt><dd><p>if an invalid database handle is passed.</p></dd></dl></dd></dl><div class="spec module" id="module-Aggregate"><a href="#module-Aggregate" class="anchor"></a><code><span class="keyword">module</span> <a href="Aggregate/index.html">Aggregate</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="spec module" id="module-Backup"><a href="#module-Backup" class="anchor"></a><code><span class="keyword">module</span> <a href="Backup/index.html">Backup</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section></div></body></html>