<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Torch__Dataset_helper (torch.Torch__Dataset_helper)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">torch</a> &#x00BB; Torch__Dataset_helper</nav><h1>Module <code>Torch__Dataset_helper</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><code>{</code><table class="record"><tr id="type-t.train_images" class="anchored"><td class="def field"><a href="#type-t.train_images" class="anchor"></a><code>train_images : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>;</code></td></tr><tr id="type-t.train_labels" class="anchored"><td class="def field"><a href="#type-t.train_labels" class="anchor"></a><code>train_labels : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>;</code></td></tr><tr id="type-t.test_images" class="anchored"><td class="def field"><a href="#type-t.test_images" class="anchor"></a><code>test_images : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>;</code></td></tr><tr id="type-t.test_labels" class="anchored"><td class="def field"><a href="#type-t.test_labels" class="anchor"></a><code>test_labels : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-train_batch"><a href="#val-train_batch" class="anchor"></a><code><span class="keyword">val</span> train_batch : ?&#8288;device:<a href="../Torch_core/Device/index.html#type-t">Torch_core.Device.t</a> <span>&#45;&gt;</span> ?&#8288;augmentation:[ `flip | `crop_with_pad of int | `cutout of int ] list <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> batch_size:int <span>&#45;&gt;</span> batch_idx:int <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> * <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a></code></dt><dd><p><code>train_batch ?device ?augmentation t ~batch_size ~batch_idx</code> returns two tensors corresponding to a training batch. The first tensor is for images and the second for labels. Each batch has a first dimension of size <code>batch_size</code>, <code>batch_idx</code> = 0 returns the first batch, <code>batch_idx</code> = 1 returns the second one and so on. The tensors are located on <code>device</code> if provided. Random data augmentation is performed as specified via <code>augmentation</code>.</p></dd></dl><dl><dt class="spec value" id="val-batch_accuracy"><a href="#val-batch_accuracy" class="anchor"></a><code><span class="keyword">val</span> batch_accuracy : ?&#8288;device:<a href="../Torch_core/Device/index.html#type-t">Torch_core.Device.t</a> <span>&#45;&gt;</span> ?&#8288;samples:int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> [ `test | `train ] <span>&#45;&gt;</span> batch_size:int <span>&#45;&gt;</span> predict:(<a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>) <span>&#45;&gt;</span> float</code></dt><dd><p><code>batch_accuracy ?device ?samples t test_or_train ~batch_size ~predict</code> computes the accuracy of applying <code>predict</code> to test or train images as specified by <code>test_or_train</code>. Computations are done using batch of length <code>batch_size</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_with_cache"><a href="#val-read_with_cache" class="anchor"></a><code><span class="keyword">val</span> read_with_cache : cache_file:string <span>&#45;&gt;</span> read:(unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>) <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>read_with_cache ~cache_file ~read</code> either returns the content of <code>cache_file</code> if present or regenerate the file using <code>read</code> if not.</p></dd></dl><dl><dt class="spec value" id="val-batches_per_epoch"><a href="#val-batches_per_epoch" class="anchor"></a><code><span class="keyword">val</span> batches_per_epoch : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> batch_size:int <span>&#45;&gt;</span> int</code></dt><dd><p><code>batches_per_epoch t ~batch_size</code> returns the total number of batches of size <code>batch_size</code> in <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-iter"><a href="#val-iter" class="anchor"></a><code><span class="keyword">val</span> iter : ?&#8288;device:<a href="../Torch_core/Device/index.html#type-t">Torch_core.Device.t</a> <span>&#45;&gt;</span> ?&#8288;augmentation:[ `flip | `crop_with_pad of int | `cutout of int ] list <span>&#45;&gt;</span> ?&#8288;shuffle:bool <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(int <span>&#45;&gt;</span> batch_images:<a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> batch_labels:<a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> batch_size:int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>iter ?device ?augmentation ?shuffle t ~f ~batch_size</code> iterates function <code>f</code> on all the batches from <code>t</code> taken with a size <code>batch_size</code>. Random shuffling and augmentation can be specified.</p></dd></dl><dl><dt class="spec value" id="val-random_flip"><a href="#val-random_flip" class="anchor"></a><code><span class="keyword">val</span> random_flip : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a></code></dt><dd><p><code>random_flip t</code> applies some random flips to a tensor of dimension <code> N; H; C; W</code>. The last dimension related to width can be flipped.</p></dd></dl><dl><dt class="spec value" id="val-random_crop"><a href="#val-random_crop" class="anchor"></a><code><span class="keyword">val</span> random_crop : <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> pad:int <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a></code></dt><dd><p><code>random_crop t ~pad</code> performs some data augmentation by padding <code>t</code> with zeros on the two last dimensions with <code>pad</code> new values on each side, then performs some random crop to go back to the original shape.</p></dd></dl><dl><dt class="spec value" id="val-shuffle"><a href="#val-shuffle" class="anchor"></a><code><span class="keyword">val</span> shuffle : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>shuffle t</code> returns <code>t</code> where training images and labels have been shuffled.</p></dd></dl><dl><dt class="spec value" id="val-map"><a href="#val-map" class="anchor"></a><code><span class="keyword">val</span> map : ?&#8288;device:<a href="../Torch_core/Device/index.html#type-t">Torch_core.Device.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> f:(int <span>&#45;&gt;</span> batch_images:<a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> batch_labels:<a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a> * <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a>) <span>&#45;&gt;</span> batch_size:int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-print_summary"><a href="#val-print_summary" class="anchor"></a><code><span class="keyword">val</span> print_summary : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-read_char_tensor"><a href="#val-read_char_tensor" class="anchor"></a><code><span class="keyword">val</span> read_char_tensor : string <span>&#45;&gt;</span> <a href="../Torch/Tensor/index.html#type-t">Torch.Tensor.t</a></code></dt><dd><p><code>read_char_tensor filename</code> returns a tensor of char containing the specified file.</p></dd></dl></div></body></html>