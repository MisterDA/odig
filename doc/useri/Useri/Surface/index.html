<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Surface (useri.Useri.Surface)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">useri</a> &#x00BB; <a href="../index.html">Useri</a> &#x00BB; Surface</nav><h1>Module <code>Useri.Surface</code></h1><p>Rendering surface.</p><p>An application has a single rendering surface that is specified by a <a href="index.html#type-t"><code>t</code></a> value given to <a href="../App/index.html#val-init"><code>App.init</code></a>.</p><nav class="toc"><ul><li><a href="#smode">Surface mode</a></li><li><a href="#surfaces">Surface specification</a></li><li><a href="#surface">Application Surface</a></li><li><a href="#refreshing">Refreshing surfaces</a></li></ul></nav></header><section><header><h2 id="smode"><a href="#smode" class="anchor"></a>Surface mode</h2><p>See also <span class="xref-unresolved" title="unresolved reference to &quot;Useri_jsoo.Surface.smode&quot;"><span>surface mode information</span></span> in the <code>`Jsoo</code> backend.</p></header><dl><dt class="spec type" id="type-mode"><a href="#type-mode" class="anchor"></a><code><span class="keyword">type </span>mode</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-mode.Windowed" class="anchored"><td class="def constructor"><a href="#type-mode.Windowed" class="anchor"></a><code><span class="keyword">| </span></code><code>`Windowed</code></td></tr><tr id="type-mode.Fullscreen" class="anchored"><td class="def constructor"><a href="#type-mode.Fullscreen" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fullscreen</code></td></tr></table><code> ]</code></dt><dd><p>The type for surface modes.</p></dd></dl><dl><dt class="spec value" id="val-mode"><a href="#val-mode" class="anchor"></a><code><span class="keyword">val </span>mode : <a href="index.html#type-mode">mode</a> React.signal</code></dt><dd><p><code>mode</code> is the application's surface mode. The value of this signal is defined by the <code>~mode</code> argument of the surface given to <a href="../App/index.html#val-init"><code>App.init</code></a>, the occurences of the event specified by <a href="index.html#val-set_mode_setter"><code>set_mode_setter</code></a> and external events.</p></dd></dl><dl><dt class="spec value" id="val-set_mode_setter"><a href="#val-set_mode_setter" class="anchor"></a><code><span class="keyword">val </span>set_mode_setter : <a href="index.html#type-mode">mode</a> React.event <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_mode_setter me</code> uses occurences of <code>me</code> to set, if possible, the current surface's application mode and the value of <a href="index.html#type-mode"><code>mode</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-mode_flip"><a href="#val-mode_flip" class="anchor"></a><code><span class="keyword">val </span>mode_flip : <span class="type-var">'a</span> React.event <span>&#45;&gt;</span> <a href="index.html#type-mode">mode</a> React.event</code></dt><dd><p><code>mode_flip e</code> is an event which occur whenever <code>e</code> does with the opposite mode of <a href="index.html#type-mode"><code>mode</code></a>'s value.</p></dd></dl><dl><dt class="spec value" id="val-pp_mode"><a href="#val-pp_mode" class="anchor"></a><code><span class="keyword">val </span>pp_mode : Format.formatter <span>&#45;&gt;</span> <a href="index.html#type-mode">mode</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp_mode ppf m</code> prints an unspecified representation of <code>m</code> on <code>ppf</code>.</p></dd></dl></section><section><header><h2 id="surfaces"><a href="#surfaces" class="anchor"></a>Surface specification</h2><p>See also <span class="xref-unresolved" title="unresolved reference to &quot;Useri_jsoo.Surface.sspec&quot;"><span>surface specification information</span></span> inf the <code>`Jsoo</code> backend.</p></header><dl><dt class="spec module" id="module-Gl"><a href="#module-Gl" class="anchor"></a><code><span class="keyword">module </span><a href="Gl/index.html">Gl</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The type for OpenGL surface specification.</p></dd></dl><dl><dt class="spec type" id="type-handle"><a href="#type-handle" class="anchor"></a><code><span class="keyword">type </span>handle</code><code><span class="keyword"> = </span>Useri_base.Surface.handle</code></dt><dd><p>The type for backend dependent surface handles.</p></dd></dl><dl><dt class="spec type" id="type-kind"><a href="#type-kind" class="anchor"></a><code><span class="keyword">type </span>kind</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-kind.Gl" class="anchored"><td class="def constructor"><a href="#type-kind.Gl" class="anchor"></a><code><span class="keyword">| </span></code><code>`Gl<span class="keyword"> of </span><a href="Gl/index.html#type-t">Gl.t</a></code></td></tr><tr id="type-kind.Other" class="anchored"><td class="def constructor"><a href="#type-kind.Other" class="anchor"></a><code><span class="keyword">| </span></code><code>`Other</code></td></tr></table><code> ]</code></dt><dd><p>The type for surface kinds.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>The type for surface specification.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : ?&#8288;hidpi:bool <span>&#45;&gt;</span> ?&#8288;pos:Gg.p2 <span>&#45;&gt;</span> ?&#8288;size:Gg.size2 <span>&#45;&gt;</span> ?&#8288;kind:<a href="index.html#type-kind">kind</a> <span>&#45;&gt;</span> ?&#8288;handle:<a href="index.html#type-handle">handle</a> <span>&#45;&gt;</span> ?&#8288;mode:<a href="index.html#type-mode">mode</a> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create hidpi pos size kind anchor mode  ()</code> is a surface specification with:</p><ul><li><code>hidpi</code>, if <code>true</code> (default) tries to get a high-dpi surface.</li><li><code>pos</code>, a <em>hint</em> to position the surface by using <code>pos</code> as the position of the top-left corner of the surface in its backend dependent display container. The coordinates of the top-left corner of the display container is <code>(0,0)</code> and coordinate increase in from top to bottom and left to right.</li><li><code>size</code>, the size of the surface in logical pixels. Consult the individual backend documentation for the default value.</li><li><code>kind</code> is the kind of surface.</li><li><code>handle</code> is a backend dependent surface handle. In certain backends allows to interface <code>Useri</code> with pre-existing surfaces.</li><li><code>mode</code> is the the surface mode.</li></ul><p><b>Note.</b> Currently the <code>size</code> and <code>pos</code> arguments are specified The actual raster size of the surface is in the <a href="index.html#val-raster_size"><code>raster_size</code></a> signal. Note that future versions of this library will switch to physical dimensions (lack of backend support is the problem at the moment).</p></dd></dl></section><section><header><h2 id="surface"><a href="#surface" class="anchor"></a>Application Surface</h2><p>See also information about <span class="xref-unresolved" title="unresolved reference to &quot;Useri_jsoo.Surface.propsupdate&quot;"><span>surface properties updates</span></span> in the <code>`Jsoo</code> backend.</p><p><b>Warning.</b> These values and functions are defined only after <a href="../App/index.html#val-init"><code>App.init</code></a> was called.</p></header><dl><dt class="spec value" id="val-pos"><a href="#val-pos" class="anchor"></a><code><span class="keyword">val </span>pos : Gg.p2 React.signal</code></dt><dd><p><code>pos</code> is the position of the top-left corner of the surface in the surface's backend dependent display container.</p></dd></dl><dl><dt class="spec value" id="val-raster_size"><a href="#val-raster_size" class="anchor"></a><code><span class="keyword">val </span>raster_size : Gg.size2 React.signal</code></dt><dd><p><code>raster_size</code> is the application's surface underlying raster size.</p></dd></dl><dl><dt class="spec value" id="val-size"><a href="#val-size" class="anchor"></a><code><span class="keyword">val </span>size : Gg.size2 React.signal</code></dt><dd><p><code>size</code> is the application's surface logical size.</p></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val </span>update : unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>update ()</code> updates the rendering surface. This has to be called for your drawing commands to be taken into account.</p></dd></dl><dl><dt class="spec value" id="val-handle"><a href="#val-handle" class="anchor"></a><code><span class="keyword">val </span>handle : unit <span>&#45;&gt;</span> Useri_base.Surface.handle</code></dt><dd><p><code>handle ()</code> is the application's surface backend dependent handle.</p></dd></dl></section><section><header><h2 id="refreshing"><a href="#refreshing" class="anchor"></a>Refreshing surfaces</h2><p>These events are for coordinating rendering in an energy efficient manner. See <a href="../index.html#rendercoord"><span>Input, animation and rendering coordination</span></a> for more information.</p></header><dl><dt class="spec value" id="val-refresh"><a href="#val-refresh" class="anchor"></a><code><span class="keyword">val </span>refresh : float React.event</code></dt><dd><p><code>refresh</code> occurs whenever the surface needs to be redrawn with the number of seconds since its last occurence or, for the first occurence, the number of seconds since the application start.</p><p>The exact occurence frequency is unspecified but generally it should not exceed the <em>hinted</em> frequency of <a href="index.html#val-refresh_hz"><code>refresh_hz</code></a> hertz.</p><p>More precisely the following occurences are guaranteed:</p><ul><li>Some time <em>after</em> the <a href="index.html#val-size"><code>size</code></a> signal changes value (including the first time during <a href="../App/index.html#val-init"><code>App.init</code></a>).</li><li>Some time <em>after</em> an occurence of the event set by <a href="index.html#val-set_refresher"><code>set_refresher</code></a>.</li><li>Some time <em>after</em> a call to <a href="index.html#val-request_refresh"><code>request_refresh</code></a>.</li><li>Some time <em>after</em> a <a href="../Time/index.html#val-count"><code>Time.count</code></a> or <a href="../Time/index.html#val-unit"><code>Time.unit</code></a> signal is created or updates.</li></ul><p><code>Useri</code> guarantees that this event doesn't occur simultaneously with any of the events or signal it exposes.</p></dd></dl><dl><dt class="spec value" id="val-request_refresh"><a href="#val-request_refresh" class="anchor"></a><code><span class="keyword">val </span>request_refresh : unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>request_refresh ()</code> has the effect of making <a href="index.html#val-refresh"><code>refresh</code></a> occur some time after it was called. This function call is cheap and can be abused (can be called in a React step).</p><p><b>Warning.</b> This function may be removed from the API in the future.</p></dd></dl><dl><dt class="spec value" id="val-set_refresher"><a href="#val-set_refresher" class="anchor"></a><code><span class="keyword">val </span>set_refresher : <span class="type-var">'a</span> React.event <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_refresher r</code> uses sets <code>r</code> to be used to generate an occurence of <a href="index.html#val-refresh"><code>refresh</code></a> some time after each occurence of <code>r</code>.</p></dd></dl><dl><dt class="spec value" id="val-steady_refresh"><a href="#val-steady_refresh" class="anchor"></a><code><span class="keyword">val </span>steady_refresh : until:<span class="type-var">'a</span> React.event <span>&#45;&gt;</span> unit</code></dt><dd><p><code>steady_refresh until</code> makes <a href="index.html#val-refresh"><code>refresh</code></a> occur at the hinted frequency of <a href="index.html#val-refresh_hz"><code>refresh_hz</code></a> hertz until <code>until</code> occurs.</p></dd></dl><dl><dt class="spec value" id="val-refresh_hz"><a href="#val-refresh_hz" class="anchor"></a><code><span class="keyword">val </span>refresh_hz : int React.signal</code></dt><dd><p><code>refresh_hz</code> is the maximal <em>hinted</em> frequency in hertz for <a href="index.html#val-refresh"><code>refresh</code></a> occurences. The initial value is <code>60</code>.</p></dd></dl><dl><dt class="spec value" id="val-set_refresh_hz"><a href="#val-set_refresh_hz" class="anchor"></a><code><span class="keyword">val </span>set_refresh_hz : int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_refresh_hz</code> sets the value of <a href="index.html#val-refresh_hz"><code>refresh_hz</code></a>.</p></dd></dl></section></div></body></html>