<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Private (vg.Vg.Vgr.Private)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">vg</a> &#x00BB; <a href="../../index.html">Vg</a> &#x00BB; <a href="../index.html">Vgr</a> &#x00BB; Private</nav><h1>Module <code>Vgr.Private</code></h1><p>Private functions for implementing renderers.</p><p><b>Warning.</b> <code>Vg</code> users should not use these definitions, they exposes <code>Vg</code>'s internals for implementing renderers. This functionality is subject to change even between minor versions of the library.</p><p>In order to provide a consistant interface for <code>Vg</code> users, renderer writers should follow the guidelines below. You may want to drop an email to the maintainer for help and discussion.</p><ul><li>If you render to &quot;Bla&quot;, define you renderer in a module called <code>Vgr_bla</code> (lowercase).</li><li>The renderer target creation function must be named <code>Vgr_bla.target</code>.</li><li>Images must be rendered via the <a href="../index.html#render"><span>Rendering</span></a> function. If you are writing a batch renderer provide support for each of the <a href="../index.html#type-dst"><code>dst</code></a> types and especially the non-blocking interface.</li><li>Respect Vg's linear sRGB color model.</li><li>Whenever possible use an XMP metadata packet for metadata, see <a href="../index.html#val-xmp"><code>Vgr.xmp</code></a>.</li><li>The renderer should implement the rendering cost model, see the <code>limit</code> parameter of <a href="../index.html#render"><span>Rendering</span></a>.</li><li>Follow <code>Vg</code>'s <a href="../../index.html#coordinates"><span>coordinate system conventions</span></a> to specify the relationship between a target and the view rectangle to render.</li><li>If the renderer doesn't support <code>Vg</code>'s full rendering model or diverges from its semantics it must ignore unsupported features and warn the client via the <a href="index.html#val-warn"><code>warn</code></a> function.</li></ul><nav class="toc"><ul><li><a href="#internal-data">Internal data</a></li><li><a href="#renderers">Renderers</a></li><li><a href="#writing--destinations">Writing <em></em> destinations</a></li><li><a href="#miscellaneous">Miscellaneous</a></li></ul></nav></header><section><header><h2 id="internal-data"><a href="#internal-data" class="anchor"></a>Internal data</h2></header><dl><dt class="spec module" id="module-Data"><a href="#module-Data" class="anchor"></a><code><span class="keyword">module </span><a href="Data/index.html">Data</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Internal data.</p></dd></dl><dl><dt class="spec module" id="module-Font"><a href="#module-Font" class="anchor"></a><code><span class="keyword">module </span><a href="Font/index.html">Font</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Font helpers.</p></dd></dl><dl><dt class="spec module" id="module-P"><a href="#module-P" class="anchor"></a><code><span class="keyword">module </span><a href="P/index.html">P</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Paths helpers.</p></dd></dl><dl><dt class="spec module" id="module-I"><a href="#module-I" class="anchor"></a><code><span class="keyword">module </span><a href="I/index.html">I</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Image helpers</p></dd></dl></section><section><header><h2 id="renderers"><a href="#renderers" class="anchor"></a>Renderers</h2></header><dl><dt class="spec type" id="type-renderer"><a href="#type-renderer" class="anchor"></a><code><span class="keyword">type </span>renderer</code></dt><dd><p>The type for renderers.</p></dd></dl><dl><dt class="spec type" id="type-k"><a href="#type-k" class="anchor"></a><code><span class="keyword">type </span>k</code><code><span class="keyword"> = </span><a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Partial ]</code></dt><dd><p>The type for renderer continuations.</p></dd></dl><dl><dt class="spec type" id="type-render_fun"><a href="#type-render_fun" class="anchor"></a><code><span class="keyword">type </span>render_fun</code><code><span class="keyword"> = </span>[ `End<span class="keyword"> | </span>`Image of Gg.size2<span class="keyword"> * </span>Gg.box2<span class="keyword"> * </span><a href="Data/index.html#type-image">Data.image</a> ] <span>&#45;&gt;</span> <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-k">k</a></code></dt><dd><p>The type for rendering functions.</p></dd></dl><dl><dt class="spec type" id="type-render_target"><a href="#type-render_target" class="anchor"></a><code><span class="keyword">type </span>'a render_target</code><code><span class="keyword"> = </span><a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> bool<span class="keyword"> * </span><a href="index.html#type-render_fun">render_fun</a></code><code><span class="keyword"> constraint </span><span class="type-var">'a</span> = [&lt; <a href="../index.html#type-dst">dst</a> ]</code></dt><dd><p>The type for render targets. The function takes a created renderer and its destination. It should return a boolean indicating whether multiple images can be rendered on the target, and a function that is invoked by the renderer to render a new image or end the rendering sequence.</p></dd></dl><dl><dt class="spec value" id="val-create_target"><a href="#val-create_target" class="anchor"></a><code><span class="keyword">val </span>create_target : <span class="type-var">'a</span> <a href="index.html#type-render_target">render_target</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="../index.html#type-target">target</a></code></dt><dd><p><code>create_target t</code> makes an end-user render target from <code>t</code>.</p></dd></dl><dl><dt class="spec value" id="val-renderer"><a href="#val-renderer" class="anchor"></a><code><span class="keyword">val </span>renderer : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a></code></dt><dd><p><code>renderer r</code> is <code>r</code>'s internal representation.</p></dd></dl><dl><dt class="spec value" id="val-limit"><a href="#val-limit" class="anchor"></a><code><span class="keyword">val </span>limit : <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>limit r</code> is <code>r</code>'s render limit.</p></dd></dl><dl><dt class="spec value" id="val-warn"><a href="#val-warn" class="anchor"></a><code><span class="keyword">val </span>warn : <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> <a href="../index.html#type-warning">warning</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>warn r w</code> reports the warning <code>w</code> on <code>r</code>.</p></dd></dl><dl><dt class="spec value" id="val-partial"><a href="#val-partial" class="anchor"></a><code><span class="keyword">val </span>partial : <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [&gt; `Partial ]</code></dt><dd><p><code>partial k r</code> suspends the renderer <code>r</code> and returns <code>`Partial</code>. Rendering will continue with <code>k r</code>, on <a href="../index.html#render"><span>Rendering</span></a> <code>`Await</code>.</p></dd></dl></section><section><header><h2 id="writing--destinations"><a href="#writing--destinations" class="anchor"></a>Writing <em></em> destinations</h2></header><dl><dt class="spec value" id="val-flush"><a href="#val-flush" class="anchor"></a><code><span class="keyword">val </span>flush : <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Partial ]</code></dt><dd><p><code>flush k r</code> flushes the renderer <code>r</code>. If <code>r</code> writes on a stored destination this function <b>must</b> be called by the rendering function on <code>`End</code>.</p></dd></dl><dl><dt class="spec value" id="val-writeb"><a href="#val-writeb" class="anchor"></a><code><span class="keyword">val </span>writeb : int <span>&#45;&gt;</span> <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Partial ]</code></dt><dd><p><code>writeb b k r</code> writes the byte <code>b</code> and <code>k</code>ontinues.</p></dd></dl><dl><dt class="spec value" id="val-writes"><a href="#val-writes" class="anchor"></a><code><span class="keyword">val </span>writes : string <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Partial ]</code></dt><dd><p><code>writes s j l k r</code> writes <code>l</code> bytes from <code>s</code> starting at <code>j</code> and <code>k</code>ontinues.</p></dd></dl><dl><dt class="spec value" id="val-writebuf"><a href="#val-writebuf" class="anchor"></a><code><span class="keyword">val </span>writebuf : Buffer.t <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-k">k</a> <span>&#45;&gt;</span> <a href="index.html#type-renderer">renderer</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Partial ]</code></dt><dd><p><code>writebuf buf j l k r</code> write <code>l</code> bytes from <code>buf</code> starting at <code>j</code> and <code>k</code>ontinues.</p></dd></dl></section><section><header><h2 id="miscellaneous"><a href="#miscellaneous" class="anchor"></a>Miscellaneous</h2></header><dl><dt class="spec value" id="val-add_xml_data"><a href="#val-add_xml_data" class="anchor"></a><code><span class="keyword">val </span>add_xml_data : Buffer.t <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_xml_data b s</code> adds <code>s</code> to <code>b</code>, escapes <code>'&lt;', '&gt;', '&amp;'</code> and <code>'&quot;'</code> (but <b>not</b> single quotes) and maps illegal XML unicode characters to the replacement character U+FFFD.</p></dd></dl></section></div></body></html>