<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Se (webglue.Wg.Se)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">webglue</a> &#x00BB; <a href="../index.html">Wg</a> &#x00BB; Se</nav><h1>Module <code>Wg.Se</code></h1><p>S-expressions.</p></header><section><header><h2 id="se"><a href="#se" class="anchor"></a>Basics</h2></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code><code><span class="keyword"> = </span><a href="../index.html#type-se">se</a></code></dt><dd><p>The type for s-expressions. Strings are UTF-8 encoded.</p></dd></dl><dl><dt class="spec value" id="val-atom"><a href="#val-atom" class="anchor"></a><code><span class="keyword">val </span>atom : ?&#8288;d:<a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> [&gt; `Atom of string ]<span class="keyword"> * </span><a href="../index.html#type-dict">dict</a></code></dt><dd><p><code>atom d a</code> is <code>(`Atom a, d)</code>, <code>d</code> defaults to <a href="../Dict/index.html#val-empty"><code>Dict.empty</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-list"><a href="#val-list" class="anchor"></a><code><span class="keyword">val </span>list : ?&#8288;d:<a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> list <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a></code></dt><dd><p><code>list d l</code> is <code>(`List l, d)</code>, <code>d</code> defaults to <a href="../Dict/index.html#val-empty"><code>Dict.empty</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-with_dict"><a href="#val-with_dict" class="anchor"></a><code><span class="keyword">val </span>with_dict : ?&#8288;d:<a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a></code></dt><dd><p><code>with_dict d e</code> is <code>(fst e, d)</code>, <code>d</code> defaults to <a href="../Dict/index.html#val-empty"><code>Dict.empty</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-to_atom"><a href="#val-to_atom" class="anchor"></a><code><span class="keyword">val </span>to_atom : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> [&gt; `Atom of string ]<span class="keyword"> * </span><a href="../index.html#type-dict">dict</a></code></dt><dd><p><code>to_atom e</code> is <code>e</code> as an atom. <b>Raises</b> <code>Invalid_argument</code> if <code>e</code> is a <code>`List</code></p></dd></dl><dl><dt class="spec value" id="val-to_atom_str"><a href="#val-to_atom_str" class="anchor"></a><code><span class="keyword">val </span>to_atom_str : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>to_atom_str e</code> is <code>e</code>'s atom string. <b>Raises</b> <code>Invalid_argument</code> if <code>e</code> is a <code>`List</code></p></dd></dl><dl><dt class="spec value" id="val-to_list"><a href="#val-to_list" class="anchor"></a><code><span class="keyword">val </span>to_list : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> [&gt; `List of <a href="../index.html#type-se">se</a> list ]<span class="keyword"> * </span><a href="../index.html#type-dict">dict</a></code></dt><dd><p><code>to_list e</code> is <code>e</code> as a list. <b>Raises</b> <code>Invalid_argument</code> if <code>e</code> is a <code>`Atom</code></p></dd></dl><dl><dt class="spec value" id="val-to_list_list"><a href="#val-to_list_list" class="anchor"></a><code><span class="keyword">val </span>to_list_list : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> list</code></dt><dd><p><code>to_list_list e</code> is <code>e</code>'s list. <b>Raises</b> <code>Invalid_argment</code> if <code>e</code> is an <code>`Atom</code>.</p></dd></dl><dl><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val </span>compare : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare e e'</code> is a total, lexicographical, order on <a href="index.html#se"><span>Basics</span></a> without taking dictionaries into account.</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val </span>equal : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal e e'</code> is <code>compare e e' = 0</code>.</p></dd></dl></section><section><header><h2 id="print"><a href="#print" class="anchor"></a>Printers</h2></header><dl><dt class="spec value" id="val-to_string"><a href="#val-to_string" class="anchor"></a><code><span class="keyword">val </span>to_string : <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>to_string e</code> is the textual representation of <code>e</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val </span>pp : Format.formatter <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp ppf e</code> prints the textual reprentation of <code>e</code> on <code>ppf</code>.</p></dd></dl><dl><dt class="spec value" id="val-pp_atom"><a href="#val-pp_atom" class="anchor"></a><code><span class="keyword">val </span>pp_atom : Format.formatter <span>&#45;&gt;</span> <a href="../index.html#type-atom">atom</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>pp ppf a</code> prints the textual reprentation of <code>a</code> on <code>ppf</code>.</p></dd></dl></section><section><header><h2 id="sparsers"><a href="#sparsers" class="anchor"></a>S-expression parsers</h2></header><dl><dt class="spec type" id="type-parse_result"><a href="#type-parse_result" class="anchor"></a><code><span class="keyword">type </span>'a parse_result</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-parse_result.Ok" class="anchored"><td class="def constructor"><a href="#type-parse_result.Ok" class="anchor"></a><code><span class="keyword">| </span></code><code>`Ok<span class="keyword"> of </span><span class="type-var">'a</span></code></td></tr><tr id="type-parse_result.Error" class="anchored"><td class="def constructor"><a href="#type-parse_result.Error" class="anchor"></a><code><span class="keyword">| </span></code><code>`Error</code></td></tr></table><code> ]</code></dt><dd><p>The type for parse results.</p></dd></dl><dl><dt class="spec type" id="type-parser"><a href="#type-parser" class="anchor"></a><code><span class="keyword">type </span>'a parser</code><code><span class="keyword"> = </span>string<span class="keyword"> * </span>(<a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parse_result">parse_result</a>)</code></dt><dd><p>The type for s-expression parsers. The string is the type of element parsed. The parsing function must <a href="../Wlog/index.html#val-err"><span>log</span></a> errors.</p></dd></dl><dl><dt class="spec value" id="val-atom_parser"><a href="#val-atom_parser" class="anchor"></a><code><span class="keyword">val </span>atom_parser : string <span>&#45;&gt;</span> (string <span>&#45;&gt;</span> <a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parse_result">parse_result</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>atom_parser typ f e</code> uses <code>f</code> to parse a <code>typ</code> atom from <code>e</code>. If <code>f</code> returns <code>`Error</code> or <code>e</code> is a list, <code>`Error</code> is returned. <code>f</code> must log errors.</p></dd></dl><dl><dt class="spec value" id="val-list_parser"><a href="#val-list_parser" class="anchor"></a><code><span class="keyword">val </span>list_parser : string <span>&#45;&gt;</span> (<a href="../index.html#type-se">se</a> list <span>&#45;&gt;</span> <a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parse_result">parse_result</a>) <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>list_parser typ f e</code> uses <code>f</code> to parse a <code>typ</code> s-expression list from <code>e</code>. If <code>f</code> returns <code>`Error</code> or <code>e</code> is an atom, <code>`Error</code> is returned. <code>f</code> must log errors.</p></dd></dl><section><header><h3 id="sparserrun"><a href="#sparserrun" class="anchor"></a>Running parsers</h3></header><dl><dt class="spec value" id="val-parse"><a href="#val-parse" class="anchor"></a><code><span class="keyword">val </span>parse : ?&#8288;err:<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>parse p e</code> parses <code>e</code> with <code>p</code> and returns the result. If the parsing fails raises <code>Exit</code> or, if given, returns <code>err</code> instead.</p></dd></dl><dl><dt class="spec value" id="val-pnext"><a href="#val-pnext" class="anchor"></a><code><span class="keyword">val </span>pnext : ?&#8288;err:<span class="type-var">'a</span> <span>&#45;&gt;</span> ?&#8288;empty:<span class="type-var">'a</span> <span>&#45;&gt;</span> ?&#8288;last:bool <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> list <span>&#45;&gt;</span> <a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <span class="type-var">'a</span><span class="keyword"> * </span><a href="../index.html#type-se">se</a> list</code></dt><dd><p><code>pnext p es dict</code> parses the head of <code>es</code> with <code>p</code> and returns the result and the tail of <code>es</code>.</p><p>If <code>es</code> is empty and <code>empty</code> is not given an error is logged on <code>dict</code> and the parsing fails.</p><p>if <code>last</code> is <code>true</code> (default to <code>false</code>) and the tail of <code>es</code> is not empty an error is logged and the parsing fails.</p><p>If the parsing fails raises <code>Exit</code> or, if given, returns <code>err</code> and the tail of <code>es</code> instead.</p></dd></dl></section><section><header><h3 id="sparserpredef"><a href="#sparserpredef" class="anchor"></a>Predefined parsers</h3></header><dl><dt class="spec value" id="val-p_se"><a href="#val-p_se" class="anchor"></a><code><span class="keyword">val </span>p_se : string <span>&#45;&gt;</span> <a href="../index.html#type-se">se</a> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_se typ</code> parses any s-expression.</p></dd></dl><dl><dt class="spec value" id="val-p_atom"><a href="#val-p_atom" class="anchor"></a><code><span class="keyword">val </span>p_atom : ?&#8288;validate:(string <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../index.html#type-atom">atom</a> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_atom typ</code> parses an atom and returns it as an atom. The parser fails if the atom does not <code>validate</code>.</p></dd></dl><dl><dt class="spec value" id="val-p_list"><a href="#val-p_list" class="anchor"></a><code><span class="keyword">val </span>p_list : string <span>&#45;&gt;</span> ([ `List of <a href="../index.html#type-se">se</a> list ]<span class="keyword"> * </span><a href="../index.html#type-dict">dict</a>) <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_list typ</code> parses a list an returns it as a list.</p></dd></dl><section><header><h4 id="sparseratom"><a href="#sparseratom" class="anchor"></a>Atom parsers</h4></header><dl><dt class="spec value" id="val-p_bool"><a href="#val-p_bool" class="anchor"></a><code><span class="keyword">val </span>p_bool : bool <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_bool</code> parses an atom with <code>bool_of_string</code>.</p></dd></dl><dl><dt class="spec value" id="val-p_int"><a href="#val-p_int" class="anchor"></a><code><span class="keyword">val </span>p_int : int <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_int</code> parses an atom with <code>int_of_string</code>.</p></dd></dl><dl><dt class="spec value" id="val-p_pos_int"><a href="#val-p_pos_int" class="anchor"></a><code><span class="keyword">val </span>p_pos_int : int <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_pos_int</code> parses an atom with <code>int_of_string</code> and checks the result is non negative.</p></dd></dl><dl><dt class="spec value" id="val-p_int_range"><a href="#val-p_int_range" class="anchor"></a><code><span class="keyword">val </span>p_int_range : int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_int_range min max</code> parses an atom with <code>int_of_string</code> and checks the result is in the interval [<code>min</code>;<code>max</code>].</p></dd></dl><dl><dt class="spec value" id="val-p_float"><a href="#val-p_float" class="anchor"></a><code><span class="keyword">val </span>p_float : float <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_float</code> parses an atom with <code>float_of_string</code>.</p></dd></dl><dl><dt class="spec value" id="val-p_float_range"><a href="#val-p_float_range" class="anchor"></a><code><span class="keyword">val </span>p_float_range : float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_float_range min max</code> parses an atom with <code>float_of_string</code> and checks that result is in the interval [<code>min</code>;<code>max</code>].</p></dd></dl><dl><dt class="spec value" id="val-p_string"><a href="#val-p_string" class="anchor"></a><code><span class="keyword">val </span>p_string : string <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_string</code> parses an atom and returns its string.</p></dd></dl><dl><dt class="spec value" id="val-p_enum"><a href="#val-p_enum" class="anchor"></a><code><span class="keyword">val </span>p_enum : (string<span class="keyword"> * </span><span class="type-var">'a</span>) list <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_enum l</code> parses an atom and maps its string to the corresponding value in <code>l</code>.</p></dd></dl></section><section><header><h4 id="sparserlist"><a href="#sparserlist" class="anchor"></a>List parsers</h4></header><dl><dt class="spec value" id="val-p_list_of"><a href="#val-p_list_of" class="anchor"></a><code><span class="keyword">val </span>p_list_of : ?&#8288;empty:bool <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> list <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_list_of empty p</code> parses the elements of a list with <code>p</code>. The list may be empty iff <code>empty</code> is <code>true</code> (default).</p></dd></dl><dl><dt class="spec value" id="val-p_pair"><a href="#val-p_pair" class="anchor"></a><code><span class="keyword">val </span>p_pair : <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span>) <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_pair p0 p1</code> parses a two element list with <code>p0</code> and <code>p1</code>.</p></dd></dl><dl><dt class="spec value" id="val-p_t2"><a href="#val-p_t2" class="anchor"></a><code><span class="keyword">val </span>p_t2 : <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span>) <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_t2</code> is <a href="index.html#val-p_pair"><code>p_pair</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-p_t3"><a href="#val-p_t3" class="anchor"></a><code><span class="keyword">val </span>p_t3 : <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span><span class="keyword"> * </span><span class="type-var">'c</span>) <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_t3</code> is like <a href="index.html#val-p_t2"><code>p_t2</code></a> but for three elements.</p></dd></dl><dl><dt class="spec value" id="val-p_t4"><a href="#val-p_t4" class="anchor"></a><code><span class="keyword">val </span>p_t4 : <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'c</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'d</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> (<span class="type-var">'a</span><span class="keyword"> * </span><span class="type-var">'b</span><span class="keyword"> * </span><span class="type-var">'c</span><span class="keyword"> * </span><span class="type-var">'d</span>) <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_t4</code> is like <a href="index.html#val-p_t2"><code>p_t2</code></a> but for four elements.</p></dd></dl><dl><dt class="spec value" id="val-p_fold"><a href="#val-p_fold" class="anchor"></a><code><span class="keyword">val </span>p_fold : ?&#8288;robust:bool <span>&#45;&gt;</span> (<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> (<a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <span class="type-var">'a</span>) <span>&#45;&gt;</span> <span class="type-var">'b</span> <a href="index.html#type-parser">parser</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <a href="index.html#type-parser">parser</a></code></dt><dd><p><code>p_fold ~robust f init p</code> parses and folds over the elements of a list with <code>f</code>. Given the list's dictionary <code>init</code> defines the initial accumulator. If <code>robust</code> is <code>true</code> (defaults to <code>false</code>), the parser doesn't fail if an element fails.</p></dd></dl></section></section></section></div></body></html>