<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Default (webglue.Wg.Wformat.Default)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">webglue</a> &#x00BB; <a href="../../index.html">Wg</a> &#x00BB; <a href="../index.html">Wformat</a> &#x00BB; Default</nav><h1>Module <code>Wformat.Default</code></h1><p>The default map format.</p><nav class="toc"><ul><li><a href="#fdoc">Format documentation.</a></li><li><a href="#fcreate">Map creation</a></li><li><a href="#furis">URI set and content</a></li><li><a href="#fdiagnose">Diagnostics</a></li></ul></nav></header><section><header><h2 id="fdoc"><a href="#fdoc" class="anchor"></a>Format documentation.</h2></header><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val </span>name : <a href="../../index.html#type-format">format</a></code></dt><dd><p><code>name</code> is the name of the map format. A map using this format must use <code>name</code> for the key <a href="../../Bset/Key/index.html#val-w_format"><code>Bset.Key.w_format</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-version"><a href="#val-version" class="anchor"></a><code><span class="keyword">val </span>version : string</code></dt><dd><p><code>version</code> is a version string for the map format.</p></dd></dl><dl><dt class="spec value" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span class="keyword">val </span>doc : string</code></dt><dd><p><code>doc</code> is a one line description the map format.</p></dd></dl><dl><dt class="spec value" id="val-man"><a href="#val-man" class="anchor"></a><code><span class="keyword">val </span>man : <a href="../index.html#type-man_block">man_block</a> list</code></dt><dd><p><code>man</code> is the manual of the format.</p></dd></dl><dl><dt class="spec value" id="val-keys"><a href="#val-keys" class="anchor"></a><code><span class="keyword">val </span>keys : (<a href="../../Bset/index.html#type-key">Bset.key</a><span class="keyword"> * </span><a href="../index.html#type-key_info">key_info</a><span class="keyword"> * </span>string) list</code></dt><dd><p><code>keys</code> describe the keys of the map format.</p></dd></dl></section><section><header><h2 id="fcreate"><a href="#fcreate" class="anchor"></a>Map creation</h2></header><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val </span>create : <a href="../../Wctx/index.html#type-t">Wctx.t</a> <span>&#45;&gt;</span> <a href="../../index.html#type-wmap">wmap</a> <span>&#45;&gt;</span> <a href="../../index.html#type-wmap">wmap</a> option</code></dt><dd><p><code>create c m</code> is called by <a href="../../Wmap/Private/index.html#val-create"><code>Wmap.Private.create</code></a> to create a map of this format with <code>m</code> in the context <code>c</code>.</p><p><b>Guarantees.</b> The map <code>m</code> is defined on the <code>`Required</code> keys of <a href="index.html#val-keys"><code>keys</code></a> aswell as on the <code>`Optional</code> ones with a default value. The locale of <code>c</code> is <code>None</code>.</p><p><b>Implementation duties.</b> The function should compute the value of <code>`Derived</code> keys, add them to <code>m</code> and return the result. It can also add its own <a href="../../Dict/index.html#dkey"><span>dictionary keys</span></a> to the map or its bindings to store private, format specific, information.</p><p>The function should refrain from calling <a href="../../Wmap/index.html#val-find"><code>Wmap.find</code></a> and <a href="../../Wmap/index.html#val-get"><code>Wmap.get</code></a>, map creation should be quick and should not depend on the evaluation of the data language.</p><p>If the function tries to redefine keys reserved by webglue (e.g. <a href="../../Bset/Key/index.html#val-w_id"><code>Bset.Key.w_id</code></a> or <a href="../../Bset/Key/index.html#val-w_format"><code>Bset.Key.w_format</code></a>), <a href="../../Wmap/Private/index.html#val-create"><code>Wmap.Private.create</code></a> will revert these changes.</p><p><b>Dependency tracking.</b> The context <code>c</code> automatically tracks the dependencies that are accessed during the function call to derive the result of <a href="../../Wmap/index.html#val-creation_deps"><code>Wmap.creation_deps</code></a>. The format can interfere with this process by using <a href="../../Wctx/index.html#val-add_dep"><code>Wctx.add_dep</code></a> and <a href="../../Wctx/index.html#val-rem_dep"><code>Wctx.rem_dep</code></a> on <code>c</code>.</p><p><b>On errors.</b> The function should <a href="../../Wlog/index.html"><span>log</span></a> them on the appropriate dictionary and return <code>None</code>.</p></dd></dl></section><section><header><h2 id="furis"><a href="#furis" class="anchor"></a>URI set and content</h2></header><dl><dt class="spec value" id="val-uri_set"><a href="#val-uri_set" class="anchor"></a><code><span class="keyword">val </span>uri_set : <a href="../../Wctx/index.html#type-t">Wctx.t</a> <span>&#45;&gt;</span> <a href="../../index.html#type-wmap">wmap</a> <span>&#45;&gt;</span> <a href="../../Wuri/Set/index.html#type-t">Wuri.Set.t</a></code></dt><dd><p><code>uri_set c m</code> is called by <a href="../../Wmap/index.html#val-uri_set"><code>Wmap.uri_set</code></a> to determine the URI set defined by <code>m</code> in the context <code>c</code>.</p><p><b>Guarantees.</b> The map <code>m</code> is the result of <a href="index.html#val-create"><code>create</code></a>. The locale of <code>c</code> is <code>None</code>.</p><p><b>Implementation duties.</b> The function should return the set of URIs defined by <code>m</code> in the context <code>c</code>.</p><p><b>Dependency tracking.</b> The context <code>c</code> automatically tracks the dependencies that are accessed during the function call to derive the result of <a href="../../Wmap/index.html#val-uri_set_deps"><code>Wmap.uri_set_deps</code></a>. The format can interfere with this process by using <a href="../../Wctx/index.html#val-add_dep"><code>Wctx.add_dep</code></a> and <a href="../../Wctx/index.html#val-rem_dep"><code>Wctx.rem_dep</code></a> on <code>c</code>.</p><p><b>On errors.</b> The function should <a href="../../Wlog/index.html"><span>log</span></a> them on the appropriate dictionary and return the set of URIs that can be generated without producing errors.</p><p><b>Important.</b> If the map defines an URI set for a single localized resource, <a href="../Standard_uris/index.html"><span>standard URI set</span></a> determination should be used.</p></dd></dl><dl><dt class="spec value" id="val-uri_content"><a href="#val-uri_content" class="anchor"></a><code><span class="keyword">val </span>uri_content : <a href="../../Wctx/index.html#type-t">Wctx.t</a> <span>&#45;&gt;</span> <a href="../../index.html#type-wmap">wmap</a> <span>&#45;&gt;</span> <a href="../../Wuri/index.html#type-t">Wuri.t</a> <span>&#45;&gt;</span> <a href="../../Out/index.html#type-dest">Out.dest</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>uri_content c m u d</code> is called by <a href="../../Wmap/index.html#val-uri_content"><code>Wmap.uri_content</code></a> to write on <code>d</code> the content of the URI <code>u</code> defined by <code>m</code> in the context <code>c</code>.</p><p><b>Guarantees.</b> The map <code>m</code> is the result of <a href="index.html#val-create"><code>create</code></a>. The URI <code>u</code> was returned by <a href="index.html#val-uri_set"><code>uri_set</code></a> on <code>m</code> and the same <code>c</code> except for its locale. The locale of <code>c</code> is the locale of <code>u</code> (if any).</p><p><b>Implementation duties.</b> The function should write on <code>d</code> the content of <code>u</code> defined by <code>m</code> in the context <code>c</code>.</p><p><b>Dependency tracking.</b> The context <code>c</code> automatically tracks the dependencies that are accessed during the function call to derive the result of <a href="../../Wmap/index.html#val-uri_deps"><code>Wmap.uri_deps</code></a>. The format can interfere with this process by using <a href="../../Wctx/index.html#val-add_dep"><code>Wctx.add_dep</code></a> and <a href="../../Wctx/index.html#val-rem_dep"><code>Wctx.rem_dep</code></a> on <code>c</code>.</p><p><b>On errors.</b> The function should <a href="../../Wlog/index.html"><span>log</span></a> them on the appropriate dictionary.</p></dd></dl></section><section><header><h2 id="fdiagnose"><a href="#fdiagnose" class="anchor"></a>Diagnostics</h2></header><dl><dt class="spec value" id="val-diagnose"><a href="#val-diagnose" class="anchor"></a><code><span class="keyword">val </span>diagnose : <a href="../../Wctx/index.html#type-t">Wctx.t</a> <span>&#45;&gt;</span> <a href="../../index.html#type-wmap">wmap</a> <span>&#45;&gt;</span> <a href="../../Out/index.html#type-dest">Out.dest</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>diagnose c m d</code> is called by <a href="../../Wmap/index.html#val-diagnose"><code>Wmap.diagnose</code></a> to write on <code>d</code> format specific diagnostics for <code>m</code> in the context <code>c</code>.</p><p><b>Guarantees.</b> The map <code>m</code> was created by <a href="index.html#val-create"><code>create</code></a>. The locale of <code>c</code> is <code>None</code>.</p><p><b>Implementation duties.</b> The function should report diagnostic information about <code>m</code> in the context <code>c</code>. If errors are diagnosed they should be <a href="../../Wlog/index.html"><span>logged</span></a> on the appropriate dictionary.</p><p><b>On errors.</b> The function should <a href="../../Wlog/index.html"><span>log</span></a> them on the appropriate dictionary.</p></dd></dl></section></div></body></html>