<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Validation (x509.X509.Validation)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">x509</a> &#x00BB; <a href="../index.html">X509</a> &#x00BB; Validation</nav><h1>Module <code>X509.Validation</code></h1><p>X.509 Certificate Chain Validation.</p><nav class="toc"><ul><li><a href="#certificate-authorities">Certificate Authorities</a></li><li><a href="#chain-of-trust-verification">Chain of trust verification</a></li><li><a href="#fingerprint-verification">Fingerprint verification</a></li></ul></nav></header><aside><p>A chain of pairwise signed X.509 certificates is sent to the endpoint, which use these to authenticate the other endpoint. Usually a set of trust anchors is configured on the endpoint, and the chain needs to be rooted in one of the trust anchors. In reality, chains may be incomplete or reversed, and there can be multiple paths from the leaf certificate to a trust anchor.</p><p>RFC 5280 specifies a <a href="https://tools.ietf.org/html/rfc5280#section-6">path validation</a> algorithm for authenticating chains, but this does not handle multiple possible paths. <a href="https://tools.ietf.org/html/rfc4158">RFC 4158</a> describes possible path building strategies.</p><p>This module provides path building, chain of trust verification, trust anchor (certificate authority) validation, and validation via a fingerprint list (for a trust on first use implementation).</p></aside><section><header><h3 id="certificate-authorities"><a href="#certificate-authorities" class="anchor"></a>Certificate Authorities</h3></header><dl><dt class="spec type" id="type-ca_error"><a href="#type-ca_error" class="anchor"></a><code><span class="keyword">type </span>ca_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-ca_error.CAIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAIssuerSubjectMismatch" class="anchor"></a><code><span class="keyword">| </span></code><code>`CAIssuerSubjectMismatch<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-ca_error.CAInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidVersion" class="anchor"></a><code><span class="keyword">| </span></code><code>`CAInvalidVersion<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-ca_error.CAInvalidSelfSignature" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidSelfSignature" class="anchor"></a><code><span class="keyword">| </span></code><code>`CAInvalidSelfSignature<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-ca_error.CACertificateExpired" class="anchored"><td class="def constructor"><a href="#type-ca_error.CACertificateExpired" class="anchor"></a><code><span class="keyword">| </span></code><code>`CACertificateExpired<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>Ptime.t option</code></td></tr><tr id="type-ca_error.CAInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-ca_error.CAInvalidExtensions" class="anchor"></a><code><span class="keyword">| </span></code><code>`CAInvalidExtensions<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of possible certificate authorities failures.</p></dd></dl><dl><dt class="spec value" id="val-ca_error_of_sexp"><a href="#val-ca_error_of_sexp" class="anchor"></a><code><span class="keyword">val </span>ca_error_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-ca_error">ca_error</a></code></dt><dd><p><code>ca_error_of_sexp sexp</code> is <code>ca_error</code>, the unmarshalled <code>sexp</code>.</p></dd></dl><dl><dt class="spec value" id="val-sexp_of_ca_error"><a href="#val-sexp_of_ca_error" class="anchor"></a><code><span class="keyword">val </span>sexp_of_ca_error : <a href="index.html#type-ca_error">ca_error</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dd><p><code>sexp_of_ca_error ca_error</code> is <code>sexp</code>, the marshalled <code>ca_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-ca_error_to_string"><a href="#val-ca_error_to_string" class="anchor"></a><code><span class="keyword">val </span>ca_error_to_string : <a href="index.html#type-ca_error">ca_error</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>ca_error_to_string validation_error</code> is <code>string</code>, the string representation of the <code>ca_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-valid_ca"><a href="#val-valid_ca" class="anchor"></a><code><span class="keyword">val </span>valid_ca : ?&#8288;time:Ptime.t <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> [ `Ok<span class="keyword"> | </span>`Error of <a href="index.html#type-ca_error">ca_error</a> ]</code></dt><dd><p><code>valid_ca ~time certificate</code> is <code>result</code>, which is `Ok if the given certificate is self-signed, it is valid at <code>time</code>, its extensions are not present (if X.509 version 1 certificate), or are appropriate for a CA (BasicConstraints is present and true, KeyUsage extension contains keyCertSign).</p></dd></dl><dl><dt class="spec value" id="val-valid_cas"><a href="#val-valid_cas" class="anchor"></a><code><span class="keyword">val </span>valid_cas : ?&#8288;time:Ptime.t <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list</code></dt><dd><p><code>valid_cas ~time certificates</code> is <code>valid_certificates</code>, only those certificates which pass the <a href="index.html#val-valid_ca"><code>valid_ca</code></a> check.</p></dd></dl></section><section><header><h3 id="chain-of-trust-verification"><a href="#chain-of-trust-verification" class="anchor"></a>Chain of trust verification</h3></header><dl><dt class="spec type" id="type-leaf_validation_error"><a href="#type-leaf_validation_error" class="anchor"></a><code><span class="keyword">type </span>leaf_validation_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-leaf_validation_error.LeafCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafCertificateExpired" class="anchor"></a><code><span class="keyword">| </span></code><code>`LeafCertificateExpired<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>Ptime.t option</code></td></tr><tr id="type-leaf_validation_error.LeafInvalidName" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidName" class="anchor"></a><code><span class="keyword">| </span></code><code>`LeafInvalidName<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span><a href="../index.html#type-host">host</a> option</code></td></tr><tr id="type-leaf_validation_error.LeafInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidVersion" class="anchor"></a><code><span class="keyword">| </span></code><code>`LeafInvalidVersion<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-leaf_validation_error.LeafInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-leaf_validation_error.LeafInvalidExtensions" class="anchor"></a><code><span class="keyword">| </span></code><code>`LeafInvalidExtensions<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a leaf certificate validation error.</p></dd></dl><dl><dt class="spec type" id="type-chain_validation_error"><a href="#type-chain_validation_error" class="anchor"></a><code><span class="keyword">type </span>chain_validation_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-chain_validation_error.IntermediateInvalidExtensions" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidExtensions" class="anchor"></a><code><span class="keyword">| </span></code><code>`IntermediateInvalidExtensions<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.IntermediateCertificateExpired" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateCertificateExpired" class="anchor"></a><code><span class="keyword">| </span></code><code>`IntermediateCertificateExpired<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>Ptime.t option</code></td></tr><tr id="type-chain_validation_error.IntermediateInvalidVersion" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.IntermediateInvalidVersion" class="anchor"></a><code><span class="keyword">| </span></code><code>`IntermediateInvalidVersion<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainIssuerSubjectMismatch" class="anchor"></a><code><span class="keyword">| </span></code><code>`ChainIssuerSubjectMismatch<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainAuthorityKeyIdSubjectKeyIdMismatch" class="anchor"></a><code><span class="keyword">| </span></code><code>`ChainAuthorityKeyIdSubjectKeyIdMismatch<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidSignature" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidSignature" class="anchor"></a><code><span class="keyword">| </span></code><code>`ChainInvalidSignature<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.ChainInvalidPathlen" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.ChainInvalidPathlen" class="anchor"></a><code><span class="keyword">| </span></code><code>`ChainInvalidPathlen<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>int</code></td></tr><tr id="type-chain_validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.EmptyCertificateChain" class="anchor"></a><code><span class="keyword">| </span></code><code>`EmptyCertificateChain</code></td></tr><tr id="type-chain_validation_error.NoTrustAnchor" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.NoTrustAnchor" class="anchor"></a><code><span class="keyword">| </span></code><code>`NoTrustAnchor<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-chain_validation_error.Revoked" class="anchored"><td class="def constructor"><a href="#type-chain_validation_error.Revoked" class="anchor"></a><code><span class="keyword">| </span></code><code>`Revoked<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a chain validation error.</p></dd></dl><dl><dt class="spec value" id="val-build_paths"><a href="#val-build_paths" class="anchor"></a><code><span class="keyword">val </span>build_paths : <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list list</code></dt><dd><p><code>build_paths server rest</code> is <code>paths</code>, which are all possible certificate paths starting with <code>server</code>. These chains (C1..Cn) fulfill the predicate that each certificate Cn is issued by the next one in the chain (C(n+1)): the issuer of Cn matches the subject of C(n+1). This is as described in <a href="https://tools.ietf.org/html/rfc4158">RFC 4158</a>.</p></dd></dl><dl><dt class="spec type" id="type-chain_error"><a href="#type-chain_error" class="anchor"></a><code><span class="keyword">type </span>chain_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-chain_error.Leaf" class="anchored"><td class="def constructor"><a href="#type-chain_error.Leaf" class="anchor"></a><code><span class="keyword">| </span></code><code>`Leaf<span class="keyword"> of </span><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-chain_error.Chain" class="anchored"><td class="def constructor"><a href="#type-chain_error.Chain" class="anchor"></a><code><span class="keyword">| </span></code><code>`Chain<span class="keyword"> of </span><a href="index.html#type-chain_validation_error">chain_validation_error</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a chain validation error: either the leaf certificate is problematic, or the chain itself.</p></dd></dl><dl><dt class="spec value" id="val-chain_error_of_sexp"><a href="#val-chain_error_of_sexp" class="anchor"></a><code><span class="keyword">val </span>chain_error_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-chain_error">chain_error</a></code></dt><dd><p><code>chain_error_of_sexp sexp</code> is <code>chain_error</code>, the unmarshalled <code>sexp</code>.</p></dd></dl><dl><dt class="spec value" id="val-sexp_of_chain_error"><a href="#val-sexp_of_chain_error" class="anchor"></a><code><span class="keyword">val </span>sexp_of_chain_error : <a href="index.html#type-chain_error">chain_error</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dd><p><code>sexp_of_chain_error chain_error</code> is <code>sexp</code>, the marshalled <code>chain_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-chain_error_to_string"><a href="#val-chain_error_to_string" class="anchor"></a><code><span class="keyword">val </span>chain_error_to_string : <a href="index.html#type-chain_error">chain_error</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>chain_error_to_string validation_error</code> is <code>string</code>, the string representation of the <code>chain_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-verify_chain"><a href="#val-verify_chain" class="anchor"></a><code><span class="keyword">val </span>verify_chain : ?&#8288;host:<a href="../index.html#type-host">host</a> <span>&#45;&gt;</span> ?&#8288;time:Ptime.t <span>&#45;&gt;</span> ?&#8288;revoked:(issuer:<a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> cert:<a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> anchors:<a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> [ `Ok of <a href="../index.html#type-t">t</a><span class="keyword"> | </span>`Fail of <a href="index.html#type-chain_error">chain_error</a> ]</code></dt><dd><p><code>verify_chain ~host ~time ~revoked ~anchors chain</code> is <code>result</code>, either <code>Ok</code> and the trust anchor used to verify the chain, or <code>Fail</code> and the chain error. RFC 5280 describes the implemented <a href="https://tools.ietf.org/html/rfc5280#section-6.1">path validation</a> algorithm: The validity period of the given certificates is checked against the <code>time</code>. The X509v3 extensions of the <code>chain</code> are checked, then a chain of trust from <code>anchors</code> to the server certificate is validated. The path length constraints are checked. The server certificate is checked to contain the given <code>host</code>, using <a href="../index.html#val-hostnames"><code>hostnames</code></a>. The returned certificate is the root of the chain, a member of the given list of <code>anchors</code>.</p></dd></dl><dl><dt class="spec type" id="type-fingerprint_validation_error"><a href="#type-fingerprint_validation_error" class="anchor"></a><code><span class="keyword">type </span>fingerprint_validation_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-fingerprint_validation_error.ServerNameNotPresent" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.ServerNameNotPresent" class="anchor"></a><code><span class="keyword">| </span></code><code>`ServerNameNotPresent<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>string</code></td></tr><tr id="type-fingerprint_validation_error.NameNotInList" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.NameNotInList" class="anchor"></a><code><span class="keyword">| </span></code><code>`NameNotInList<span class="keyword"> of </span><a href="../index.html#type-t">t</a></code></td></tr><tr id="type-fingerprint_validation_error.InvalidFingerprint" class="anchored"><td class="def constructor"><a href="#type-fingerprint_validation_error.InvalidFingerprint" class="anchor"></a><code><span class="keyword">| </span></code><code>`InvalidFingerprint<span class="keyword"> of </span><a href="../index.html#type-t">t</a><span class="keyword"> * </span>Cstruct.t<span class="keyword"> * </span>Cstruct.t</code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of a fingerprint validation error.</p></dd></dl><dl><dt class="spec type" id="type-validation_error"><a href="#type-validation_error" class="anchor"></a><code><span class="keyword">type </span>validation_error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-validation_error.EmptyCertificateChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.EmptyCertificateChain" class="anchor"></a><code><span class="keyword">| </span></code><code>`EmptyCertificateChain</code></td></tr><tr id="type-validation_error.InvalidChain" class="anchored"><td class="def constructor"><a href="#type-validation_error.InvalidChain" class="anchor"></a><code><span class="keyword">| </span></code><code>`InvalidChain</code></td></tr><tr id="type-validation_error.Leaf" class="anchored"><td class="def constructor"><a href="#type-validation_error.Leaf" class="anchor"></a><code><span class="keyword">| </span></code><code>`Leaf<span class="keyword"> of </span><a href="index.html#type-leaf_validation_error">leaf_validation_error</a></code></td></tr><tr id="type-validation_error.Fingerprint" class="anchored"><td class="def constructor"><a href="#type-validation_error.Fingerprint" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fingerprint<span class="keyword"> of </span><a href="index.html#type-fingerprint_validation_error">fingerprint_validation_error</a></code></td></tr></table><code> ]</code></dt><dd><p>The polymorphic variant of validation errors.</p></dd></dl><dl><dt class="spec value" id="val-validation_error_of_sexp"><a href="#val-validation_error_of_sexp" class="anchor"></a><code><span class="keyword">val </span>validation_error_of_sexp : Sexplib.Sexp.t <span>&#45;&gt;</span> <a href="index.html#type-validation_error">validation_error</a></code></dt><dd><p><code>validation_error_of_sexp sexp</code> is <code>validation_error</code>, the unmarshalled <code>sexp</code>.</p></dd></dl><dl><dt class="spec value" id="val-sexp_of_validation_error"><a href="#val-sexp_of_validation_error" class="anchor"></a><code><span class="keyword">val </span>sexp_of_validation_error : <a href="index.html#type-validation_error">validation_error</a> <span>&#45;&gt;</span> Sexplib.Sexp.t</code></dt><dd><p><code>sexp_of_validation_error validation_error</code> is <code>sexp</code>, the marshalled <code>validation_error</code>.</p></dd></dl><dl><dt class="spec value" id="val-validation_error_to_string"><a href="#val-validation_error_to_string" class="anchor"></a><code><span class="keyword">val </span>validation_error_to_string : <a href="index.html#type-validation_error">validation_error</a> <span>&#45;&gt;</span> string</code></dt><dd><p><code>validation_error_to_string validation_error</code> is <code>string</code>, the string representation of the <code>validation_error</code>.</p></dd></dl><dl><dt class="spec type" id="type-result"><a href="#type-result" class="anchor"></a><code><span class="keyword">type </span>result</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-result.Ok" class="anchored"><td class="def constructor"><a href="#type-result.Ok" class="anchor"></a><code><span class="keyword">| </span></code><code>`Ok<span class="keyword"> of </span>(<a href="../index.html#type-t">t</a> list<span class="keyword"> * </span><a href="../index.html#type-t">t</a>) option</code></td></tr><tr id="type-result.Fail" class="anchored"><td class="def constructor"><a href="#type-result.Fail" class="anchor"></a><code><span class="keyword">| </span></code><code>`Fail<span class="keyword"> of </span><a href="index.html#type-validation_error">validation_error</a></code></td></tr></table><code> ]</code></dt><dd><p>The result of a validation: either success (optionally returning the used trust anchor), or failure</p></dd></dl><dl><dt class="spec value" id="val-verify_chain_of_trust"><a href="#val-verify_chain_of_trust" class="anchor"></a><code><span class="keyword">val </span>verify_chain_of_trust : ?&#8288;host:<a href="../index.html#type-host">host</a> <span>&#45;&gt;</span> ?&#8288;time:Ptime.t <span>&#45;&gt;</span> ?&#8288;revoked:(issuer:<a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> cert:<a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> bool) <span>&#45;&gt;</span> anchors:<a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="index.html#type-result">result</a></code></dt><dd><p><code>verify_chain_of_trust ~host ~time ~revoked ~anchors certificates</code> is <code>result</code>. First, all possible paths are constructed using the <a href="index.html#val-build_paths"><code>build_paths</code></a> function, the first certificate of the chain is verified to be a valid leaf certificate (no BasicConstraints extension) and contains the given <code>host</code> (using <a href="../index.html#val-hostnames"><code>hostnames</code></a>); if some path is valid, using <a href="index.html#val-verify_chain"><code>verify_chain</code></a>, the result will be <code>Ok</code> and contain the actual certificate chain and the trust anchor.</p></dd></dl></section><section><header><h3 id="fingerprint-verification"><a href="#fingerprint-verification" class="anchor"></a>Fingerprint verification</h3></header><dl><dt class="spec value" id="val-trust_key_fingerprint"><a href="#val-trust_key_fingerprint" class="anchor"></a><code><span class="keyword">val </span>trust_key_fingerprint : ?&#8288;host:<a href="../index.html#type-host">host</a> <span>&#45;&gt;</span> ?&#8288;time:Ptime.t <span>&#45;&gt;</span> hash:Nocrypto.Hash.hash <span>&#45;&gt;</span> fingerprints:(string<span class="keyword"> * </span>Cstruct.t) list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="index.html#type-result">result</a></code></dt><dd><p><code>trust_key_fingerprint ~time ~hash ~fingerprints certificates</code> is <code>result</code>, the first element of <code>certificates</code> is verified against the given <code>fingerprints</code> map (hostname to public key fingerprint) using <a href="../index.html#val-key_fingerprint"><code>key_fingerprint</code></a>. The certificate has to be valid in the given <code>time</code>. If a <code>host</code> is provided, the certificate is checked for this name. The <code>`Wildcard hostname</code> of the fingerprint list must match the name in the certificate, using <a href="../index.html#val-hostnames"><code>hostnames</code></a>.</p></dd></dl><dl><dt class="spec value" id="val-trust_cert_fingerprint"><a href="#val-trust_cert_fingerprint" class="anchor"></a><code><span class="keyword">val </span>trust_cert_fingerprint : ?&#8288;host:<a href="../index.html#type-host">host</a> <span>&#45;&gt;</span> ?&#8288;time:Ptime.t <span>&#45;&gt;</span> hash:Nocrypto.Hash.hash <span>&#45;&gt;</span> fingerprints:(string<span class="keyword"> * </span>Cstruct.t) list <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> list <span>&#45;&gt;</span> <a href="index.html#type-result">result</a></code></dt><dd><p><code>trust_cert_fingerprint ~time ~hash ~fingerprints certificates</code> is <code>result</code>, the first element of <code>certificates</code> is verified to match the given <code>fingerprints</code> map (hostname to fingerprint) using <a href="../index.html#val-fingerprint"><code>fingerprint</code></a>. The certificate has to be valid in the given <code>time</code>. If a <code>host</code> is provided, the certificate is checked for this name. The <code>`Wildcard hostname</code> of the fingerprint list must match the name in the certificate, using <a href="../index.html#val-hostnames"><code>hostnames</code></a>.</p><dl><dt>deprecated</dt><dd><p>&quot;Pin public keys, not certificates (use <a href="index.html#val-trust_key_fingerprint"><code>trust_key_fingerprint</code></a> instead).&quot;</p></dd></dl></dd></dl></section></div></body></html>